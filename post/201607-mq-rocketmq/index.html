
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>说说 MQ 之 RocketMQ | 褚哥说|</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
    
    <meta name="author" content="Valleylord">
    
    <meta name="description" content="RocketMQ 是出自 A 公司的开源产品，用 Java 语言实现，在设计时参考了 Kafka，并做出了自己的一些改进，消息可靠性上比 Kafka 更好，目前，RocketMQ 的文档仍然不够丰富 1 2，社区仍然无法与 Kafka 比肩，但 A 公司已经推出了基于 RocketMQ 的云产品 3">
    
    
    
    
    <link rel="alternative" href="/atom.xml" title="褚哥说|" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/author.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/author.jpg">
    

	
	<link href="http://cdn.bootcss.com/highlight.js/8.2/styles/monokai.min.css" rel="stylesheet">
	<script src="http://cdn.bootcss.com/highlight.js/8.2/highlight.min.js"></script>
	<script>hljs.initHighlightingOnLoad();</script>
	

    <link rel="stylesheet" href="/css/style.css" type="text/css">


</head>

  <body>
    <header>
      <div>
		
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="褚哥说|">褚哥说|</a></h1>
				<h2 class="blog-motto">我想写一些东西</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul><li> <a href="/atom.xml">RSS</a> </li>
                    <ul>
					 
						<li><a href="/">首页</a></li>
					
						<li><a href="/archives">归档</a></li>
					
						<li><a href="/tags">标签</a></li>
					
						<li><a href="/links">链接</a></li>
					
						<li><a href="http://www.cnblogs.com/valleylord/">旧文</a></li>
					
						<li><a href="/about">关于</a></li>
					
					<li>
					
					</li>
                <li><div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div></li>

				</ul>
			</nav>
</div>

    </header>
    <div id="container" class="clearfix">
      <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/post/201607-mq-rocketmq/" title="说说 MQ 之 RocketMQ" itemprop="url">说说 MQ 之 RocketMQ</a>
  </h1>
  <p class="article-author">By
    
      <a href="http://valleylord.github.io" title="Valleylord">Valleylord</a>
    </p>
  <p class="article-time">
    <time datetime="2016-07-12T09:20:02.000Z" itemprop="datePublished">2016-07-12</time>
    更新日期:<time datetime="2016-07-25T03:44:11.000Z" itemprop="dateModified">2016-07-25</time>
    
  </p>
</header>
	<div class="article-content">
		
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.</span> <span class="toc-text">基本概念</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.1.</span> <span class="toc-text">关于顺序和分区</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.2.</span> <span class="toc-text">关于高可用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">2.</span> <span class="toc-text">RocketMQ 的工具和编程接口</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">2.1.</span> <span class="toc-text">RocketMQ 的工具</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">2.2.</span> <span class="toc-text">RocketMQ 的 Java API</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">3.</span> <span class="toc-text">RocketMQ 的主备模式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">4.</span> <span class="toc-text">RocketMQ 最佳实践</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.</span> <span class="toc-text">后记</span></a></li></ol>
		</div>
		
		<p>RocketMQ 是出自 A 公司的开源产品，用 Java 语言实现，在设计时参考了 Kafka，并做出了自己的一些改进，消息可靠性上比 Kafka 更好，目前，RocketMQ 的文档仍然不够丰富 <a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a> <a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a>，社区仍然无法与 Kafka 比肩，但 A 公司已经推出了基于 RocketMQ 的云产品 <a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a>，相信未来 RocketMQ 也会有不错的发展。本文采用 RocketMQ 3.2.6 进行实验，由于 RocketMQ 与 Kafka 很相似，本文很多地方对两者做出了比较。</p>
<h2>基本概念</h2>
<p>RocketMQ 由于借鉴了 Kafka 的设计，包括组件的命名也很多与 Kafka 相似，下面摘抄一段《RocketMQ 原理简介》中的介绍，可以与 Kafka 的命名比对一下，</p>
<ul>
<li>Producer，消息生产者，负责产生消息，一般由业务系统负责产生消息。</li>
<li>Consumer，消息消费者，负责消费消息，一般是后台系统负责异步消费。</li>
<li>Push Consumer，Consumer 的一种，应用通常向 Consumer 对象注册一个 Listener 接口，一旦收到消息，Consumer 对象立
刻回调 Listener 接口方法。</li>
<li>Pull Consumer，Consumer 的一种，应用通常主动调用 Consumer 的拉消息方法从 Broker 拉消息，主动权由应用控制。</li>
<li>Producer Group，一类 Producer 的集合名称，这类 Producer 通常发送一类消息，且发送逻辑一致。</li>
<li>Consumer Group，一类 Consumer 的集合名称，这类 Consumer 通常消费一类消息，且消费逻辑一致。</li>
<li>Broker，消息中转角色，负责存储消息，转发消息，一般也称为 Server。在 JMS 规范中称为 Provider。</li>
</ul>
<p>《RocketMQ 原理简介》中还介绍了一些其他的概念，例如，广播消费和集群消费，广播消费是 Consumer Group 中对于同一条消息每个 Consumer 都消费，集群消费是 Consumer Group 中对于同一条消息只有一个 Consumer 消费。Kafka 采用的是集群消费，不支持广播消费（好吧，是我没有找到）。再例如，普通顺序消息和严格顺序消息，普通顺序消息在 Broker 重启情况下不会保证消息顺序性；严格顺序消息即使在异常情况下也会保证消息的顺序性。个人理解，所谓普通顺序消息，应该就是 Kafka 中的 Partition 级别有序，严格顺序消息，应该是 Topic 级别有序，但文中也提到，这样的有序级别是要付出代价的，Broker 集群中只要有一台机器不可用，则整个集群都不可用，降低服务可用性。使用这种模式，需要依赖同步双写，主备自动切换，但自动切换功能目前还未实现（我猜，自动切换仅仅是没开源吧）。说白了，严格顺序消息不具备生产可用性，自己玩玩还行，其应用场景主要是数据库 binlog 同步。</p>
<p>关于 RocketMQ 和 Kafka 的对比，可以参考 RocketMQ Wiki 中的文章 <a href="#fn4" class="footnoteRef" id="fnref4"><sup>4</sup></a>，看看就行，不必较真。</p>
<h3>关于顺序和分区</h3>
<p>顺序性的话题，刚才已经提到了一些，RocketMQ 的实现应该不弱于 Kafka。对于分区，RocketMQ 似乎有意弱化了这个概念，只有在 Producer 中有一个参数 <code>defaultTopicQueueNums</code>，分区在 RocketMQ 中有时被称为队列。RocketMQ 的普通顺序消息模式，应该就是分区顺序性，这点与 Kafka 一致。</p>
<h3>关于高可用</h3>
<p>RocketMQ 实现高可用的方式有多种，《RocketMQ 用户指南》文档中提到的有：多主模式、多主多从异步复制模式、多主多从同步复制模式。多主模式下，性能较好，但是在 Broker 宕机的时候，该 Broker 上未消费的交易不可消费；多主多从异步复制模式，与 Kafka 的副本模式比较类似，主 Broker 宕机后，会自动切换到从 Broker，消息的消费不会出现间断；多主多从同步复制模式更进一步，采用同步刷盘的方式，避免了主 Broker 宕机带来的消息丢失，但是，目前不支持自动切换。</p>
<p>虽然 RocketMQ 提供了多种高可用方式，但是目前能生产使用的就只有多主多从异步复制模式，即使在这个模式上，其实现也比 Kafka 要差。因为 RocketMQ 的机制中，主从关系是人为指定的，主 Broker 上承担所有的消息派发，而 Kafka 的主从关系是通过选举的方式选出来的，每个分区的主节点都是不一样的，可以从不同的节点派发消息。Kafka 的模式是分散模式，有利于负载均衡，而且当一个 Broker 宕机的时候，只影响部分 Topic，而 RocketMQ 一旦主 Broker 宕机，会影响所有的 Topic。另外，Kafka 可以支持 Broker 间同步复制（通过设置 Broker 的 <code>acks</code> 参数），这样比的话，RocketMQ 就差太多了。</p>
<p>关于 RocketMQ 的介绍，网上的文章不算太多，也比较杂，《分布式开放消息系统(RocketMQ)的原理与实践》<a href="#fn5" class="footnoteRef" id="fnref5"><sup>5</sup></a> <a href="#fn6" class="footnoteRef" id="fnref6"><sup>6</sup></a> <a href="#fn7" class="footnoteRef" id="fnref7"><sup>7</sup></a>这篇原理介绍的不错，推荐。</p>
<h2>RocketMQ 的工具和编程接口</h2>
<h3>RocketMQ 的工具</h3>
<p>相比较 Kafka 而言，RocketMQ 提供的工具要少一些，如下，</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">bin/mqadmin</div><div class="line">bin/mqbroker</div><div class="line">bin/mqbroker.numanode0</div><div class="line">bin/mqbroker.numanode1</div><div class="line">bin/mqbroker.numanode2</div><div class="line">bin/mqbroker.numanode3</div><div class="line">bin/mqfiltersrv</div><div class="line">bin/mqnamesrv</div><div class="line">bin/mqshutdown</div></pre></td></tr></table></figure></p>
<p>除了进程启停之外，常用的运维命令都在 <code>mqadmin</code> 中，详见《RocketMQ 运维指令》文档。我实验中常用的一些命令如下，</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="title">sh</span> mqnamesrv &</div><div class="line">sh mqbroker -c async-broker-a.properties &</div><div class="line">sh mqbroker -c async-broker-a-s.properties &</div><div class="line"></div><div class="line">sh mqadmin topicList -n <span class="number">192.168.232.23:9876</span></div><div class="line">sh mqadmin topicRoute -n <span class="number">192.168.232.23:9876</span> -t TopicTestjjj</div><div class="line">sh mqadmin clusterList -n <span class="number">192.168.232.23:9876</span></div><div class="line">sh mqadmin deleteTopic -c DefaultCluster -n <span class="number">192.168.232.23:9876</span> -t TopicTestjjj</div><div class="line">sh mqadmin consumerProgress -n <span class="number">192.168.232.23:9876</span> -g ConsumerGroupNamecc4</div><div class="line">sh mqadmin deleteSubGroup -c DefaultCluster -n <span class="number">192.168.232.23:9876</span> -g ConsumerGroupNamecc4</div><div class="line">sh mqadmin consumerConnection -n <span class="number">192.168.232.23:9876</span> -g ConsumerGroupNamecc4</div></pre></td></tr></table></figure></p>
<p>RocketMQ 使用了自己的 name server 来做调度（Kafka 用了 Zookeeper），使用 <code>sh mqnamesrv</code> 来启动，默认监听端口9876，<code>sh mqnamesrv -m</code> 可以查看所有默认参数，使用 <code>-c xxxx.properties</code> 参数来指定自定义配置。<code>sh mqbroker</code> 是用于启动 Broker 的命令，参数比较多，详细可以通过 <code>sh mqbroker -m</code> 查看默认参数，配置项细节后文再说。<code>sh mqadmin</code> 是运维命令入口，<code>topicList</code> 是列出所有 Topic；<code>topicRoute</code> 是列出单个 Topic 的详细信息；<code>clusterList</code> 是列出集群的信息；<code>deleteTopic</code> 是删除 Topic。<code>consumerProgress</code> 是查看消费者消费进度，<code>deleteSubGroup</code> 是删除消费者的订阅，<code>consumerConnection</code> 是查询消费者订阅的情况。</p>
<p>Broker 的配置是最多的，实验中我修改到的部分如下，其他使用默认，</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="variable">brokerClusterName=</span>DefaultCluster</div><div class="line"><span class="variable">brokerIP1=</span><span class="number">192.168</span>.<span class="number">232.23</span></div><div class="line"><span class="variable">brokerName=</span>broker-a</div><div class="line"><span class="variable">brokerId=</span><span class="number">0</span></div><div class="line"><span class="variable">namesrvAddr=</span><span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">9876</span></div><div class="line"><span class="variable">listenPort=</span><span class="number">10911</span></div><div class="line"><span class="variable">deleteWhen=</span><span class="number">04</span></div><div class="line"><span class="variable">fileReservedTime=</span><span class="number">120</span></div><div class="line"></div><div class="line"><span class="variable">storePathRootDir=</span>/home/arnes/alibaba-rocketmq/data/store-a-async</div><div class="line"><span class="variable">storePathCommitLog=</span>/home/arnes/alibaba-rocketmq/data/store-a-async/commitlog</div><div class="line"></div><div class="line"><span class="variable">brokerRole=</span>ASYNC_MASTER</div><div class="line"><span class="variable">flushDiskType=</span>ASYNC_FLUSH</div></pre></td></tr></table></figure></p>
<p>配置文件中的多数配置看例子就可以知道意思，挑几个说一下。<code>brokerName</code> 和 <code>brokerId</code>， 同名的 Broker，ID 是0的是主节点，其他是从节点；<code>deleteWhen</code>，删除文件时间点，默认凌晨4点；<code>fileReservedTime</code>，文件保留时间，设置为120小时；<code>brokerRole</code>，Broker 的角色，ASYNC_MASTER 是异步复制主节点，SYNC_MASTER 是同步双写主节点，SLAVE 是备节点。</p>
<p>其实，这些工具的写法也基本一致，都是先做一些检查，最后运行 Java 程序，JVM 系统上的应用应该差不多都这样。</p>
<h3>RocketMQ 的 Java API</h3>
<p>RocketMQ 是用 Java 语言开发的，因此，其 Java API 相对是比较丰富的，当然也有部分原因是 RocketMQ 本身提供的功能就比较多。RocketMQ API 提供的功能包括，</p>
<ol>
<li>广播消费，这个在之前已经提到过；</li>
<li>消息过滤，支持简单的 Message Tag 过滤，也支持按 Message Header、body 过滤；</li>
<li>顺序消费和乱序消费，之前也提到过，这里的顺序消费应该指的是普通顺序性，这一点与 Kafka 相同；</li>
<li>Pull 模式消费，这个是相对 Push 模式来说的，Kafka 就是 Pull 模式消费；</li>
<li>事务消息，这个好像没有开源，但是 example 代码中有示例，总之，不推荐用；</li>
<li>Tag，RocketMQ 在 Topic 下面又分了一层 Tag，用于表示消息类别，可以用来过滤，但是顺序性还是以 Topic 来看；</li>
</ol>
<p>单看功能的话，即使不算事务消息，也不算 Tag，RocketMQ 也远超 Kafka，Kafka 应该只实现了 Pull 模式消费 + 顺序消费这2个功能。RocketMQ 的代码示例在 rocketmq-example 中，注意，代码是不能直接运行的，因为所有的代码都少了设置 name server 的部分，需要自己手动加上，例如，<code>producer.setNamesrvAddr(&quot;192.168.232.23:9876&quot;);</code>。</p>
<p>先来看一下生产者的 API，比较简单，只有一种，如下，</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> com.alibaba.rocketmq.client.exception.MQClientException;</div><div class="line"><span class="keyword">import</span> com.alibaba.rocketmq.client.producer.DefaultMQProducer;</div><div class="line"><span class="keyword">import</span> com.alibaba.rocketmq.client.producer.MessageQueueSelector;</div><div class="line"><span class="keyword">import</span> com.alibaba.rocketmq.client.producer.SendResult;</div><div class="line"><span class="keyword">import</span> com.alibaba.rocketmq.common.message.Message;</div><div class="line"><span class="keyword">import</span> com.alibaba.rocketmq.common.message.MessageQueue;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Producer</span> </span>{</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span>(String[] args) <span class="keyword">throws</span> MQClientException, InterruptedException {</div><div class="line">        DefaultMQProducer producer = <span class="keyword">new</span> DefaultMQProducer(<span class="string">"ProducerGroupName"</span>);</div><div class="line">        producer.setNamesrvAddr(<span class="string">"192.168.232.23:9876"</span>);</div><div class="line"></div><div class="line">        producer.start();</div><div class="line"></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</div><div class="line">            <span class="keyword">try</span> {</div><div class="line">                {</div><div class="line">                    Message msg = <span class="keyword">new</span> Message(<span class="string">"TopicTest1"</span>,<span class="comment">// topic</span></div><div class="line">                        <span class="string">"TagA"</span>,<span class="comment">// tag</span></div><div class="line">                        <span class="string">"OrderID188"</span>,<span class="comment">// key</span></div><div class="line">                        (<span class="string">"RocketMQ "</span>+String.format(<span class="string">"%05d"</span>, i)).getBytes());<span class="comment">// body</span></div><div class="line">                    SendResult sendResult = producer.send(msg, <span class="keyword">new</span> MessageQueueSelector() {</div><div class="line">                        <span class="annotation">@Override</span></div><div class="line">                        <span class="keyword">public</span> MessageQueue <span class="title">select</span>(List&lt;MessageQueue&gt; mqs, Message msg, Object arg) {</div><div class="line">                            Integer id = (Integer) arg;</div><div class="line">                            <span class="keyword">int</span> index = id % mqs.size();</div><div class="line">                            <span class="keyword">return</span> mqs.get(index);</div><div class="line">                        }</div><div class="line">                    }, i));</div><div class="line">                    System.out.println(String.format(<span class="string">"%05d"</span>, i)+sendResult);</div><div class="line">                }</div><div class="line"></div><div class="line">            }</div><div class="line">            <span class="keyword">catch</span> (Exception e) {</div><div class="line">                e.printStackTrace();</div><div class="line">            }</div><div class="line"></div><div class="line">        producer.shutdown();</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure></p>
<p>可以发现，相比 Kafka 的 API，只多了 Tag，但实际上行为有很大不同。Kafka 的生产者客户端，有同步和异步两种模式，但都是阻塞模式，<code>send</code> 方法返回发送状态的 <code>Future</code>，可以通过 <code>Future</code> 的 <code>get</code> 方法阻塞获得发送状态。而 RocketMQ 采用的是同步非阻塞模式，发送之后立刻返回发送状态（而不是 <code>Future</code>）。正常情况下，两者使用上差别不大，但是在高可用场景中发生主备切换的时候，Kafka 的同步可以等待切换完成并重连，最后返回；而 RocketMQ 只能立刻报错，由生产者选择是否重发。所以，在生产者的 API 上，其实 Kafka 是要强一些的。</p>
<p>另外，RocketMQ 可以通过指定 <code>MessageQueueSelector</code> 类的实现来指定将消息发送到哪个分区去，Kafka 是通过指定生产者的 <code>partitioner.class</code> 参数来实现的，灵活性上 RocketMQ 略胜一筹。</p>
<p>再来看消费者的API，由于 RocketMQ 的功能比较多，我们先看 Pull 模式消费的API，如下，</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.HashMap;</div><div class="line"><span class="keyword">import</span> java.util.Map;</div><div class="line"><span class="keyword">import</span> java.util.Set;</div><div class="line"></div><div class="line"><span class="keyword">import</span> com.alibaba.rocketmq.client.consumer.DefaultMQPullConsumer;</div><div class="line"><span class="keyword">import</span> com.alibaba.rocketmq.client.consumer.PullResult;</div><div class="line"><span class="keyword">import</span> com.alibaba.rocketmq.client.consumer.store.OffsetStore;</div><div class="line"><span class="keyword">import</span> com.alibaba.rocketmq.client.consumer.store.RemoteBrokerOffsetStore;</div><div class="line"><span class="keyword">import</span> com.alibaba.rocketmq.client.exception.MQClientException;</div><div class="line"><span class="keyword">import</span> com.alibaba.rocketmq.common.message.MessageExt;</div><div class="line"><span class="keyword">import</span> com.alibaba.rocketmq.common.message.MessageQueue;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PullConsumer</span> </span>{</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Map&lt;MessageQueue, Long&gt; offseTable = <span class="keyword">new</span> HashMap&lt;MessageQueue, Long&gt;();</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span>(String[] args) <span class="keyword">throws</span> MQClientException {</div><div class="line">        DefaultMQPullConsumer consumer = <span class="keyword">new</span> DefaultMQPullConsumer(<span class="string">"please_rename_unique_group_name_5"</span>);</div><div class="line">        consumer.setNamesrvAddr(<span class="string">"192.168.232.23:9876"</span>);</div><div class="line"></div><div class="line">        consumer.start();</div><div class="line"></div><div class="line">        Set&lt;MessageQueue&gt; mqs = consumer.fetchSubscribeMessageQueues(<span class="string">"TopicTest1"</span>);</div><div class="line">        <span class="keyword">for</span> (MessageQueue mq : mqs) {</div><div class="line">            System.out.println(<span class="string">"Consume from the queue: "</span> + mq);</div><div class="line">            SINGLE_MQ: <span class="keyword">while</span> (<span class="keyword">true</span>) {</div><div class="line">                <span class="keyword">try</span> {</div><div class="line">                    <span class="keyword">long</span> offset = consumer.fetchConsumeOffset(mq, <span class="keyword">true</span>);</div><div class="line">                    PullResult pullResult =</div><div class="line">                            consumer.pullBlockIfNotFound(mq, <span class="keyword">null</span>, getMessageQueueOffset(mq), <span class="number">32</span>);</div><div class="line">                    <span class="keyword">if</span> (<span class="keyword">null</span> != pullResult.getMsgFoundList()) {</div><div class="line">                        <span class="keyword">for</span> (MessageExt messageExt : pullResult.getMsgFoundList()) {</div><div class="line">                            System.out.print(<span class="keyword">new</span> String(messageExt.getBody()));</div><div class="line">                            System.out.print(pullResult);</div><div class="line">                            System.out.println(messageExt);</div><div class="line">                        }</div><div class="line">                    }</div><div class="line">                    putMessageQueueOffset(mq, pullResult.getNextBeginOffset());</div><div class="line">                    <span class="keyword">switch</span> (pullResult.getPullStatus()) {</div><div class="line">                    <span class="keyword">case</span> FOUND:</div><div class="line">                        <span class="comment">// TODO</span></div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    <span class="keyword">case</span> NO_MATCHED_MSG:</div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    <span class="keyword">case</span> NO_NEW_MSG:</div><div class="line">                        <span class="keyword">break</span> SINGLE_MQ;</div><div class="line">                    <span class="keyword">case</span> OFFSET_ILLEGAL:</div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    <span class="keyword">default</span>:</div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    }</div><div class="line">                }</div><div class="line">                <span class="keyword">catch</span> (Exception e) {</div><div class="line">                    e.printStackTrace();</div><div class="line">                }</div><div class="line">            }</div><div class="line">        }</div><div class="line"></div><div class="line">        consumer.shutdown();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">putMessageQueueOffset</span>(MessageQueue mq, <span class="keyword">long</span> offset) {</div><div class="line">        offseTable.put(mq, offset);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">long</span> <span class="title">getMessageQueueOffset</span>(MessageQueue mq) {</div><div class="line">        Long offset = offseTable.get(mq);</div><div class="line">        <span class="keyword">if</span> (offset != <span class="keyword">null</span>)</div><div class="line">            <span class="keyword">return</span> offset;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure></p>
<p>这部分的 API 其实是和 Kafka 很相似的，唯一不同的是，RocketMQ 需要手工管理 offset 和指定分区，而 Kafka 可以自动管理（当然也可以手动管理），并且不需要指定分区（分区是在 Kafka 订阅的时候指定的）。例子中，RocketMQ 使用 HashMap 自行管理，也可以用 <code>OffsetStore</code> 接口，提供了两种管理方式，本地文件和远程 Broker。这部分感觉两者差不多。</p>
<p>下面再看看 Push 模式顺序消费，代码如下，</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor"><span class="keyword">import</span> java.util.List;</span></div><div class="line"><span class="preprocessor"><span class="keyword">import</span> java.util.concurrent.atomic.AtomicLong;</span></div><div class="line"></div><div class="line"><span class="preprocessor"><span class="keyword">import</span> com.alibaba.rocketmq.client.consumer.DefaultMQPushConsumer;</span></div><div class="line"><span class="preprocessor"><span class="keyword">import</span> com.alibaba.rocketmq.client.consumer.listener.ConsumeOrderlyContext;</span></div><div class="line"><span class="preprocessor"><span class="keyword">import</span> com.alibaba.rocketmq.client.consumer.listener.ConsumeOrderlyStatus;</span></div><div class="line"><span class="preprocessor"><span class="keyword">import</span> com.alibaba.rocketmq.client.consumer.listener.MessageListenerOrderly;</span></div><div class="line"><span class="preprocessor"><span class="keyword">import</span> com.alibaba.rocketmq.client.exception.MQClientException;</span></div><div class="line"><span class="preprocessor"><span class="keyword">import</span> com.alibaba.rocketmq.common.consumer.ConsumeFromWhere;</span></div><div class="line"><span class="preprocessor"><span class="keyword">import</span> com.alibaba.rocketmq.common.message.MessageExt;</span></div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Consumer</span> </span>{</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(String[] args) throws MQClientException {</div><div class="line">        DefaultMQPushConsumer consumer = <span class="keyword">new</span> DefaultMQPushConsumer(<span class="string">"please_rename_unique_group_name_3"</span>);</div><div class="line">        consumer.setNamesrvAddr(<span class="string">"192.168.232.23:9876"</span>);</div><div class="line">        consumer.setConsumeFromWhere(ConsumeFromWhere.CONSUME_FROM_FIRST_OFFSET);</div><div class="line"></div><div class="line">        consumer.subscribe(<span class="string">"TopicTest1"</span>, <span class="string">"TagA || TagC || TagD"</span>);</div><div class="line"></div><div class="line">        consumer.registerMessageListener(<span class="keyword">new</span> MessageListenerOrderly() {</div><div class="line">            AtomicLong consumeTimes = <span class="keyword">new</span> AtomicLong(<span class="number">0</span>);</div><div class="line"></div><div class="line">            @Override</div><div class="line">            <span class="keyword">public</span> ConsumeOrderlyStatus consumeMessage(List&lt;MessageExt&gt; msgs, ConsumeOrderlyContext context) {</div><div class="line">                context.setAutoCommit(<span class="literal">false</span>);</div><div class="line">                System.out.println(Thread.currentThread().getName() + <span class="string">" Receive New Messages: "</span> + msgs);</div><div class="line">                <span class="keyword">this</span>.consumeTimes.incrementAndGet();</div><div class="line">                <span class="keyword">if</span> ((<span class="keyword">this</span>.consumeTimes.<span class="keyword">get</span>() % <span class="number">2</span>) == <span class="number">0</span>) {</div><div class="line">                    <span class="keyword">return</span> ConsumeOrderlyStatus.SUCCESS;</div><div class="line">                }</div><div class="line">                <span class="keyword">else</span> <span class="keyword">if</span> ((<span class="keyword">this</span>.consumeTimes.<span class="keyword">get</span>() % <span class="number">3</span>) == <span class="number">0</span>) {</div><div class="line">                    <span class="keyword">return</span> ConsumeOrderlyStatus.ROLLBACK;</div><div class="line">                }</div><div class="line">                <span class="keyword">else</span> <span class="keyword">if</span> ((<span class="keyword">this</span>.consumeTimes.<span class="keyword">get</span>() % <span class="number">4</span>) == <span class="number">0</span>) {</div><div class="line">                    <span class="keyword">return</span> ConsumeOrderlyStatus.COMMIT;</div><div class="line">                }</div><div class="line">                <span class="keyword">else</span> <span class="keyword">if</span> ((<span class="keyword">this</span>.consumeTimes.<span class="keyword">get</span>() % <span class="number">5</span>) == <span class="number">0</span>) {</div><div class="line">                    context.setSuspendCurrentQueueTimeMillis(<span class="number">3000</span>);</div><div class="line">                    <span class="keyword">return</span> ConsumeOrderlyStatus.SUSPEND_CURRENT_QUEUE_A_MOMENT;</div><div class="line">                }</div><div class="line"></div><div class="line">                <span class="keyword">return</span> ConsumeOrderlyStatus.SUCCESS;</div><div class="line">            }</div><div class="line">        });</div><div class="line"></div><div class="line">        consumer.start();</div><div class="line"></div><div class="line">        System.out.println(<span class="string">"Consumer Started."</span>);</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure></p>
<p>虽然提供了 Push 模式，RocketMQ 内部实际上还是 Pull 模式的 MQ，Push 模式的实现应该采用的是长轮询，这点与 Kafka 一样。使用该方式有几个注意的地方，</p>
<ol>
<li>接收消息的监听类要使用 <code>MessageListenerOrderly</code>；</li>
<li><code>ConsumeFromWhere</code> 有几个参数，表示从头开始消费，从尾开始消费，还是从某个 TimeStamp 开始消费；</li>
<li>可以控制 offset 的提交，应该就是 <code>context.setAutoCommit(false);</code> 的作用；</li>
</ol>
<p>控制 offset 提交这个特性非常有用，某种程度上扩展一下，就可以当做事务来用了，看代码 <code>ConsumeMessageOrderlyService</code> 的实现，其实并没有那么复杂，在不启用 AutoCommit 的时候，只有返回 <code>COMMIT</code> 才 commit offset；启用 AutoCommit 的时候，返回 <code>COMMIT</code>、<code>ROLLBACK</code>（这个比较扯）、<code>SUCCESS</code> 的时候，都 commit offset。</p>
<blockquote>
<p>后来发现，commit offset 功能在 Kafka 里面也有提供，使用新的 API，调用 <code>consumer.commitSync</code>。</p>
</blockquote>
<p>再看一个 Push 模式乱序消费 + 消息过滤的例子，消费者的代码如下，</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor"><span class="keyword">import</span> java.util.List;</span></div><div class="line"></div><div class="line"><span class="preprocessor"><span class="keyword">import</span> com.alibaba.rocketmq.client.consumer.DefaultMQPushConsumer;</span></div><div class="line"><span class="preprocessor"><span class="keyword">import</span> com.alibaba.rocketmq.client.consumer.listener.ConsumeConcurrentlyContext;</span></div><div class="line"><span class="preprocessor"><span class="keyword">import</span> com.alibaba.rocketmq.client.consumer.listener.ConsumeConcurrentlyStatus;</span></div><div class="line"><span class="preprocessor"><span class="keyword">import</span> com.alibaba.rocketmq.client.consumer.listener.MessageListenerConcurrently;</span></div><div class="line"><span class="preprocessor"><span class="keyword">import</span> com.alibaba.rocketmq.client.exception.MQClientException;</span></div><div class="line"><span class="preprocessor"><span class="keyword">import</span> com.alibaba.rocketmq.common.message.MessageExt;</span></div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Consumer</span> </span>{</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(String[] args) throws InterruptedException, MQClientException {</div><div class="line">        DefaultMQPushConsumer consumer = <span class="keyword">new</span> DefaultMQPushConsumer(<span class="string">"ConsumerGroupNamecc4"</span>);</div><div class="line">        consumer.setNamesrvAddr(<span class="string">"192.168.232.23:9876"</span>);</div><div class="line">        consumer.subscribe(<span class="string">"TopicTest1"</span>, MessageFilterImpl.<span class="keyword">class</span>.getCanonicalName());</div><div class="line"></div><div class="line">        consumer.registerMessageListener(<span class="keyword">new</span> MessageListenerConcurrently() {</div><div class="line"></div><div class="line">            @Override</div><div class="line">            <span class="keyword">public</span> ConsumeConcurrentlyStatus consumeMessage(List&lt;MessageExt&gt; msgs,</div><div class="line">                    ConsumeConcurrentlyContext context) {</div><div class="line">                System.out.println(Thread.currentThread().getName() + <span class="string">" Receive New Messages: "</span> + msgs);</div><div class="line">                <span class="keyword">return</span> ConsumeConcurrentlyStatus.CONSUME_SUCCESS;</div><div class="line">            }</div><div class="line">        });</div><div class="line"></div><div class="line">        consumer.start();</div><div class="line"></div><div class="line">        System.out.println(<span class="string">"Consumer Started."</span>);</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure></p>
<p>这个例子与之前顺序消费不同的地方在于，</p>
<ol>
<li>接收消息的监听类使用的是 <code>MessageListenerConcurrently</code>；</li>
<li>回调方法中，使用的是自动 offset commit；</li>
<li>订阅的时候增加了消息过滤类 <code>MessageFilterImpl</code>；</li>
</ol>
<p>消息过滤类 <code>MessageFilterImpl</code> 的代码如下，</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> com.alibaba.rocketmq.common.filter.MessageFilter;</div><div class="line"><span class="keyword">import</span> com.alibaba.rocketmq.common.message.MessageExt;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MessageFilterImpl</span> <span class="keyword">implements</span> <span class="title">MessageFilter</span> </span>{</div><div class="line"></div><div class="line">    <span class="annotation">@Override</span></div><div class="line">    <span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">match</span>(MessageExt msg) {</div><div class="line">        String property = msg.getUserProperty(<span class="string">"SequenceId"</span>);</div><div class="line">        <span class="keyword">if</span> (property != <span class="keyword">null</span>) {</div><div class="line">            <span class="keyword">int</span> id = Integer.parseInt(property);</div><div class="line">            <span class="keyword">if</span> ((id % <span class="number">3</span>) == <span class="number">0</span> && (id &gt; <span class="number">10</span>)) {</div><div class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">            }</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure></p>
<p>RocketMQ 执行过滤是在 Broker 端，Broker 所在的机器会启动多个 FilterServer 过滤进程；Consumer 启动后，会向 FilterServer 上传一个过滤的 Java 类；Consumer 从 FilterServer 拉消息，FilterServer 将请求转发给 Broker，FilterServer 从 Broker 收到消息后，按照 Consumer 上传的 Java 过滤程序做过滤，过滤完成后返回给 Consumer。这种过滤方法可以节省网络流量，但是增加了 Broker 的负担。可惜我没有实验出来使用过滤的效果，即使是用 github wiki 上的例子<a href="#fn8" class="footnoteRef" id="fnref8"><sup>8</sup></a>也没成功，不纠结了。RocketMQ 的按 Tag 过滤的功能也是在 Broker 上做的过滤，能用，是个很方便的功能。</p>
<p>还有一种广播消费模式，比较简单，可以去看代码，不再列出。</p>
<p>总之，RocketMQ 提供的功能比较多，比 Kafka 多很多易用的 API。</p>
<h2>RocketMQ 的主备模式</h2>
<p>按之前所说，只有 RocketMQ 的多主多从异步复制是可以生产使用的，因此只在这个场景下测试。另外，消息采用 Push 顺序模式消费。</p>
<p>假设集群采用2主2备的模式，需要启动4个 Broker，配置文件如下，</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="variable">brokerName=</span>broker-a</div><div class="line"><span class="variable">brokerId=</span><span class="number">0</span></div><div class="line"><span class="variable">listenPort=</span><span class="number">10911</span></div><div class="line"><span class="variable">storePathRootDir=</span>/home/arnes/alibaba-rocketmq/data/store-a-async</div><div class="line"><span class="variable">storePathCommitLog=</span>/home/arnes/alibaba-rocketmq/data/store-a-async/commitlog</div><div class="line"><span class="variable">brokerRole=</span>ASYNC_MASTER</div><div class="line"></div><div class="line"><span class="variable">brokerName=</span>broker-a</div><div class="line"><span class="variable">brokerId=</span><span class="number">1</span></div><div class="line"><span class="variable">listenPort=</span><span class="number">10921</span></div><div class="line"><span class="variable">storePathRootDir=</span>/home/arnes/alibaba-rocketmq/data/store-a-async-slave</div><div class="line"><span class="variable">storePathCommitLog=</span>/home/arnes/alibaba-rocketmq/data/store-a-async-slave/commitlog</div><div class="line"><span class="variable">brokerRole=</span>SLAVE</div><div class="line"></div><div class="line"><span class="variable">brokerName=</span>broker-b</div><div class="line"><span class="variable">brokerId=</span><span class="number">0</span></div><div class="line"><span class="variable">listenPort=</span><span class="number">20911</span></div><div class="line"><span class="variable">storePathRootDir=</span>/home/arnes/alibaba-rocketmq/data/store-b-async</div><div class="line"><span class="variable">storePathCommitLog=</span>/home/arnes/alibaba-rocketmq/data/store-b-async/commitlog</div><div class="line"><span class="variable">brokerRole=</span>ASYNC_MASTER</div><div class="line"></div><div class="line"><span class="variable">brokerRole=</span>ASYNC_MASTER</div><div class="line"><span class="variable">brokerName=</span>broker-b</div><div class="line"><span class="variable">brokerId=</span><span class="number">1</span></div><div class="line"><span class="variable">listenPort=</span><span class="number">20921</span></div><div class="line"><span class="variable">storePathRootDir=</span>/home/arnes/alibaba-rocketmq/data/store-b-async-slave</div><div class="line"><span class="variable">storePathCommitLog=</span>/home/arnes/alibaba-rocketmq/data/store-b-async-slave/commitlog</div><div class="line"><span class="variable">brokerRole=</span>SLAVE</div></pre></td></tr></table></figure></p>
<p>另外，每个机构共通的配置项如下，</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="variable">brokerClusterName=</span>DefaultCluster</div><div class="line"><span class="variable">brokerIP1=</span><span class="number">192.168</span>.<span class="number">232.23</span></div><div class="line"><span class="variable">namesrvAddr=</span><span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">9876</span></div><div class="line"><span class="variable">deleteWhen=</span><span class="number">04</span></div><div class="line"><span class="variable">fileReservedTime=</span><span class="number">120</span></div><div class="line"><span class="variable">flushDiskType=</span>ASYNC_FLUSH</div></pre></td></tr></table></figure></p>
<p>其他设置均采用默认。启动 NameServer 和所有 Broker，并试运行一下 Producer，然后看一下 TestTopic1 当前的情况，</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$ </span>sh mqadmin topicRoute -n <span class="number">192.168</span>.<span class="number">232.23</span><span class="symbol">:</span><span class="number">9876</span> -t <span class="constant">TopicTest1</span></div><div class="line">{</div><div class="line">        <span class="string">"brokerDatas"</span><span class="symbol">:</span>[</div><div class="line">                {</div><div class="line">                        <span class="string">"brokerAddrs"</span><span class="symbol">:</span>{<span class="number">0</span><span class="symbol">:<span class="string">"192.168.232.23:20911"</span></span>,<span class="number">1</span><span class="symbol">:<span class="string">"192.168.232.23:20921"</span></span></div><div class="line">                        },</div><div class="line">                        <span class="string">"brokerName"</span><span class="symbol">:<span class="string">"broker-b"</span></span></div><div class="line">                },</div><div class="line">                {</div><div class="line">                        <span class="string">"brokerAddrs"</span><span class="symbol">:</span>{<span class="number">0</span><span class="symbol">:<span class="string">"192.168.232.23:10911"</span></span>,<span class="number">1</span><span class="symbol">:<span class="string">"192.168.232.23:10921"</span></span></div><div class="line">                        },</div><div class="line">                        <span class="string">"brokerName"</span><span class="symbol">:<span class="string">"broker-a"</span></span></div><div class="line">                }</div><div class="line">        ],</div><div class="line">        <span class="string">"filterServerTable"</span><span class="symbol">:</span>{},</div><div class="line">        <span class="string">"queueDatas"</span><span class="symbol">:</span>[</div><div class="line">                {</div><div class="line">                        <span class="string">"brokerName"</span><span class="symbol">:<span class="string">"broker-a"</span></span>,</div><div class="line">                        <span class="string">"perm"</span><span class="symbol">:</span><span class="number">6</span>,</div><div class="line">                        <span class="string">"readQueueNums"</span><span class="symbol">:</span><span class="number">4</span>,</div><div class="line">                        <span class="string">"topicSynFlag"</span><span class="symbol">:</span><span class="number">0</span>,</div><div class="line">                        <span class="string">"writeQueueNums"</span><span class="symbol">:</span><span class="number">4</span></div><div class="line">                },</div><div class="line">                {</div><div class="line">                        <span class="string">"brokerName"</span><span class="symbol">:<span class="string">"broker-b"</span></span>,</div><div class="line">                        <span class="string">"perm"</span><span class="symbol">:</span><span class="number">6</span>,</div><div class="line">                        <span class="string">"readQueueNums"</span><span class="symbol">:</span><span class="number">4</span>,</div><div class="line">                        <span class="string">"topicSynFlag"</span><span class="symbol">:</span><span class="number">0</span>,</div><div class="line">                        <span class="string">"writeQueueNums"</span><span class="symbol">:</span><span class="number">4</span></div><div class="line">                }</div><div class="line">        ]</div><div class="line">}</div></pre></td></tr></table></figure></p>
<p>可见，TestTopic1 在2个 Broker 上，且每个 Broker 备机也在运行。下面开始主备切换的实验，分别启动 Consumer 和 Producer 进程，消息采用 Pull 顺序模式消费。在消息发送接收过程中，使用 <code>kill -9</code> 停掉 <code>broker-a</code> 的主进程，模拟突然宕机。此时，TestTopic1 的状态如下，</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$ </span>sh mqadmin topicRoute -n <span class="number">192.168</span>.<span class="number">232.23</span><span class="symbol">:</span><span class="number">9876</span> -t <span class="constant">TopicTest1</span></div><div class="line">{</div><div class="line">        <span class="string">"brokerDatas"</span><span class="symbol">:</span>[</div><div class="line">                {</div><div class="line">                        <span class="string">"brokerAddrs"</span><span class="symbol">:</span>{<span class="number">0</span><span class="symbol">:<span class="string">"192.168.232.23:20911"</span></span>,<span class="number">1</span><span class="symbol">:<span class="string">"192.168.232.23:20921"</span></span></div><div class="line">                        },</div><div class="line">                        <span class="string">"brokerName"</span><span class="symbol">:<span class="string">"broker-b"</span></span></div><div class="line">                },</div><div class="line">                {</div><div class="line">                        <span class="string">"brokerAddrs"</span><span class="symbol">:</span>{<span class="number">1</span><span class="symbol">:<span class="string">"192.168.232.23:10921"</span></span></div><div class="line">                        },</div><div class="line">                        <span class="string">"brokerName"</span><span class="symbol">:<span class="string">"broker-a"</span></span></div><div class="line">                }</div><div class="line">        ],</div><div class="line">        <span class="string">"filterServerTable"</span><span class="symbol">:</span>{},</div><div class="line">        <span class="string">"queueDatas"</span><span class="symbol">:</span>[</div><div class="line">                {</div><div class="line">                        <span class="string">"brokerName"</span><span class="symbol">:<span class="string">"broker-a"</span></span>,</div><div class="line">                        <span class="string">"perm"</span><span class="symbol">:</span><span class="number">6</span>,</div><div class="line">                        <span class="string">"readQueueNums"</span><span class="symbol">:</span><span class="number">4</span>,</div><div class="line">                        <span class="string">"topicSynFlag"</span><span class="symbol">:</span><span class="number">0</span>,</div><div class="line">                        <span class="string">"writeQueueNums"</span><span class="symbol">:</span><span class="number">4</span></div><div class="line">                },</div><div class="line">                {</div><div class="line">                        <span class="string">"brokerName"</span><span class="symbol">:<span class="string">"broker-b"</span></span>,</div><div class="line">                        <span class="string">"perm"</span><span class="symbol">:</span><span class="number">6</span>,</div><div class="line">                        <span class="string">"readQueueNums"</span><span class="symbol">:</span><span class="number">4</span>,</div><div class="line">                        <span class="string">"topicSynFlag"</span><span class="symbol">:</span><span class="number">0</span>,</div><div class="line">                        <span class="string">"writeQueueNums"</span><span class="symbol">:</span><span class="number">4</span></div><div class="line">                }</div><div class="line">        ]</div><div class="line">}</div></pre></td></tr></table></figure></p>
<p><code>broker-a</code> 的节点已经减少为只有1个从节点。然后启动<code>broker-a</code> 的主节点，模拟恢复，再看一下 TestTopic1 的状态，</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$ </span>sh mqadmin topicRoute -n <span class="number">192.168</span>.<span class="number">232.23</span><span class="symbol">:</span><span class="number">9876</span> -t <span class="constant">TopicTest1</span></div><div class="line">{</div><div class="line">        <span class="string">"brokerDatas"</span><span class="symbol">:</span>[</div><div class="line">                {</div><div class="line">                        <span class="string">"brokerAddrs"</span><span class="symbol">:</span>{<span class="number">0</span><span class="symbol">:<span class="string">"192.168.232.23:20911"</span></span>,<span class="number">1</span><span class="symbol">:<span class="string">"192.168.232.23:20921"</span></span></div><div class="line">                        },</div><div class="line">                        <span class="string">"brokerName"</span><span class="symbol">:<span class="string">"broker-b"</span></span></div><div class="line">                },</div><div class="line">                {</div><div class="line">                        <span class="string">"brokerAddrs"</span><span class="symbol">:</span>{<span class="number">0</span><span class="symbol">:<span class="string">"192.168.232.23:10911"</span></span>,<span class="number">1</span><span class="symbol">:<span class="string">"192.168.232.23:10921"</span></span></div><div class="line">                        },</div><div class="line">                        <span class="string">"brokerName"</span><span class="symbol">:<span class="string">"broker-a"</span></span></div><div class="line">                }</div><div class="line">        ],</div><div class="line">        <span class="string">"filterServerTable"</span><span class="symbol">:</span>{},</div><div class="line">        <span class="string">"queueDatas"</span><span class="symbol">:</span>[</div><div class="line">                {</div><div class="line">                        <span class="string">"brokerName"</span><span class="symbol">:<span class="string">"broker-a"</span></span>,</div><div class="line">                        <span class="string">"perm"</span><span class="symbol">:</span><span class="number">6</span>,</div><div class="line">                        <span class="string">"readQueueNums"</span><span class="symbol">:</span><span class="number">4</span>,</div><div class="line">                        <span class="string">"topicSynFlag"</span><span class="symbol">:</span><span class="number">0</span>,</div><div class="line">                        <span class="string">"writeQueueNums"</span><span class="symbol">:</span><span class="number">4</span></div><div class="line">                },</div><div class="line">                {</div><div class="line">                        <span class="string">"brokerName"</span><span class="symbol">:<span class="string">"broker-b"</span></span>,</div><div class="line">                        <span class="string">"perm"</span><span class="symbol">:</span><span class="number">6</span>,</div><div class="line">                        <span class="string">"readQueueNums"</span><span class="symbol">:</span><span class="number">4</span>,</div><div class="line">                        <span class="string">"topicSynFlag"</span><span class="symbol">:</span><span class="number">0</span>,</div><div class="line">                        <span class="string">"writeQueueNums"</span><span class="symbol">:</span><span class="number">4</span></div><div class="line">                }</div><div class="line">        ]</div><div class="line">}</div></pre></td></tr></table></figure></p>
<p>此时，RocketMQ 已经恢复。</p>
<p>再来看看 Producer 和 Consumer 的日志，先看 Producer 的，如下，</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div></pre></td><td class="code"><pre><div class="line">......</div><div class="line"><span class="number">00578</span>SendResult [<span class="variable">sendStatus=</span>SEND_OK, <span class="variable">msgId=</span>C0A8E81700002A9F0000000000126F08, <span class="variable">messageQueue=</span>MessageQueue [<span class="variable">topic=</span>TopicTest1, <span class="variable">brokerName=</span>broker-a, <span class="variable">queueId=</span><span class="number">2</span>], <span class="variable">queueOffset=</span><span class="number">141</span>]</div><div class="line"><span class="number">00579</span>SendResult [<span class="variable">sendStatus=</span>SEND_OK, <span class="variable">msgId=</span>C0A8E81700002A9F0000000000126F9F, <span class="variable">messageQueue=</span>MessageQueue [<span class="variable">topic=</span>TopicTest1, <span class="variable">brokerName=</span>broker-a, <span class="variable">queueId=</span><span class="number">3</span>], <span class="variable">queueOffset=</span><span class="number">141</span>]</div><div class="line"><span class="number">00580</span>SendResult [<span class="variable">sendStatus=</span>SEND_OK, <span class="variable">msgId=</span>C0A8E817000051AF0000000000078D47, <span class="variable">messageQueue=</span>MessageQueue [<span class="variable">topic=</span>TopicTest1, <span class="variable">brokerName=</span>broker-b, <span class="variable">queueId=</span><span class="number">0</span>], <span class="variable">queueOffset=</span><span class="number">700</span>]</div><div class="line"><span class="number">00581</span>SendResult [<span class="variable">sendStatus=</span>SEND_OK, <span class="variable">msgId=</span>C0A8E817000051AF0000000000078DDE, <span class="variable">messageQueue=</span>MessageQueue [<span class="variable">topic=</span>TopicTest1, <span class="variable">brokerName=</span>broker-b, <span class="variable">queueId=</span><span class="number">1</span>], <span class="variable">queueOffset=</span><span class="number">700</span>]</div><div class="line"><span class="number">00582</span>SendResult [<span class="variable">sendStatus=</span>SEND_OK, <span class="variable">msgId=</span>C0A8E817000051AF0000000000078E75, <span class="variable">messageQueue=</span>MessageQueue [<span class="variable">topic=</span>TopicTest1, <span class="variable">brokerName=</span>broker-b, <span class="variable">queueId=</span><span class="number">2</span>], <span class="variable">queueOffset=</span><span class="number">699</span>]</div><div class="line"><span class="number">00583</span>SendResult [<span class="variable">sendStatus=</span>SEND_OK, <span class="variable">msgId=</span>C0A8E817000051AF0000000000078F0C, <span class="variable">messageQueue=</span>MessageQueue [<span class="variable">topic=</span>TopicTest1, <span class="variable">brokerName=</span>broker-b, <span class="variable">queueId=</span><span class="number">3</span>], <span class="variable">queueOffset=</span><span class="number">699</span>]</div><div class="line">com.alibaba.rocketmq.remoting.exception.RemotingConnectException: connect to &lt;<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>&gt; failed</div><div class="line">	at com.alibaba.rocketmq.remoting.netty.NettyRemotingClient.invokeSync(NettyRemotingClient.java:<span class="number">641</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.MQClientAPIImpl.sendMessageSync(MQClientAPIImpl.java:<span class="number">306</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.MQClientAPIImpl.sendMessage(MQClientAPIImpl.java:<span class="number">289</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.sendKernelImpl(DefaultMQProducerImpl.java:<span class="number">679</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.sendSelectImpl(DefaultMQProducerImpl.java:<span class="number">867</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.send(DefaultMQProducerImpl.java:<span class="number">842</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.send(DefaultMQProducerImpl.java:<span class="number">836</span>)</div><div class="line">	at com.alibaba.rocketmq.client.producer.DefaultMQProducer.send(DefaultMQProducer.java:<span class="number">164</span>)</div><div class="line">	at com.comstar.demo.rocketmq.simple.Producer.main(Producer.java:<span class="number">61</span>)</div><div class="line">com.alibaba.rocketmq.remoting.exception.RemotingConnectException: connect to &lt;<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>&gt; failed</div><div class="line">	at com.alibaba.rocketmq.remoting.netty.NettyRemotingClient.invokeSync(NettyRemotingClient.java:<span class="number">641</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.MQClientAPIImpl.sendMessageSync(MQClientAPIImpl.java:<span class="number">306</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.MQClientAPIImpl.sendMessage(MQClientAPIImpl.java:<span class="number">289</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.sendKernelImpl(DefaultMQProducerImpl.java:<span class="number">679</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.sendSelectImpl(DefaultMQProducerImpl.java:<span class="number">867</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.send(DefaultMQProducerImpl.java:<span class="number">842</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.send(DefaultMQProducerImpl.java:<span class="number">836</span>)</div><div class="line">	at com.alibaba.rocketmq.client.producer.DefaultMQProducer.send(DefaultMQProducer.java:<span class="number">164</span>)</div><div class="line">	at com.comstar.demo.rocketmq.simple.Producer.main(Producer.java:<span class="number">61</span>)</div><div class="line">com.alibaba.rocketmq.remoting.exception.RemotingConnectException: connect to &lt;<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>&gt; failed</div><div class="line">	at com.alibaba.rocketmq.remoting.netty.NettyRemotingClient.invokeSync(NettyRemotingClient.java:<span class="number">641</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.MQClientAPIImpl.sendMessageSync(MQClientAPIImpl.java:<span class="number">306</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.MQClientAPIImpl.sendMessage(MQClientAPIImpl.java:<span class="number">289</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.sendKernelImpl(DefaultMQProducerImpl.java:<span class="number">679</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.sendSelectImpl(DefaultMQProducerImpl.java:<span class="number">867</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.send(DefaultMQProducerImpl.java:<span class="number">842</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.send(DefaultMQProducerImpl.java:<span class="number">836</span>)</div><div class="line">	at com.alibaba.rocketmq.client.producer.DefaultMQProducer.send(DefaultMQProducer.java:<span class="number">164</span>)</div><div class="line">	at com.comstar.demo.rocketmq.simple.Producer.main(Producer.java:<span class="number">61</span>)</div><div class="line">com.alibaba.rocketmq.remoting.exception.RemotingConnectException: connect to &lt;<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>&gt; failed</div><div class="line">	at com.alibaba.rocketmq.remoting.netty.NettyRemotingClient.invokeSync(NettyRemotingClient.java:<span class="number">641</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.MQClientAPIImpl.sendMessageSync(MQClientAPIImpl.java:<span class="number">306</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.MQClientAPIImpl.sendMessage(MQClientAPIImpl.java:<span class="number">289</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.sendKernelImpl(DefaultMQProducerImpl.java:<span class="number">679</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.sendSelectImpl(DefaultMQProducerImpl.java:<span class="number">867</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.send(DefaultMQProducerImpl.java:<span class="number">842</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.send(DefaultMQProducerImpl.java:<span class="number">836</span>)</div><div class="line">	at com.alibaba.rocketmq.client.producer.DefaultMQProducer.send(DefaultMQProducer.java:<span class="number">164</span>)</div><div class="line">	at com.comstar.demo.rocketmq.simple.Producer.main(Producer.java:<span class="number">61</span>)</div><div class="line"><span class="number">00588</span>SendResult [<span class="variable">sendStatus=</span>SEND_OK, <span class="variable">msgId=</span>C0A8E817000051AF0000000000078FA3, <span class="variable">messageQueue=</span>MessageQueue [<span class="variable">topic=</span>TopicTest1, <span class="variable">brokerName=</span>broker-b, <span class="variable">queueId=</span><span class="number">0</span>], <span class="variable">queueOffset=</span><span class="number">701</span>]</div><div class="line"><span class="number">00589</span>SendResult [<span class="variable">sendStatus=</span>SEND_OK, <span class="variable">msgId=</span>C0A8E817000051AF000000000007903A, <span class="variable">messageQueue=</span>MessageQueue [<span class="variable">topic=</span>TopicTest1, <span class="variable">brokerName=</span>broker-b, <span class="variable">queueId=</span><span class="number">1</span>], <span class="variable">queueOffset=</span><span class="number">701</span>]</div><div class="line"><span class="number">00590</span>SendResult [<span class="variable">sendStatus=</span>SEND_OK, <span class="variable">msgId=</span>C0A8E817000051AF00000000000790D1, <span class="variable">messageQueue=</span>MessageQueue [<span class="variable">topic=</span>TopicTest1, <span class="variable">brokerName=</span>broker-b, <span class="variable">queueId=</span><span class="number">2</span>], <span class="variable">queueOffset=</span><span class="number">700</span>]</div><div class="line"><span class="number">00591</span>SendResult [<span class="variable">sendStatus=</span>SEND_OK, <span class="variable">msgId=</span>C0A8E817000051AF0000000000079168, <span class="variable">messageQueue=</span>MessageQueue [<span class="variable">topic=</span>TopicTest1, <span class="variable">brokerName=</span>broker-b, <span class="variable">queueId=</span><span class="number">3</span>], <span class="variable">queueOffset=</span><span class="number">700</span>]</div><div class="line">com.alibaba.rocketmq.remoting.exception.RemotingConnectException: connect to &lt;<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>&gt; failed</div><div class="line">	at com.alibaba.rocketmq.remoting.netty.NettyRemotingClient.invokeSync(NettyRemotingClient.java:<span class="number">641</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.MQClientAPIImpl.sendMessageSync(MQClientAPIImpl.java:<span class="number">306</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.MQClientAPIImpl.sendMessage(MQClientAPIImpl.java:<span class="number">289</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.sendKernelImpl(DefaultMQProducerImpl.java:<span class="number">679</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.sendSelectImpl(DefaultMQProducerImpl.java:<span class="number">867</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.send(DefaultMQProducerImpl.java:<span class="number">842</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.send(DefaultMQProducerImpl.java:<span class="number">836</span>)</div><div class="line">	at com.alibaba.rocketmq.client.producer.DefaultMQProducer.send(DefaultMQProducer.java:<span class="number">164</span>)</div><div class="line">	at com.comstar.demo.rocketmq.simple.Producer.main(Producer.java:<span class="number">61</span>)</div><div class="line">com.alibaba.rocketmq.remoting.exception.RemotingConnectException: connect to &lt;<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>&gt; failed</div><div class="line">	at com.alibaba.rocketmq.remoting.netty.NettyRemotingClient.invokeSync(NettyRemotingClient.java:<span class="number">641</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.MQClientAPIImpl.sendMessageSync(MQClientAPIImpl.java:<span class="number">306</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.MQClientAPIImpl.sendMessage(MQClientAPIImpl.java:<span class="number">289</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.sendKernelImpl(DefaultMQProducerImpl.java:<span class="number">679</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.sendSelectImpl(DefaultMQProducerImpl.java:<span class="number">867</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.send(DefaultMQProducerImpl.java:<span class="number">842</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.send(DefaultMQProducerImpl.java:<span class="number">836</span>)</div><div class="line">	at com.alibaba.rocketmq.client.producer.DefaultMQProducer.send(DefaultMQProducer.java:<span class="number">164</span>)</div><div class="line">	at com.comstar.demo.rocketmq.simple.Producer.main(Producer.java:<span class="number">61</span>)</div><div class="line">com.alibaba.rocketmq.remoting.exception.RemotingConnectException: connect to &lt;<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>&gt; failed</div><div class="line">	at com.alibaba.rocketmq.remoting.netty.NettyRemotingClient.invokeSync(NettyRemotingClient.java:<span class="number">641</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.MQClientAPIImpl.sendMessageSync(MQClientAPIImpl.java:<span class="number">306</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.MQClientAPIImpl.sendMessage(MQClientAPIImpl.java:<span class="number">289</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.sendKernelImpl(DefaultMQProducerImpl.java:<span class="number">679</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.sendSelectImpl(DefaultMQProducerImpl.java:<span class="number">867</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.send(DefaultMQProducerImpl.java:<span class="number">842</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.send(DefaultMQProducerImpl.java:<span class="number">836</span>)</div><div class="line">	at com.alibaba.rocketmq.client.producer.DefaultMQProducer.send(DefaultMQProducer.java:<span class="number">164</span>)</div><div class="line">	at com.comstar.demo.rocketmq.simple.Producer.main(Producer.java:<span class="number">61</span>)</div><div class="line">com.alibaba.rocketmq.remoting.exception.RemotingConnectException: connect to &lt;<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>&gt; failed</div><div class="line">	at com.alibaba.rocketmq.remoting.netty.NettyRemotingClient.invokeSync(NettyRemotingClient.java:<span class="number">641</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.MQClientAPIImpl.sendMessageSync(MQClientAPIImpl.java:<span class="number">306</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.MQClientAPIImpl.sendMessage(MQClientAPIImpl.java:<span class="number">289</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.sendKernelImpl(DefaultMQProducerImpl.java:<span class="number">679</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.sendSelectImpl(DefaultMQProducerImpl.java:<span class="number">867</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.send(DefaultMQProducerImpl.java:<span class="number">842</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.producer.DefaultMQProducerImpl.send(DefaultMQProducerImpl.java:<span class="number">836</span>)</div><div class="line">	at com.alibaba.rocketmq.client.producer.DefaultMQProducer.send(DefaultMQProducer.java:<span class="number">164</span>)</div><div class="line">	at com.comstar.demo.rocketmq.simple.Producer.main(Producer.java:<span class="number">61</span>)</div><div class="line"><span class="number">00596</span>SendResult [<span class="variable">sendStatus=</span>SEND_OK, <span class="variable">msgId=</span>C0A8E817000051AF00000000000791FF, <span class="variable">messageQueue=</span>MessageQueue [<span class="variable">topic=</span>TopicTest1, <span class="variable">brokerName=</span>broker-b, <span class="variable">queueId=</span><span class="number">0</span>], <span class="variable">queueOffset=</span><span class="number">702</span>]</div><div class="line"><span class="number">00597</span>SendResult [<span class="variable">sendStatus=</span>SEND_OK, <span class="variable">msgId=</span>C0A8E817000051AF0000000000079296, <span class="variable">messageQueue=</span>MessageQueue [<span class="variable">topic=</span>TopicTest1, <span class="variable">brokerName=</span>broker-b, <span class="variable">queueId=</span><span class="number">1</span>], <span class="variable">queueOffset=</span><span class="number">702</span>]</div><div class="line"><span class="number">00598</span>SendResult [<span class="variable">sendStatus=</span>SEND_OK, <span class="variable">msgId=</span>C0A8E817000051AF000000000007932D, <span class="variable">messageQueue=</span>MessageQueue [<span class="variable">topic=</span>TopicTest1, <span class="variable">brokerName=</span>broker-b, <span class="variable">queueId=</span><span class="number">2</span>], <span class="variable">queueOffset=</span><span class="number">701</span>]</div><div class="line"><span class="number">00599</span>SendResult [<span class="variable">sendStatus=</span>SEND_OK, <span class="variable">msgId=</span>C0A8E817000051AF00000000000793C4, <span class="variable">messageQueue=</span>MessageQueue [<span class="variable">topic=</span>TopicTest1, <span class="variable">brokerName=</span>broker-b, <span class="variable">queueId=</span><span class="number">3</span>], <span class="variable">queueOffset=</span><span class="number">701</span>]</div><div class="line"><span class="number">00600</span>SendResult [<span class="variable">sendStatus=</span>SEND_OK, <span class="variable">msgId=</span>C0A8E817000051AF000000000007945B, <span class="variable">messageQueue=</span>MessageQueue [<span class="variable">topic=</span>TopicTest1, <span class="variable">brokerName=</span>broker-b, <span class="variable">queueId=</span><span class="number">0</span>], <span class="variable">queueOffset=</span><span class="number">703</span>]</div><div class="line"><span class="number">00601</span>SendResult [<span class="variable">sendStatus=</span>SEND_OK, <span class="variable">msgId=</span>C0A8E817000051AF00000000000794F2, <span class="variable">messageQueue=</span>MessageQueue [<span class="variable">topic=</span>TopicTest1, <span class="variable">brokerName=</span>broker-b, <span class="variable">queueId=</span><span class="number">1</span>], <span class="variable">queueOffset=</span><span class="number">703</span>]</div><div class="line"><span class="number">00602</span>SendResult [<span class="variable">sendStatus=</span>SEND_OK, <span class="variable">msgId=</span>C0A8E817000051AF0000000000079589, <span class="variable">messageQueue=</span>MessageQueue [<span class="variable">topic=</span>TopicTest1, <span class="variable">brokerName=</span>broker-b, <span class="variable">queueId=</span><span class="number">2</span>], <span class="variable">queueOffset=</span><span class="number">702</span>]</div><div class="line"><span class="number">00603</span>SendResult [<span class="variable">sendStatus=</span>SEND_OK, <span class="variable">msgId=</span>C0A8E817000051AF0000000000079620, <span class="variable">messageQueue=</span>MessageQueue [<span class="variable">topic=</span>TopicTest1, <span class="variable">brokerName=</span>broker-b, <span class="variable">queueId=</span><span class="number">3</span>], <span class="variable">queueOffset=</span><span class="number">702</span>]</div><div class="line">......</div><div class="line"><span class="number">01389</span>SendResult [<span class="variable">sendStatus=</span>SEND_OK, <span class="variable">msgId=</span>C0A8E817000051AF00000000000965BE, <span class="variable">messageQueue=</span>MessageQueue [<span class="variable">topic=</span>TopicTest1, <span class="variable">brokerName=</span>broker-b, <span class="variable">queueId=</span><span class="number">1</span>], <span class="variable">queueOffset=</span><span class="number">900</span>]</div><div class="line"><span class="number">01390</span>SendResult [<span class="variable">sendStatus=</span>SEND_OK, <span class="variable">msgId=</span>C0A8E817000051AF0000000000096655, <span class="variable">messageQueue=</span>MessageQueue [<span class="variable">topic=</span>TopicTest1, <span class="variable">brokerName=</span>broker-b, <span class="variable">queueId=</span><span class="number">2</span>], <span class="variable">queueOffset=</span><span class="number">899</span>]</div><div class="line"><span class="number">01391</span>SendResult [<span class="variable">sendStatus=</span>SEND_OK, <span class="variable">msgId=</span>C0A8E817000051AF00000000000966EC, <span class="variable">messageQueue=</span>MessageQueue [<span class="variable">topic=</span>TopicTest1, <span class="variable">brokerName=</span>broker-b, <span class="variable">queueId=</span><span class="number">3</span>], <span class="variable">queueOffset=</span><span class="number">899</span>]</div><div class="line"><span class="number">01392</span>SendResult [<span class="variable">sendStatus=</span>SEND_OK, <span class="variable">msgId=</span>C0A8E81700002A9F0000000000127036, <span class="variable">messageQueue=</span>MessageQueue [<span class="variable">topic=</span>TopicTest1, <span class="variable">brokerName=</span>broker-a, <span class="variable">queueId=</span><span class="number">0</span>], <span class="variable">queueOffset=</span><span class="number">143</span>]</div><div class="line"><span class="number">01393</span>SendResult [<span class="variable">sendStatus=</span>SEND_OK, <span class="variable">msgId=</span>C0A8E81700002A9F00000000001270CD, <span class="variable">messageQueue=</span>MessageQueue [<span class="variable">topic=</span>TopicTest1, <span class="variable">brokerName=</span>broker-a, <span class="variable">queueId=</span><span class="number">1</span>], <span class="variable">queueOffset=</span><span class="number">141</span>]</div><div class="line"><span class="number">01394</span>SendResult [<span class="variable">sendStatus=</span>SEND_OK, <span class="variable">msgId=</span>C0A8E81700002A9F0000000000127164, <span class="variable">messageQueue=</span>MessageQueue [<span class="variable">topic=</span>TopicTest1, <span class="variable">brokerName=</span>broker-a, <span class="variable">queueId=</span><span class="number">2</span>], <span class="variable">queueOffset=</span><span class="number">142</span>]</div><div class="line"><span class="number">01395</span>SendResult [<span class="variable">sendStatus=</span>SEND_OK, <span class="variable">msgId=</span>C0A8E81700002A9F00000000001271FB, <span class="variable">messageQueue=</span>MessageQueue [<span class="variable">topic=</span>TopicTest1, <span class="variable">brokerName=</span>broker-a, <span class="variable">queueId=</span><span class="number">3</span>], <span class="variable">queueOffset=</span><span class="number">142</span>]</div><div class="line"><span class="number">01396</span>SendResult [<span class="variable">sendStatus=</span>SEND_OK, <span class="variable">msgId=</span>C0A8E817000051AF0000000000096783, <span class="variable">messageQueue=</span>MessageQueue [<span class="variable">topic=</span>TopicTest1, <span class="variable">brokerName=</span>broker-b, <span class="variable">queueId=</span><span class="number">0</span>], <span class="variable">queueOffset=</span><span class="number">901</span>]</div><div class="line"><span class="number">01397</span>SendResult [<span class="variable">sendStatus=</span>SEND_OK, <span class="variable">msgId=</span>C0A8E817000051AF000000000009681A, <span class="variable">messageQueue=</span>MessageQueue [<span class="variable">topic=</span>TopicTest1, <span class="variable">brokerName=</span>broker-b, <span class="variable">queueId=</span><span class="number">1</span>], <span class="variable">queueOffset=</span><span class="number">901</span>]</div></pre></td></tr></table></figure></p>
<p>日志中显示，在发送完00583条消息之后，开始发生异常 <code>connect to &lt;192.168.232.23:10911&gt; failed</code>，原因应该是 <code>broker-a</code> 的主节点被 kill 掉。之后，从00596条消息开始，RocketMQ 又恢复正常，原因是 <code>broker-b</code> 已经开始提供服务，承担了所有的工作。然后，又重新启动了 <code>broker-a</code> 主节点，由于该节点的加入，从01392条消息开始，<code>broker-a</code> 又开始恢复工作。实验中可以验证，RocketMQ 所谓的多主多备模式，实际上，备机被弱化到无以复加，在主节点宕机的时候，备机无法接替主机的工作，而只是将尚未发送的数据发送出去，由剩下的主节点接替工作。也就是说，N 主 N 备的 RocketMQ 集群中，总共有 2N 台机器，实际工作的只有 N 台，如果有一台挂了，就只有 N-1 台工作了，机器的利用率太低了。</p>
<p>再来看一下 Consumer 的日志，如下，</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div></pre></td><td class="code"><pre><div class="line">RocketMQ <span class="number">00551</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">696</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">696</span>, <span class="variable">msgFoundList=</span><span class="number">1</span>]MessageExt [<span class="variable">queueId=</span><span class="number">3</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">695</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469175032446</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">51987</span>, <span class="variable">storeTimestamp=</span><span class="number">1469175020973</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">20911</span>, <span class="variable">msgId=</span>C0A8E817000051AF000000000007859C, <span class="variable">commitLogOffset=</span><span class="number">492956</span>, <span class="variable">bodyCRC=</span><span class="number">943070764</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">696</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">RocketMQ <span class="number">00559</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">697</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">697</span>, <span class="variable">msgFoundList=</span><span class="number">1</span>]MessageExt [<span class="variable">queueId=</span><span class="number">3</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">696</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469175032720</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">51987</span>, <span class="variable">storeTimestamp=</span><span class="number">1469175021247</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">20911</span>, <span class="variable">msgId=</span>C0A8E817000051AF00000000000787F8, <span class="variable">commitLogOffset=</span><span class="number">493560</span>, <span class="variable">bodyCRC=</span><span class="number">921540126</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">697</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">RocketMQ <span class="number">00567</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">698</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">698</span>, <span class="variable">msgFoundList=</span><span class="number">1</span>]MessageExt [<span class="variable">queueId=</span><span class="number">3</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">697</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469175033005</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">51987</span>, <span class="variable">storeTimestamp=</span><span class="number">1469175021533</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">20911</span>, <span class="variable">msgId=</span>C0A8E817000051AF0000000000078A54, <span class="variable">commitLogOffset=</span><span class="number">494164</span>, <span class="variable">bodyCRC=</span><span class="number">2054744282</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">698</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">RocketMQ <span class="number">00575</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">699</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">699</span>, <span class="variable">msgFoundList=</span><span class="number">1</span>]MessageExt [<span class="variable">queueId=</span><span class="number">3</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">698</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469175033286</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">51987</span>, <span class="variable">storeTimestamp=</span><span class="number">1469175021814</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">20911</span>, <span class="variable">msgId=</span>C0A8E817000051AF0000000000078CB0, <span class="variable">commitLogOffset=</span><span class="number">494768</span>, <span class="variable">bodyCRC=</span><span class="number">225294519</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">699</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">RocketMQ <span class="number">00583</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">700</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">700</span>, <span class="variable">msgFoundList=</span><span class="number">1</span>]MessageExt [<span class="variable">queueId=</span><span class="number">3</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">699</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469175033586</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">51987</span>, <span class="variable">storeTimestamp=</span><span class="number">1469175022113</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">20911</span>, <span class="variable">msgId=</span>C0A8E817000051AF0000000000078F0C, <span class="variable">commitLogOffset=</span><span class="number">495372</span>, <span class="variable">bodyCRC=</span><span class="number">1670775117</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">700</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">RocketMQ <span class="number">00591</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">701</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">701</span>, <span class="variable">msgFoundList=</span><span class="number">1</span>]MessageExt [<span class="variable">queueId=</span><span class="number">3</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">700</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469175037890</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">51987</span>, <span class="variable">storeTimestamp=</span><span class="number">1469175026418</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">20911</span>, <span class="variable">msgId=</span>C0A8E817000051AF0000000000079168, <span class="variable">commitLogOffset=</span><span class="number">495976</span>, <span class="variable">bodyCRC=</span><span class="number">344150304</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">701</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">RocketMQ <span class="number">00599</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">702</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">702</span>, <span class="variable">msgFoundList=</span><span class="number">1</span>]MessageExt [<span class="variable">queueId=</span><span class="number">3</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">701</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469175042200</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">51987</span>, <span class="variable">storeTimestamp=</span><span class="number">1469175030734</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">20911</span>, <span class="variable">msgId=</span>C0A8E817000051AF00000000000793C4, <span class="variable">commitLogOffset=</span><span class="number">496580</span>, <span class="variable">bodyCRC=</span><span class="number">442030354</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">702</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">RocketMQ <span class="number">00603</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">703</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">703</span>, <span class="variable">msgFoundList=</span><span class="number">1</span>]MessageExt [<span class="variable">queueId=</span><span class="number">3</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">702</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469175042345</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">51987</span>, <span class="variable">storeTimestamp=</span><span class="number">1469175030872</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">20911</span>, <span class="variable">msgId=</span>C0A8E817000051AF0000000000079620, <span class="variable">commitLogOffset=</span><span class="number">497184</span>, <span class="variable">bodyCRC=</span><span class="number">688469276</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">703</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">RocketMQ <span class="number">00607</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">704</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">704</span>, <span class="variable">msgFoundList=</span><span class="number">1</span>]MessageExt [<span class="variable">queueId=</span><span class="number">3</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">703</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469175042481</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">51987</span>, <span class="variable">storeTimestamp=</span><span class="number">1469175031008</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">20911</span>, <span class="variable">msgId=</span>C0A8E817000051AF000000000007987C, <span class="variable">commitLogOffset=</span><span class="number">497788</span>, <span class="variable">bodyCRC=</span><span class="number">778367237</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">704</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">RocketMQ <span class="number">00611</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">705</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">705</span>, <span class="variable">msgFoundList=</span><span class="number">1</span>]MessageExt [<span class="variable">queueId=</span><span class="number">3</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">704</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469175042615</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">51987</span>, <span class="variable">storeTimestamp=</span><span class="number">1469175031143</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">20911</span>, <span class="variable">msgId=</span>C0A8E817000051AF0000000000079AD8, <span class="variable">commitLogOffset=</span><span class="number">498392</span>, <span class="variable">bodyCRC=</span><span class="number">1578919281</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">705</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">RocketMQ <span class="number">00615</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">706</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">706</span>, <span class="variable">msgFoundList=</span><span class="number">1</span>]MessageExt [<span class="variable">queueId=</span><span class="number">3</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">705</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469175042753</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">51987</span>, <span class="variable">storeTimestamp=</span><span class="number">1469175031280</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">20911</span>, <span class="variable">msgId=</span>C0A8E817000051AF0000000000079D34, <span class="variable">commitLogOffset=</span><span class="number">498996</span>, <span class="variable">bodyCRC=</span><span class="number">1500619112</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">706</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">RocketMQ <span class="number">00619</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">707</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">707</span>, <span class="variable">msgFoundList=</span><span class="number">1</span>]MessageExt [<span class="variable">queueId=</span><span class="number">3</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">706</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469175042887</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">51987</span>, <span class="variable">storeTimestamp=</span><span class="number">1469175031414</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">20911</span>, <span class="variable">msgId=</span>C0A8E817000051AF0000000000079F90, <span class="variable">commitLogOffset=</span><span class="number">499600</span>, <span class="variable">bodyCRC=</span><span class="number">1355279683</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">707</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">RocketMQ <span class="number">00623</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">708</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">708</span>, <span class="variable">msgFoundList=</span><span class="number">1</span>]MessageExt [<span class="variable">queueId=</span><span class="number">3</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">707</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469175043021</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">51987</span>, <span class="variable">storeTimestamp=</span><span class="number">1469175031548</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">20911</span>, <span class="variable">msgId=</span>C0A8E817000051AF000000000007A1EC, <span class="variable">commitLogOffset=</span><span class="number">500204</span>, <span class="variable">bodyCRC=</span><span class="number">457136030</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">708</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">RocketMQ <span class="number">00627</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">709</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">709</span>, <span class="variable">msgFoundList=</span><span class="number">1</span>]MessageExt [<span class="variable">queueId=</span><span class="number">3</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">708</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469175043154</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">51987</span>, <span class="variable">storeTimestamp=</span><span class="number">1469175031681</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">20911</span>, <span class="variable">msgId=</span>C0A8E817000051AF000000000007A448, <span class="variable">commitLogOffset=</span><span class="number">500808</span>, <span class="variable">bodyCRC=</span><span class="number">475173767</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">709</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">RocketMQ <span class="number">00631</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">710</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">710</span>, <span class="variable">msgFoundList=</span><span class="number">1</span>]MessageExt [<span class="variable">queueId=</span><span class="number">3</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">709</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469175043299</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">51987</span>, <span class="variable">storeTimestamp=</span><span class="number">1469175031826</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">20911</span>, <span class="variable">msgId=</span>C0A8E817000051AF000000000007A6A4, <span class="variable">commitLogOffset=</span><span class="number">501412</span>, <span class="variable">bodyCRC=</span><span class="number">1814693875</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">710</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">RocketMQ <span class="number">00635</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">711</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">711</span>, <span class="variable">msgFoundList=</span><span class="number">1</span>]MessageExt [<span class="variable">queueId=</span><span class="number">3</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">710</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469175043435</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">51987</span>, <span class="variable">storeTimestamp=</span><span class="number">1469175031962</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">20911</span>, <span class="variable">msgId=</span>C0A8E817000051AF000000000007A900, <span class="variable">commitLogOffset=</span><span class="number">502016</span>, <span class="variable">bodyCRC=</span><span class="number">1799865322</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">711</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">com.alibaba.rocketmq.remoting.exception.RemotingConnectException: connect to &lt;<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>&gt; failed</div><div class="line">	at com.alibaba.rocketmq.remoting.netty.NettyRemotingClient.invokeSync(NettyRemotingClient.java:<span class="number">641</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.MQClientAPIImpl.pullMessageSync(MQClientAPIImpl.java:<span class="number">518</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.MQClientAPIImpl.pullMessage(MQClientAPIImpl.java:<span class="number">433</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.consumer.PullAPIWrapper.pullKernelImpl(PullAPIWrapper.java:<span class="number">237</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.consumer.DefaultMQPullConsumerImpl.pullSyncImpl(DefaultMQPullConsumerImpl.java:<span class="number">304</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.consumer.DefaultMQPullConsumerImpl.pullBlockIfNotFound(DefaultMQPullConsumerImpl.java:<span class="number">425</span>)</div><div class="line">	at com.alibaba.rocketmq.client.consumer.DefaultMQPullConsumer.pullBlockIfNotFound(DefaultMQPullConsumer.java:<span class="number">321</span>)</div><div class="line">	at com.comstar.demo.rocketmq.simple.PullConsumer.main(PullConsumer.java:<span class="number">56</span>)</div><div class="line">com.alibaba.rocketmq.remoting.exception.RemotingConnectException: connect to &lt;<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>&gt; failed</div><div class="line">	at com.alibaba.rocketmq.remoting.netty.NettyRemotingClient.invokeSync(NettyRemotingClient.java:<span class="number">641</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.MQClientAPIImpl.pullMessageSync(MQClientAPIImpl.java:<span class="number">518</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.MQClientAPIImpl.pullMessage(MQClientAPIImpl.java:<span class="number">433</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.consumer.PullAPIWrapper.pullKernelImpl(PullAPIWrapper.java:<span class="number">237</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.consumer.DefaultMQPullConsumerImpl.pullSyncImpl(DefaultMQPullConsumerImpl.java:<span class="number">304</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.consumer.DefaultMQPullConsumerImpl.pullBlockIfNotFound(DefaultMQPullConsumerImpl.java:<span class="number">425</span>)</div><div class="line">	at com.alibaba.rocketmq.client.consumer.DefaultMQPullConsumer.pullBlockIfNotFound(DefaultMQPullConsumer.java:<span class="number">321</span>)</div><div class="line">	at com.comstar.demo.rocketmq.simple.PullConsumer.main(PullConsumer.java:<span class="number">56</span>)</div><div class="line">com.alibaba.rocketmq.remoting.exception.RemotingConnectException: connect to &lt;<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>&gt; failed</div><div class="line">	at com.alibaba.rocketmq.remoting.netty.NettyRemotingClient.invokeSync(NettyRemotingClient.java:<span class="number">641</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.MQClientAPIImpl.pullMessageSync(MQClientAPIImpl.java:<span class="number">518</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.MQClientAPIImpl.pullMessage(MQClientAPIImpl.java:<span class="number">433</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.consumer.PullAPIWrapper.pullKernelImpl(PullAPIWrapper.java:<span class="number">237</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.consumer.DefaultMQPullConsumerImpl.pullSyncImpl(DefaultMQPullConsumerImpl.java:<span class="number">304</span>)</div><div class="line">	at com.alibaba.rocketmq.client.impl.consumer.DefaultMQPullConsumerImpl.pullBlockIfNotFound(DefaultMQPullConsumerImpl.java:<span class="number">425</span>)</div><div class="line">	at com.alibaba.rocketmq.client.consumer.DefaultMQPullConsumer.pullBlockIfNotFound(DefaultMQPullConsumer.java:<span class="number">321</span>)</div><div class="line">	at com.comstar.demo.rocketmq.simple.PullConsumer.main(PullConsumer.java:<span class="number">56</span>)</div><div class="line">Hello MetaQPullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">31</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">205</span>, <span class="variable">msgFoundList=</span><span class="number">31</span>]MessageExt [<span class="variable">queueId=</span><span class="number">1</span>, <span class="variable">storeSize=</span><span class="number">148</span>, <span class="variable">queueOffset=</span><span class="number">0</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1468572196808</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">56837</span>, <span class="variable">storeTimestamp=</span><span class="number">1468572191827</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>, <span class="variable">msgId=</span>C0A8E81700002A9F0000000000011C60, <span class="variable">commitLogOffset=</span><span class="number">72800</span>, <span class="variable">bodyCRC=</span><span class="number">1751783629</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">205</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagA}, <span class="variable">body=</span><span class="number">11</span>]]</div><div class="line">Hello MetaQPullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">31</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">205</span>, <span class="variable">msgFoundList=</span><span class="number">31</span>]MessageExt [<span class="variable">queueId=</span><span class="number">1</span>, <span class="variable">storeSize=</span><span class="number">148</span>, <span class="variable">queueOffset=</span><span class="number">1</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1468572196876</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">56837</span>, <span class="variable">storeTimestamp=</span><span class="number">1468572191895</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>, <span class="variable">msgId=</span>C0A8E81700002A9F0000000000011EB0, <span class="variable">commitLogOffset=</span><span class="number">73392</span>, <span class="variable">bodyCRC=</span><span class="number">1751783629</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">205</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagA}, <span class="variable">body=</span><span class="number">11</span>]]</div><div class="line">Hello MetaQPullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">31</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">205</span>, <span class="variable">msgFoundList=</span><span class="number">31</span>]MessageExt [<span class="variable">queueId=</span><span class="number">1</span>, <span class="variable">storeSize=</span><span class="number">148</span>, <span class="variable">queueOffset=</span><span class="number">2</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1468572196903</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">56837</span>, <span class="variable">storeTimestamp=</span><span class="number">1468572191928</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>, <span class="variable">msgId=</span>C0A8E81700002A9F0000000000012100, <span class="variable">commitLogOffset=</span><span class="number">73984</span>, <span class="variable">bodyCRC=</span><span class="number">1751783629</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">205</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagA}, <span class="variable">body=</span><span class="number">11</span>]]</div><div class="line">RocketMQ <span class="number">00001</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">31</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">205</span>, <span class="variable">msgFoundList=</span><span class="number">31</span>]MessageExt [<span class="variable">queueId=</span><span class="number">1</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">3</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1468572718149</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">57165</span>, <span class="variable">storeTimestamp=</span><span class="number">1468572713175</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>, <span class="variable">msgId=</span>C0A8E81700002A9F000000000001222B, <span class="variable">commitLogOffset=</span><span class="number">74283</span>, <span class="variable">bodyCRC=</span><span class="number">1133127810</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">205</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagA}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">RocketMQ <span class="number">00005</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">31</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">205</span>, <span class="variable">msgFoundList=</span><span class="number">31</span>]MessageExt [<span class="variable">queueId=</span><span class="number">1</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">4</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1468572718178</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">57165</span>, <span class="variable">storeTimestamp=</span><span class="number">1468572713210</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>, <span class="variable">msgId=</span>C0A8E81700002A9F0000000000012487, <span class="variable">commitLogOffset=</span><span class="number">74887</span>, <span class="variable">bodyCRC=</span><span class="number">1156050075</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">205</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagA}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">......</div><div class="line">[<span class="variable">queueId=</span><span class="number">1</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">22</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469170324786</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">49814</span>, <span class="variable">storeTimestamp=</span><span class="number">1469170313333</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>, <span class="variable">msgId=</span>C0A8E81700002A9F000000000010D3AA, <span class="variable">commitLogOffset=</span><span class="number">1102762</span>, <span class="variable">bodyCRC=</span><span class="number">1707898805</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">205</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">RocketMQ <span class="number">00477</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">62</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">205</span>, <span class="variable">msgFoundList=</span><span class="number">31</span>]MessageExt [<span class="variable">queueId=</span><span class="number">1</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">23</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469170325237</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">49814</span>, <span class="variable">storeTimestamp=</span><span class="number">1469170313771</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>, <span class="variable">msgId=</span>C0A8E81700002A9F000000000010D606, <span class="variable">commitLogOffset=</span><span class="number">1103366</span>, <span class="variable">bodyCRC=</span><span class="number">1654764460</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">205</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">RocketMQ <span class="number">00481</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">62</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">205</span>, <span class="variable">msgFoundList=</span><span class="number">31</span>]MessageExt [<span class="variable">queueId=</span><span class="number">1</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">24</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469170325652</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">49814</span>, <span class="variable">storeTimestamp=</span><span class="number">1469170314163</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>, <span class="variable">msgId=</span>C0A8E81700002A9F000000000010D862, <span class="variable">commitLogOffset=</span><span class="number">1103970</span>, <span class="variable">bodyCRC=</span><span class="number">207227478</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">205</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">RocketMQ <span class="number">00485</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">62</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">205</span>, <span class="variable">msgFoundList=</span><span class="number">31</span>]MessageExt [<span class="variable">queueId=</span><span class="number">1</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">25</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469170326066</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">49814</span>, <span class="variable">storeTimestamp=</span><span class="number">1469170314595</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>, <span class="variable">msgId=</span>C0A8E81700002A9F000000000010DABE, <span class="variable">commitLogOffset=</span><span class="number">1104574</span>, <span class="variable">bodyCRC=</span><span class="number">188206671</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">205</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">......</div><div class="line">RocketMQ <span class="number">01370</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">895</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">895</span>, <span class="variable">msgFoundList=</span><span class="number">1</span>]MessageExt [<span class="variable">queueId=</span><span class="number">2</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">894</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469175070573</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">51987</span>, <span class="variable">storeTimestamp=</span><span class="number">1469175059101</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">20911</span>, <span class="variable">msgId=</span>C0A8E817000051AF0000000000095A89, <span class="variable">commitLogOffset=</span><span class="number">613001</span>, <span class="variable">bodyCRC=</span><span class="number">1094080495</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">895</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">RocketMQ <span class="number">01374</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">896</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">896</span>, <span class="variable">msgFoundList=</span><span class="number">1</span>]MessageExt [<span class="variable">queueId=</span><span class="number">2</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">895</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469175070712</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">51987</span>, <span class="variable">storeTimestamp=</span><span class="number">1469175059251</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">20911</span>, <span class="variable">msgId=</span>C0A8E817000051AF0000000000095CE5, <span class="variable">commitLogOffset=</span><span class="number">613605</span>, <span class="variable">bodyCRC=</span><span class="number">1180406774</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">896</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">RocketMQ <span class="number">01378</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">897</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">897</span>, <span class="variable">msgFoundList=</span><span class="number">1</span>]MessageExt [<span class="variable">queueId=</span><span class="number">2</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">896</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469175070899</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">51987</span>, <span class="variable">storeTimestamp=</span><span class="number">1469175059427</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">20911</span>, <span class="variable">msgId=</span>C0A8E817000051AF0000000000095F41, <span class="variable">commitLogOffset=</span><span class="number">614209</span>, <span class="variable">bodyCRC=</span><span class="number">1340989405</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">897</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">RocketMQ <span class="number">01382</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">898</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">898</span>, <span class="variable">msgFoundList=</span><span class="number">1</span>]MessageExt [<span class="variable">queueId=</span><span class="number">2</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">897</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469175071054</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">51987</span>, <span class="variable">storeTimestamp=</span><span class="number">1469175059582</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">20911</span>, <span class="variable">msgId=</span>C0A8E817000051AF000000000009619D, <span class="variable">commitLogOffset=</span><span class="number">614813</span>, <span class="variable">bodyCRC=</span><span class="number">681585164</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">898</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">RocketMQ <span class="number">01386</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">899</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">899</span>, <span class="variable">msgFoundList=</span><span class="number">1</span>]MessageExt [<span class="variable">queueId=</span><span class="number">2</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">898</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469175071203</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">51987</span>, <span class="variable">storeTimestamp=</span><span class="number">1469175059731</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">20911</span>, <span class="variable">msgId=</span>C0A8E817000051AF00000000000963F9, <span class="variable">commitLogOffset=</span><span class="number">615417</span>, <span class="variable">bodyCRC=</span><span class="number">802024981</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">899</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">RocketMQ <span class="number">01390</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">900</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">900</span>, <span class="variable">msgFoundList=</span><span class="number">1</span>]MessageExt [<span class="variable">queueId=</span><span class="number">2</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">899</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469175071338</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">51987</span>, <span class="variable">storeTimestamp=</span><span class="number">1469175059866</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">20911</span>, <span class="variable">msgId=</span>C0A8E817000051AF0000000000096655, <span class="variable">commitLogOffset=</span><span class="number">616021</span>, <span class="variable">bodyCRC=</span><span class="number">1605728865</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">900</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">Hello MetaQPullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">31</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">209</span>, <span class="variable">msgFoundList=</span><span class="number">31</span>]MessageExt [<span class="variable">queueId=</span><span class="number">0</span>, <span class="variable">storeSize=</span><span class="number">148</span>, <span class="variable">queueOffset=</span><span class="number">0</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1468571752640</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">56433</span>, <span class="variable">storeTimestamp=</span><span class="number">1468571747895</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>, <span class="variable">msgId=</span>C0A8E81700002A9F0000000000011B38, <span class="variable">commitLogOffset=</span><span class="number">72504</span>, <span class="variable">bodyCRC=</span><span class="number">1751783629</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">209</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagA}, <span class="variable">body=</span><span class="number">11</span>]]</div><div class="line">Hello MetaQPullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">31</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">209</span>, <span class="variable">msgFoundList=</span><span class="number">31</span>]MessageExt [<span class="variable">queueId=</span><span class="number">0</span>, <span class="variable">storeSize=</span><span class="number">148</span>, <span class="variable">queueOffset=</span><span class="number">1</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1468572196772</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">56837</span>, <span class="variable">storeTimestamp=</span><span class="number">1468572191803</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>, <span class="variable">msgId=</span>C0A8E81700002A9F0000000000011BCC, <span class="variable">commitLogOffset=</span><span class="number">72652</span>, <span class="variable">bodyCRC=</span><span class="number">1751783629</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">209</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagA}, <span class="variable">body=</span><span class="number">11</span>]]</div><div class="line">Hello MetaQPullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">31</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">209</span>, <span class="variable">msgFoundList=</span><span class="number">31</span>]MessageExt [<span class="variable">queueId=</span><span class="number">0</span>, <span class="variable">storeSize=</span><span class="number">148</span>, <span class="variable">queueOffset=</span><span class="number">2</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1468572196865</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">56837</span>, <span class="variable">storeTimestamp=</span><span class="number">1468572191886</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>, <span class="variable">msgId=</span>C0A8E81700002A9F0000000000011E1C, <span class="variable">commitLogOffset=</span><span class="number">73244</span>, <span class="variable">bodyCRC=</span><span class="number">1751783629</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">209</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagA}, <span class="variable">body=</span><span class="number">11</span>]]</div><div class="line">Hello MetaQPullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">31</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">209</span>, <span class="variable">msgFoundList=</span><span class="number">31</span>]MessageExt [<span class="variable">queueId=</span><span class="number">0</span>, <span class="variable">storeSize=</span><span class="number">148</span>, <span class="variable">queueOffset=</span><span class="number">3</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1468572196899</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">56837</span>, <span class="variable">storeTimestamp=</span><span class="number">1468572191917</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>, <span class="variable">msgId=</span>C0A8E81700002A9F000000000001206C, <span class="variable">commitLogOffset=</span><span class="number">73836</span>, <span class="variable">bodyCRC=</span><span class="number">1751783629</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">209</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagA}, <span class="variable">body=</span><span class="number">11</span>]]</div><div class="line">RocketMQ <span class="number">00000</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">31</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">209</span>, <span class="variable">msgFoundList=</span><span class="number">31</span>]MessageExt [<span class="variable">queueId=</span><span class="number">0</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">4</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1468572718127</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">57165</span>, <span class="variable">storeTimestamp=</span><span class="number">1468572713166</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>, <span class="variable">msgId=</span>C0A8E81700002A9F0000000000012194, <span class="variable">commitLogOffset=</span><span class="number">74132</span>, <span class="variable">bodyCRC=</span><span class="number">881661972</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">209</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagA}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">RocketMQ <span class="number">00004</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">31</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">209</span>, <span class="variable">msgFoundList=</span><span class="number">31</span>]MessageExt [<span class="variable">queueId=</span><span class="number">0</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">5</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1468572718170</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">57165</span>, <span class="variable">storeTimestamp=</span><span class="number">1468572713197</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>, <span class="variable">msgId=</span>C0A8E81700002A9F00000000000123F0, <span class="variable">commitLogOffset=</span><span class="number">74736</span>, <span class="variable">bodyCRC=</span><span class="number">870374413</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">209</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagA}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">......</div><div class="line">RocketMQ <span class="number">00560</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">210</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">210</span>, <span class="variable">msgFoundList=</span><span class="number">24</span>]MessageExt [<span class="variable">queueId=</span><span class="number">0</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">140</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469175032756</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">51986</span>, <span class="variable">storeTimestamp=</span><span class="number">1469175021285</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>, <span class="variable">msgId=</span>C0A8E81700002A9F0000000000126922, <span class="variable">commitLogOffset=</span><span class="number">1206562</span>, <span class="variable">bodyCRC=</span><span class="number">1679588729</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">210</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">RocketMQ <span class="number">00568</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">210</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">210</span>, <span class="variable">msgFoundList=</span><span class="number">24</span>]MessageExt [<span class="variable">queueId=</span><span class="number">0</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">141</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469175033043</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">51986</span>, <span class="variable">storeTimestamp=</span><span class="number">1469175021570</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>, <span class="variable">msgId=</span>C0A8E81700002A9F0000000000126B7E, <span class="variable">commitLogOffset=</span><span class="number">1207166</span>, <span class="variable">bodyCRC=</span><span class="number">1791489355</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">210</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">RocketMQ <span class="number">00576</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">210</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">210</span>, <span class="variable">msgFoundList=</span><span class="number">24</span>]MessageExt [<span class="variable">queueId=</span><span class="number">0</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">142</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469175033320</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">51986</span>, <span class="variable">storeTimestamp=</span><span class="number">1469175021848</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>, <span class="variable">msgId=</span>C0A8E81700002A9F0000000000126DDA, <span class="variable">commitLogOffset=</span><span class="number">1207770</span>, <span class="variable">bodyCRC=</span><span class="number">342157581</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">210</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">RocketMQ <span class="number">01392</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">210</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">210</span>, <span class="variable">msgFoundList=</span><span class="number">24</span>]MessageExt [<span class="variable">queueId=</span><span class="number">0</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">143</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469175071411</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">52034</span>, <span class="variable">storeTimestamp=</span><span class="number">1469175059951</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>, <span class="variable">msgId=</span>C0A8E81700002A9F0000000000127036, <span class="variable">commitLogOffset=</span><span class="number">1208374</span>, <span class="variable">bodyCRC=</span><span class="number">834345805</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">210</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">RocketMQ <span class="number">01400</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">210</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">210</span>, <span class="variable">msgFoundList=</span><span class="number">24</span>]MessageExt [<span class="variable">queueId=</span><span class="number">0</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">144</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469175071746</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">52034</span>, <span class="variable">storeTimestamp=</span><span class="number">1469175060289</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>, <span class="variable">msgId=</span>C0A8E81700002A9F0000000000127292, <span class="variable">commitLogOffset=</span><span class="number">1208978</span>, <span class="variable">bodyCRC=</span><span class="number">188274605</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">210</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">RocketMQ <span class="number">01408</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">211</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">211</span>, <span class="variable">msgFoundList=</span><span class="number">1</span>]MessageExt [<span class="variable">queueId=</span><span class="number">0</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">145</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469175072078</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">52034</span>, <span class="variable">storeTimestamp=</span><span class="number">1469175060614</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>, <span class="variable">msgId=</span>C0A8E81700002A9F00000000001274EE, <span class="variable">commitLogOffset=</span><span class="number">1209582</span>, <span class="variable">bodyCRC=</span><span class="number">98787231</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">211</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div><div class="line">RocketMQ <span class="number">01416</span>PullResult [<span class="variable">pullStatus=</span>FOUND, <span class="variable">nextBeginOffset=</span><span class="number">214</span>, <span class="variable">minOffset=</span><span class="number">0</span>, <span class="variable">maxOffset=</span><span class="number">214</span>, <span class="variable">msgFoundList=</span><span class="number">3</span>]MessageExt [<span class="variable">queueId=</span><span class="number">0</span>, <span class="variable">storeSize=</span><span class="number">151</span>, <span class="variable">queueOffset=</span><span class="number">146</span>, <span class="variable">sysFlag=</span><span class="number">0</span>, <span class="variable">bornTimestamp=</span><span class="number">1469175072405</span>, <span class="variable">bornHost=</span>/<span class="number">192.168</span>.<span class="number">234.98</span>:<span class="number">52034</span>, <span class="variable">storeTimestamp=</span><span class="number">1469175060934</span>, <span class="variable">storeHost=</span>/<span class="number">192.168</span>.<span class="number">232.23</span>:<span class="number">10911</span>, <span class="variable">msgId=</span>C0A8E81700002A9F000000000012774A, <span class="variable">commitLogOffset=</span><span class="number">1210186</span>, <span class="variable">bodyCRC=</span><span class="number">2067809241</span>, <span class="variable">reconsumeTimes=</span><span class="number">0</span>, <span class="variable">preparedTransactionOffset=</span><span class="number">0</span>, <span class="built_in">toString</span>()=Message [<span class="variable">topic=</span>TopicTest1, <span class="variable">flag=</span><span class="number">0</span>, <span class="variable">properties=</span>{<span class="variable">MIN_OFFSET=</span><span class="number">0</span>, <span class="variable">MAX_OFFSET=</span><span class="number">214</span>, <span class="variable">KEYS=</span>OrderID188, <span class="variable">WAIT=</span><span class="constant">true</span>, <span class="variable">TAGS=</span>TagB}, <span class="variable">body=</span><span class="number">14</span>]]</div></pre></td></tr></table></figure></p>
<p>可以看到，Consumer 在 <code>broker-a</code> 宕机时间的附近，也出现了异常，<code>connect to &lt;192.168.232.23:10911&gt; failed</code>。虽然还能保持分区上的顺序性，但是已经某种程度上出现了一些紊乱，例如，将我在实验之前的数据给取了出来（<code>Hello MetaQ</code>的消息）。可是，我在实验前，明明做过删除这个 Topic 的动作，看来 RocketMQ 所谓的删除，并未删除 Topic 的数据。之后，<code>broker-a</code> 主机重启之后，又恢复正常。</p>
<p>RocketMQ Pull模式消费需要手动管理 offset 和指定分区，这个在调用的时候不觉得，实际运行的时候才会发现每次总是消费一个分区，消费完之后，才开始消费下一个分区，而下一个分区可能已经堆积了很多消息了，手动做消息分配又比较费事。或许，Push 顺序模式消费才是更好的选择。</p>
<p>另外还有几个比较异常的情况，实验中有几次出现了 <code>CODE: 17  DESC: topic[TopicTest1] not exist, apply first please!</code> 这样的错误，实际上，这时候我只是关掉了 Producer；还有，<code>sh mqadmin updateTopic –n 192.168.232.23:9876 –c DefaultCluster –t TopicTest1</code> 明明文档中说可以用来新增 Topic，而实际上不行。</p>
<blockquote>
<p>补充一下：之后，我又使用 Push 顺序模式消费重做了上述实验，结论差不多。只是因为有多线程的原因，日志看起来偶尔有错位，这个问题不大，可以解决。而且，在关闭重启 Broker 的附近，往往伴随着多次的消息重发，不过，RocketMQ 也不保证消息只收到一次就是了。消息重复的问题，Kafka 要比 RocketMQ 显得不那么严重一些。Push 顺序模式消费不需要指定 offset，不需要指定分区，第二次启动可以自动从前一次的 offset 后开始消费。功能上这个与 Kafka 的 Consumer 更类似，虽然 RocketMQ 采用的是异步模式。</p>
</blockquote>
<h2>RocketMQ 最佳实践</h2>
<p>实际上，RocketMQ 自己就有一份《RocketMQ 最佳实践》的文档，里面提到了一些系统设计的问题，例如消费者要幂等，一个应用对应一个 Topic，如此等等。这些经验不仅仅是对 RocketMQ 有用，对 Kafka 也颇有借鉴意义。</p>
<h2>后记</h2>
<p>这里谈谈我对选择 RocketMQ 还是 Kafka 的个人建议。以上已经做了多处 RocketMQ 和 Kafka 的对比，我个人觉得，Kafka 是一个不断发展中的系统，开源社区比 RocketMQ 要大，也要更活跃一些；另外，Kafka 最新版本已经有了同步复制，消息可靠性更有保障；还有，Kafka 的分区机制，几乎实现了自动负载均衡，这绝对是个杀手级特性；RocketMQ 虽然提供了很多易用的功能，远超出 Kafka，但这些功能并不一定都能用得上，而且多数可以绕过。相比之下，Kafka 的基本功能更加吸引我，再处理故障恢复的时候，细节上要胜过 RocketMQ。当然，如果是 A 公司内部，或者所在公司使用了 A 公司的云产品，那么 RocketMQ 的企业级特性更多一些，或许我会选择 RocketMQ。</p>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p><a href="https://github.com/alibaba/RocketMQ" target="_blank" rel="external">https://github.com/alibaba/RocketMQ</a><a href="#fnref1">↩</a></p></li>
<li id="fn2"><p><a href="https://github.com/alibaba/RocketMQ-docs" target="_blank" rel="external">https://github.com/alibaba/RocketMQ-docs</a><a href="#fnref2">↩</a></p></li>
<li id="fn3"><p><a href="http://www.aliyun.com/product/ons" target="_blank" rel="external">http://www.aliyun.com/product/ons</a><a href="#fnref3">↩</a></p></li>
<li id="fn4"><p><a href="https://github.com/alibaba/RocketMQ/wiki/rmq_vs_kafka" target="_blank" rel="external">https://github.com/alibaba/RocketMQ/wiki/rmq_vs_kafka</a><a href="#fnref4">↩</a></p></li>
<li id="fn5"><p><a href="http://www.jianshu.com/p/453c6e7ff81c" target="_blank" rel="external">http://www.jianshu.com/p/453c6e7ff81c</a><a href="#fnref5">↩</a></p></li>
<li id="fn6"><p><a href="http://blog.csdn.net/lovesomnus/article/details/51776942" target="_blank" rel="external">http://blog.csdn.net/lovesomnus/article/details/51776942</a><a href="#fnref6">↩</a></p></li>
<li id="fn7"><p><a href="http://www.tuicool.com/articles/f2aaUnV" target="_blank" rel="external">http://www.tuicool.com/articles/f2aaUnV</a><a href="#fnref7">↩</a></p></li>
<li id="fn8"><p><a href="https://github.com/alibaba/RocketMQ/wiki/filter_server_guide" target="_blank" rel="external">https://github.com/alibaba/RocketMQ/wiki/filter_server_guide</a><a href="#fnref8">↩</a></p></li>
</ol>
</div>
  
	</div>
		<footer class="article-footer clearfix">

  <div class="article-tags">
  
  <span></span> <a href="/tags/RocketMQ/">RocketMQ</a><a href="/tags/MQ/">MQ</a><a href="/tags/Java/">Java</a>
  </div>


<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/RocketMQ/">RocketMQ</a>
</div>



<div class="article-share" id="share">

  <div data-url="http://valleylord.github.io/post/201607-mq-rocketmq/" data-title="说说 MQ 之 RocketMQ | 褚哥说|" data-tsina="null" class="share clearfix">
  </div>

</div>
</footer>   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/post/201607-ref-all/" title="转载文章合集">
  <strong>PREVIOUS:</strong><br/>
  <span>
  转载文章合集</span>
</a>
</div>


<div class="next">
<a href="/post/201607-mq-kafka/"  title="说说 MQ 之 Kafka">
 <strong>NEXT:</strong><br/> 
 <span>说说 MQ 之 Kafka
</span>
</a>
</div>

</nav>

	
</div>  
      
  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
  <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.</span> <span class="toc-text">基本概念</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.1.</span> <span class="toc-text">关于顺序和分区</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.2.</span> <span class="toc-text">关于高可用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">2.</span> <span class="toc-text">RocketMQ 的工具和编程接口</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">2.1.</span> <span class="toc-text">RocketMQ 的工具</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">2.2.</span> <span class="toc-text">RocketMQ 的 Java API</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">3.</span> <span class="toc-text">RocketMQ 的主备模式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">4.</span> <span class="toc-text">RocketMQ 最佳实践</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.</span> <span class="toc-text">后记</span></a></li></ol>
  </div>

<div id="asidepart">
<div id="authorInfo">
	
		<div class="author-logo"></div>		
	
	
	<section class="author-info">
		
			<p> 欢迎来到Valleylord的博客！</p>
		
		
			<p>	本博的文章尽量原创。</p>
		
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/http://weibo.com/valleylord" target="_blank" title="weibo"></a>
		
		
		
		<a href="https://github.com/https://github.com/valleylord" target="_blank" title="github"></a>
		
		
	</div>
</div>
<aside class="clearfix">


  
  <div class="archiveslist">
    <p class="asidetitle"><a href="/archives">归档</a></p>
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">December 2014</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">November 2014</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/10/">October 2014</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09/">September 2014</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/08/">August 2014</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/05/">May 2014</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/04/">April 2014</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/02/">February 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2000/01/">January 2000</a><span class="archive-list-count">1</span></li></ul>
  </div>


  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
			<li><a href="/categories/Blog/" title="Blog">Blog<sup>1</sup></a></li>
		
			<li><a href="/categories/Bug/" title="Bug">Bug<sup>1</sup></a></li>
		
			<li><a href="/categories/C/" title="C++">C++<sup>3</sup></a></li>
		
			<li><a href="/categories/Dataguru/" title="Dataguru">Dataguru<sup>3</sup></a></li>
		
			<li><a href="/categories/Docker/" title="Docker">Docker<sup>7</sup></a></li>
		
			<li><a href="/categories/FP/" title="FP">FP<sup>2</sup></a></li>
		
			<li><a href="/categories/JVM/" title="JVM">JVM<sup>10</sup></a></li>
		
			<li><a href="/categories/Java/" title="Java">Java<sup>1</sup></a></li>
		
			<li><a href="/categories/Kafka/" title="Kafka">Kafka<sup>1</sup></a></li>
		
			<li><a href="/categories/Kubernetes/" title="Kubernetes">Kubernetes<sup>7</sup></a></li>
		
			<li><a href="/categories/Linux/" title="Linux">Linux<sup>1</sup></a></li>
		
			<li><a href="/categories/Memory-Model/" title="Memory Model">Memory Model<sup>1</sup></a></li>
		
			<li><a href="/categories/MyCAT/" title="MyCAT">MyCAT<sup>14</sup></a></li>
		
			<li><a href="/categories/Postgres/" title="Postgres">Postgres<sup>18</sup></a></li>
		
			<li><a href="/categories/REPL/" title="REPL">REPL<sup>1</sup></a></li>
		
			<li><a href="/categories/RocketMQ/" title="RocketMQ">RocketMQ<sup>1</sup></a></li>
		
			<li><a href="/categories/SSL/" title="SSL">SSL<sup>1</sup></a></li>
		
			<li><a href="/categories/Spring-Boot/" title="Spring Boot">Spring Boot<sup>1</sup></a></li>
		
			<li><a href="/categories/Tomcat/" title="Tomcat">Tomcat<sup>0</sup></a></li>
		
			<li><a href="/categories/dubbo/" title="dubbo">dubbo<sup>1</sup></a></li>
		
			<li><a href="/categories/other/" title="other">other<sup>2</sup></a></li>
		
			<li><a href="/categories/转载/" title="转载">转载<sup>1</sup></a></li>
		
			<li><a href="/categories/非技术/" title="非技术">非技术<sup>1</sup></a></li>
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			<li><a href="/tags/Blog/" title="Blog">Blog<sup>1</sup></a></li>
		
			<li><a href="/tags/Bug/" title="Bug">Bug<sup>1</sup></a></li>
		
			<li><a href="/tags/C/" title="C++">C++<sup>3</sup></a></li>
		
			<li><a href="/tags/C-11/" title="C++11">C++11<sup>1</sup></a></li>
		
			<li><a href="/tags/Dataguru/" title="Dataguru">Dataguru<sup>60</sup></a></li>
		
			<li><a href="/tags/Docker/" title="Docker">Docker<sup>7</sup></a></li>
		
			<li><a href="/tags/English-Learning/" title="English Learning">English Learning<sup>1</sup></a></li>
		
			<li><a href="/tags/Hexo/" title="Hexo">Hexo<sup>1</sup></a></li>
		
			<li><a href="/tags/JVM/" title="JVM">JVM<sup>10</sup></a></li>
		
			<li><a href="/tags/Java/" title="Java">Java<sup>14</sup></a></li>
		
			<li><a href="/tags/Kafka/" title="Kafka">Kafka<sup>1</sup></a></li>
		
			<li><a href="/tags/Kubernetes/" title="Kubernetes">Kubernetes<sup>7</sup></a></li>
		
			<li><a href="/tags/Linux/" title="Linux">Linux<sup>1</sup></a></li>
		
			<li><a href="/tags/MQ/" title="MQ">MQ<sup>2</sup></a></li>
		
			<li><a href="/tags/Memory-Model/" title="Memory Model">Memory Model<sup>1</sup></a></li>
		
			<li><a href="/tags/MyCAT/" title="MyCAT">MyCAT<sup>14</sup></a></li>
		
			<li><a href="/tags/Postgres/" title="Postgres">Postgres<sup>18</sup></a></li>
		
			<li><a href="/tags/Quantmod/" title="Quantmod">Quantmod<sup>3</sup></a></li>
		
			<li><a href="/tags/R/" title="R">R<sup>3</sup></a></li>
		
			<li><a href="/tags/REPL/" title="REPL">REPL<sup>1</sup></a></li>
		
		</ul>
</div>


  
  <div class="tagcloudlist">
    <p class="asidetitle">标签云</p>
    <div class="tagcloudlist clearfix">
       <a href="/tags/Blog/" style="font-size: 10.00px;">Blog</a><a href="/tags/Bug/" style="font-size: 10.00px;">Bug</a><a href="/tags/C/" style="font-size: 12.86px;">C++</a><a href="/tags/C-11/" style="font-size: 10.00px;">C++11</a><a href="/tags/Dataguru/" style="font-size: 20.00px;">Dataguru</a><a href="/tags/Docker/" style="font-size: 14.29px;">Docker</a><a href="/tags/English-Learning/" style="font-size: 10.00px;">English Learning</a><a href="/tags/Hexo/" style="font-size: 10.00px;">Hexo</a><a href="/tags/JVM/" style="font-size: 15.71px;">JVM</a><a href="/tags/Java/" style="font-size: 17.14px;">Java</a><a href="/tags/Kafka/" style="font-size: 10.00px;">Kafka</a><a href="/tags/Kubernetes/" style="font-size: 14.29px;">Kubernetes</a><a href="/tags/Linux/" style="font-size: 10.00px;">Linux</a><a href="/tags/MQ/" style="font-size: 11.43px;">MQ</a><a href="/tags/Memory-Model/" style="font-size: 10.00px;">Memory Model</a><a href="/tags/MyCAT/" style="font-size: 17.14px;">MyCAT</a><a href="/tags/Postgres/" style="font-size: 18.57px;">Postgres</a><a href="/tags/Quantmod/" style="font-size: 12.86px;">Quantmod</a><a href="/tags/R/" style="font-size: 12.86px;">R</a><a href="/tags/REPL/" style="font-size: 10.00px;">REPL</a><a href="/tags/RocketMQ/" style="font-size: 10.00px;">RocketMQ</a><a href="/tags/SICP/" style="font-size: 11.43px;">SICP</a><a href="/tags/SSL/" style="font-size: 10.00px;">SSL</a><a href="/tags/Scala/" style="font-size: 10.00px;">Scala</a><a href="/tags/Spring-Boot/" style="font-size: 10.00px;">Spring Boot</a><a href="/tags/Tomcat/" style="font-size: 11.43px;">Tomcat</a><a href="/tags/Translation/" style="font-size: 11.43px;">Translation</a><a href="/tags/boost/" style="font-size: 10.00px;">boost</a><a href="/tags/dubbo/" style="font-size: 10.00px;">dubbo</a><a href="/tags/maven/" style="font-size: 10.00px;">maven</a><a href="/tags/quantlib/" style="font-size: 10.00px;">quantlib</a><a href="/tags/scheme/" style="font-size: 11.43px;">scheme</a><a href="/tags/shipyard/" style="font-size: 10.00px;">shipyard</a><a href="/tags/区块链/" style="font-size: 10.00px;">区块链</a><a href="/tags/转载/" style="font-size: 12.86px;">转载</a><a href="/tags/非技术/" style="font-size: 10.00px;">非技术</a>
    </div>
  </div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
      <!--
      <li><a href="http://yangjian.me" target="_blank" title="YangJian">Alimon's Blog</a></li>
      <li><a href="http://zespia.tw/hexo" target="_blank" title="Hexo">Hexo</a></li>
      -->
    </ul>
</div>

  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >

</div>
</footer>
    <script src="/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  //back to top
  function backToTop(){
    var buttonHTML = $("<a href=\"#top\" id=\"back-top\">" + "<span>Back to Top</span></a>");
    buttonHTML.appendTo($("body"));
    var buttonToTop = $("#back-top");
    // hide #back-top first
    buttonToTop.hide();

    // fade in #back-top
    $(function() {
        $(window).scroll(function() {
            if ($(this).scrollTop() > 200) {
                buttonToTop.fadeIn();
            } else {
                buttonToTop.fadeOut();
            }
        });
        // scroll body to 0px on click
        buttonToTop.click(function() {
            $('body,html').animate({
                scrollTop: 0
            }, 800);
            return false;
        });
    });
  }
  backToTop();

  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      ta = $('#toc.toc-aside');
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });

  var show = true;
  c.click(function(){
    if(show == true){
        a.addClass('fadeOut').css('display', 'none');
        ta.css('display', 'block').addClass('fadeIn');
        m.addClass('moveMain');  
    }else{
        a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');     
        ta.css('display', 'none'); 
        m.removeClass('moveMain');
        $('#toc.toc-aside').css('display', 'none');
    }
    show = !show;
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{

    $(window).scroll(function(){
      ta.css("top",Math.max(140,240-$(this).scrollTop()));
    });
  };
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#share"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="#textlogo" class="article-back-to-top" title="Top"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="QRcode"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="Weibo"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});     
</script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>
