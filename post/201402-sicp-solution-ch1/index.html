
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>我的SICP习题解答-chapter 1 | 褚哥说|</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
    
    <meta name="author" content="Valleylord">
    
    <meta name="description" content="我使用的scheme解释器主要是petite chez scheme。解题过程中参考了：http://sicp.readthedocs.org/en/latest/index.html
1.1和1.2基本没问题，除非你没看书......
1.3
123456(define (&amp;lt;= x y">
    
    
    
    
    <link rel="alternative" href="/atom.xml" title="褚哥说|" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/author.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/author.jpg">
    

	
	<link href="http://cdn.bootcss.com/highlight.js/8.2/styles/monokai.min.css" rel="stylesheet">
	<script src="http://cdn.bootcss.com/highlight.js/8.2/highlight.min.js"></script>
	<script>hljs.initHighlightingOnLoad();</script>
	

    <link rel="stylesheet" href="/css/style.css" type="text/css">


</head>

  <body>
    <header>
      <div>
		
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="褚哥说|">褚哥说|</a></h1>
				<h2 class="blog-motto">我想写一些东西</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul><li> <a href="/atom.xml">RSS</a> </li>
                    <ul>
					 
						<li><a href="/">首页</a></li>
					
						<li><a href="/archives">归档</a></li>
					
						<li><a href="/tags">标签</a></li>
					
						<li><a href="/links">链接</a></li>
					
						<li><a href="http://www.cnblogs.com/valleylord/">旧文</a></li>
					
						<li><a href="/about">关于</a></li>
					
					<li>
					
					</li>
                <li><div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div></li>

				</ul>
			</nav>
</div>

    </header>
    <div id="container" class="clearfix">
      <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/post/201402-sicp-solution-ch1/" title="我的SICP习题解答-chapter 1" itemprop="url">我的SICP习题解答-chapter 1</a>
  </h1>
  <p class="article-author">By
    
      <a href="http://valleylord.github.io" title="Valleylord">Valleylord</a>
    </p>
  <p class="article-time">
    <time datetime="2014-02-07T11:55:00.000Z" itemprop="datePublished">2014-02-07</time>
    更新日期:<time datetime="2014-12-03T01:10:08.000Z" itemprop="dateModified">2014-12-03</time>
    
  </p>
</header>
	<div class="article-content">
		
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		
		</div>
		
		<p>我使用的scheme解释器主要是petite chez scheme。解题过程中参考了：http://sicp.readthedocs.org/en/latest/index.html</p>
<p>1.1和1.2基本没问题，除非你没看书......</p>
<p>1.3</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title"><span class="built_in">&lt;=</span></span> x y)</span></span></div><div class="line">    <span class="list">(<span class="title"><span class="built_in">or</span></span> <span class="list">(<span class="title"><span class="built_in">&lt;</span></span> x y)</span> <span class="list">(<span class="title"><span class="built_in">=</span></span> x y)</span>)</span>)</div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">add_large_two</span> a b c)</span></span></div><div class="line">    <span class="list">(<span class="title"><span class="built_in">cond</span></span> <span class="list">(<span class="list">(<span class="title"><span class="built_in">and</span></span> <span class="list">(<span class="title"><span class="built_in">&lt;=</span></span> a b)</span> <span class="list">(<span class="title"><span class="built_in">&lt;=</span></span> a c)</span>)</span>   <span class="list">(<span class="title"><span class="built_in">+</span></span> b c)</span>)</span></span></div><div class="line">             <span class="list">(<span class="list">(<span class="title"><span class="built_in">and</span></span> <span class="list">(<span class="title"><span class="built_in">&lt;=</span></span> b a)</span> <span class="list">(<span class="title"><span class="built_in">&lt;=</span></span> b c)</span>)</span>   <span class="list">(<span class="title"><span class="built_in">+</span></span> a c)</span>)</span></div><div class="line">             <span class="list">(<span class="title">else</span>                                 <span class="list">(<span class="title"><span class="built_in">+</span></span> a b)</span>)</span>))</div></pre></td></tr></table></figure></p>
<p>1.4 这题的意思应该是说，<code>+-*/</code>这些符号也可以作为表达式的返回值</p>
<p>1.5</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">p</span>)</span> <span class="list">(<span class="title">p</span>)</span>)</span></div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">test</span> x y)</span></span></div><div class="line">    <span class="list">(<span class="title"><span class="built_in">if</span></span> <span class="list">(<span class="title"><span class="built_in">=</span></span> x<span class="number"> 0</span>)</span><span class="number"> 0</span> y)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">test</span><span class="number"> 0</span> <span class="list">(<span class="title">p</span>)</span>)</span></div></pre></td></tr></table></figure></p>
<p>如果是正则序(normal-order evaluation)的话，那么会看到返回0，因为procedure test开始被call的时候就被展开，并求值，发现x=0就return了，y并没有被展开；如果是应用序(application-order evaluation)的话，那么会陷入无限递归，无法返回，因为procedure test试图展开y(也就是输入的p)，结果发现p被定义为自身，反复的展开p并得到p，最终陷入无限递归，无法被求值。我有一个疑问，如何在函数式编程中发现无穷递归？当一个程序运行了很久也没有返回的时候，究竟是这个程序本身运行的慢，还是已经陷入无穷递归，如何判定？在我的测试环境上，petite chez scheme和tiny scheme都是应用序的。(注：这题原先写反了)</p>
<p>1.6 这题和1.5是一个思路，子句什么时候展开的问题，scheme本身的if是应用序的，但是自定义的new-if是正则序的，会完全展开，然后else子句会自身调用并进一步展开，结果任然是死循环。</p>
<p>1.7 一个好一点的good-enough可以比较<code>abs(old-new)/old &lt; 0.000001</code>，基于这个思路，代码如下</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">sqrt</span> x)</span></span></div><div class="line">  <span class="list">(<span class="title">sqrt-iter</span><span class="number"> 1.0</span> x)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">sqrt-iter</span> guess x)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">if</span></span> <span class="list">(<span class="title">good-enough?</span> guess <span class="list">(<span class="title">improve</span> guess x)</span>)</span></span></div><div class="line">      guess</div><div class="line">      <span class="list">(<span class="title">sqrt-iter</span> <span class="list">(<span class="title">improve</span> guess x)</span></span></div><div class="line">                 x)))</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">improve</span> guess x)</span></span></div><div class="line">  <span class="list">(<span class="title">average</span> guess <span class="list">(<span class="title"><span class="built_in">/</span></span> x guess)</span>)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">average</span> x y)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">/</span></span> <span class="list">(<span class="title"><span class="built_in">+</span></span> x y)</span><span class="number"> 2</span>)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">good-enough?</span> x y)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">&lt;</span></span> <span class="list">(<span class="title"><span class="built_in">/</span></span> <span class="list">(<span class="title">abs</span> <span class="list">(<span class="title"><span class="built_in">-</span></span> x y)</span>)</span> x)</span><span class="number"> 0.0000001</span>)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">abs</span> x)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">if</span></span> <span class="list">(<span class="title"><span class="built_in">&lt;</span></span> x<span class="number"> 0</span>)</span> <span class="list">(<span class="title"><span class="built_in">-</span></span> x)</span></span></div><div class="line">      x))</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">square</span> x)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">*</span></span> x x)</span>)</div></pre></td></tr></table></figure></p>
<p>当然，这里没有检查输入不合法的情况，比如负数，而且输入0也会陷入无限循环，如果要考虑的话，可以修改<code>sqrt</code></p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">sqrt</span> x)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">cond</span></span> <span class="list">(<span class="list">(<span class="title"><span class="built_in">&gt;</span></span> x<span class="number"> 0</span>)</span> <span class="list">(<span class="title">sqrt-iter</span><span class="number"> 1.0</span> x)</span>)</span></span></div><div class="line">        <span class="list">(<span class="list">(<span class="title"><span class="built_in">=</span></span> x<span class="number"> 0</span>)</span><span class="number"> 0</span>)</span></div><div class="line">        <span class="list">(<span class="title">else</span>    -1)</span>))</div></pre></td></tr></table></figure></p>
<p>1.8 求立方的procedure cbrt，如下，主要修改了improve和good-enough</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">cbrt</span> x)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">cond</span></span> <span class="list">(<span class="list">(<span class="title"><span class="built_in">=</span></span> x<span class="number"> 0</span>)</span><span class="number"> 0</span>)</span></span></div><div class="line">        <span class="list">(<span class="title">else</span>    <span class="list">(<span class="title">cbrt-iter</span><span class="number"> 1.0</span> x)</span>)</span>))</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">cbrt-iter</span> guess x)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">if</span></span> <span class="list">(<span class="title">good-enough?</span> guess <span class="list">(<span class="title">improve</span> guess x)</span>)</span></span></div><div class="line">      guess</div><div class="line">      <span class="list">(<span class="title">cbrt-iter</span> <span class="list">(<span class="title">improve</span> guess x)</span></span></div><div class="line">                 x)))</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">improve</span> guess x)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">/</span></span> <span class="list">(<span class="title"><span class="built_in">+</span></span> <span class="list">(<span class="title"><span class="built_in">*</span></span><span class="number"> 2.0</span> guess)</span> <span class="list">(<span class="title"><span class="built_in">/</span></span> x <span class="list">(<span class="title">square</span> guess)</span>)</span>)</span><span class="number"> 3</span>)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">good-enough?</span> x y)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">&lt;</span></span> <span class="list">(<span class="title"><span class="built_in">/</span></span> <span class="list">(<span class="title">abs</span> <span class="list">(<span class="title"><span class="built_in">-</span></span> x y)</span>)</span> <span class="list">(<span class="title">abs</span> x)</span>)</span><span class="number"> 0.0000001</span>)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">abs</span> x)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">if</span></span> <span class="list">(<span class="title"><span class="built_in">&lt;</span></span> x<span class="number"> 0</span>)</span> <span class="list">(<span class="title"><span class="built_in">-</span></span> x)</span></span></div><div class="line">      x))</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">square</span> x)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">*</span></span> x x)</span>)</div></pre></td></tr></table></figure></p>
<p>1.9 递归计算过程和迭代计算过程的区别，程序如下，为了和scheme本身的<code>+-</code>号区别开，用<code>add</code>和<code>add2</code>来命名</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">add</span> a b)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">if</span></span> <span class="list">(<span class="title"><span class="built_in">=</span></span> a<span class="number"> 0</span>)</span> b</span></div><div class="line">      <span class="list">(<span class="title"><span class="built_in">inc</span></span> <span class="list">(<span class="title">add</span> <span class="list">(<span class="title"><span class="built_in">dec</span></span> a)</span> b)</span>)</span>))</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">add2</span> a b)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">if</span></span> <span class="list">(<span class="title"><span class="built_in">=</span></span> a<span class="number"> 0</span>)</span> b</span></div><div class="line">      <span class="list">(<span class="title">add</span> <span class="list">(<span class="title"><span class="built_in">dec</span></span> a)</span> <span class="list">(<span class="title"><span class="built_in">inc</span></span> b)</span>)</span>))</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title"><span class="built_in">dec</span></span> a)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">-</span></span> a<span class="number"> 1</span>)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title"><span class="built_in">inc</span></span> a)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">+</span></span> a<span class="number"> 1</span>)</span>)</div></pre></td></tr></table></figure></p>
<p><code>add</code>是递归计算过程，<code>add2</code>是迭代计算过程，假设我们的过程调用是<code>(add 3 5)</code>和<code>(add2 3 5)</code>，他们的展开分别是</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">add</span> <span class="number">3</span> <span class="number">5</span>)</span></div><div class="line"><span class="list">(<span class="title">inc</span> <span class="list">(<span class="title">add</span> <span class="number">2</span> <span class="number">5</span>)</span>)</span></div><div class="line"><span class="list">(<span class="title">inc</span> <span class="list">(<span class="title">inc</span> <span class="list">(<span class="title">add</span> <span class="number">1</span> <span class="number">5</span>)</span>)</span>)</span></div><div class="line"><span class="list">(<span class="title">inc</span> <span class="list">(<span class="title">inc</span> <span class="list">(<span class="title">inc</span> <span class="list">(<span class="title">add</span> <span class="number">0</span> <span class="number">5</span>)</span>)</span>)</span>)</span></div><div class="line"><span class="list">(<span class="title">inc</span> <span class="list">(<span class="title">inc</span> <span class="list">(<span class="title">inc</span> <span class="number">5</span>)</span>)</span>)</span></div><div class="line"><span class="list">(<span class="title">inc</span> <span class="list">(<span class="title">inc</span> <span class="number">6</span>)</span>)</span></div><div class="line"><span class="list">(<span class="title">inc</span> <span class="number">7</span>)</span></div><div class="line"><span class="number">8</span></div><div class="line"></div><div class="line"><span class="list">(<span class="title">add2</span> <span class="number">3</span> <span class="number">5</span>)</span></div><div class="line"><span class="list">(<span class="title">add2</span> <span class="number">2</span> <span class="number">6</span>)</span></div><div class="line"><span class="list">(<span class="title">add2</span> <span class="number">1</span> <span class="number">7</span>)</span></div><div class="line"><span class="list">(<span class="title">add2</span> <span class="number">0</span> <span class="number">8</span>)</span></div><div class="line"><span class="number">8</span></div></pre></td></tr></table></figure></p>
<p>其实，判定一个过程是递归计算过程还是迭代计算过程，也很简单，如果递归调用的时候，过程名出现在了参数列表中，那么就是递归计算过程；如果过程名不在参数列表中，那么就是迭代计算过程。这是我总结的经验，还没检验过......</p>
<p>1.10 Ackermann函数，</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="input"><span class="prompt">&gt; (A 1 10)</span></span></div><div class="line">1024</div><div class="line">&gt; (<span class="constant">A</span> <span class="number">2</span> <span class="number">4</span>)</div><div class="line"><span class="input"><span class="prompt">65536</span></span></div><div class="line">&gt; (<span class="constant">A</span> <span class="number">3</span> <span class="number">3</span>)</div><div class="line"><span class="number">65536</span></div></pre></td></tr></table></figure></p>
<p><code>(f n)</code>明显是<code>2*n</code>，<code>(g n)</code>是<code>2^n</code>，<code>(h n)</code>不是很容易猜，google了下，是2的连续2次幂，2^2^2......^2。</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(A <span class="number">2</span> n) = (A <span class="number">1</span> (A <span class="number">1</span> (A <span class="number">1</span> ( <span class="keyword">...</span> (A <span class="number">1</span> (A <span class="number">2</span> <span class="number">1</span>)) <span class="keyword">...</span> )</div></pre></td></tr></table></figure></p>
<p>顺便说一下，scheme的递归实在是太容易被击溃了，在算Ackermann的时候，又挂了一次，不过这次是数据太大，不能计算。如何能有效的防止这种递归机制在错误的时候，自我终结呢？还是要靠programmer的介入？</p>
<p>1.11 递归计算过程是f，迭代计算过程是f1</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">f</span> n)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">if</span></span> <span class="list">(<span class="title"><span class="built_in">&lt;</span></span> n<span class="number"> 3</span>)</span> n</span></div><div class="line">      <span class="list">(<span class="title"><span class="built_in">+</span></span> <span class="list">(<span class="title">f</span> <span class="list">(<span class="title"><span class="built_in">-</span></span> n<span class="number"> 1</span>)</span>)</span></span></div><div class="line">         <span class="list">(<span class="title"><span class="built_in">*</span></span> <span class="list">(<span class="title">f</span> <span class="list">(<span class="title"><span class="built_in">-</span></span> n<span class="number"> 2</span>)</span>)</span><span class="number"> 2</span>)</span></div><div class="line">         <span class="list">(<span class="title"><span class="built_in">*</span></span> <span class="list">(<span class="title">f</span> <span class="list">(<span class="title"><span class="built_in">-</span></span> n<span class="number"> 3</span>)</span>)</span><span class="number"> 3</span>)</span> )))</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">f1</span> n)</span></span></div><div class="line">  <span class="list">(<span class="title">f-iter</span><span class="number"> 2</span><span class="number"> 1</span><span class="number"> 0</span> n)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">f-iter</span> a b c n)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">cond</span></span> <span class="list">(<span class="list">(<span class="title"><span class="built_in">=</span></span> n<span class="number"> 0</span>)</span> c)</span></span></div><div class="line">        <span class="list">(<span class="list">(<span class="title"><span class="built_in">=</span></span> n<span class="number"> 1</span>)</span> b)</span></div><div class="line">        <span class="list">(<span class="list">(<span class="title"><span class="built_in">=</span></span> n<span class="number"> 2</span>)</span> a)</span></div><div class="line">        <span class="list">(<span class="title">else</span>    <span class="list">(<span class="title">f-iter</span> <span class="list">(<span class="title"><span class="built_in">+</span></span> a <span class="list">(<span class="title"><span class="built_in">*</span></span><span class="number"> 2</span> b)</span> <span class="list">(<span class="title"><span class="built_in">*</span></span><span class="number"> 3</span> c)</span>)</span> a b <span class="list">(<span class="title"><span class="built_in">-</span></span> n<span class="number"> 1</span>)</span>)</span>)</span>))</div></pre></td></tr></table></figure></p>
<p>在我的机器上，<code>f(30)</code>和<code>f1(30)</code>就有很明显的性能差异。</p>
<p>1.12 pascal三角，并且注解中标明，这个在中国叫“杨辉三角”。设计函数(pascal-triangle row col)用来计算第row行，第col列的杨辉三角的值，我设计是，行数和列数都是从1开始标号，如下图</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">row</div><div class="line"><span class="number">1</span>    <span class="number">1</span></div><div class="line"><span class="number">2</span>    <span class="number">1</span> <span class="number">1</span></div><div class="line"><span class="number">3</span>    <span class="number">1</span> <span class="number">2</span> <span class="number">1</span></div><div class="line"><span class="number">4</span>    <span class="number">1</span> <span class="number">3</span> <span class="number">3</span> <span class="number">1</span></div><div class="line"><span class="number">5</span>    <span class="number">1</span> <span class="number">4</span> <span class="number">6</span> <span class="number">4</span> <span class="number">1</span></div><div class="line"><span class="built_in">col</span>  <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span></div></pre></td></tr></table></figure></p>
<p>程序代码如下</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">pascal-triangle</span> row col)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">cond</span></span> <span class="list">(<span class="list">(<span class="title"><span class="built_in">=</span></span> col row)</span><span class="number"> 1</span>)</span></span></div><div class="line">        <span class="list">(<span class="list">(<span class="title"><span class="built_in">=</span></span> col<span class="number"> 1</span>)</span><span class="number">   1</span>)</span></div><div class="line">        <span class="list">(<span class="title">else</span>        <span class="list">(<span class="title"><span class="built_in">+</span></span> <span class="list">(<span class="title">pascal-triangle</span> <span class="list">(<span class="title"><span class="built_in">-</span></span> row<span class="number"> 1</span>)</span> col)</span> </span></span></div><div class="line">                        <span class="list">(<span class="title">pascal-triangle</span> <span class="list">(<span class="title"><span class="built_in">-</span></span> row<span class="number"> 1</span>)</span> <span class="list">(<span class="title"><span class="built_in">-</span></span> col<span class="number"> 1</span>)</span>)</span>) )))</div></pre></td></tr></table></figure></p>
<p>1.13 可以用特征方程的方法来推到，很easy，百度百科上就有。http://baike.baidu.com/view/816.htm</p>
<p>1.14 这题要求画图，我实在是不太会画，于是我在程序上加了一些display，这样就能比较容易的画出来了。</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">count-change</span> amount)</span></span></div><div class="line">  <span class="list">(<span class="title">cc</span> amount<span class="number"> 5</span>)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">cc</span> amount kinds-of-coins)</span></span></div><div class="line">  <span class="list">(<span class="title">display</span> <span class="list">(<span class="title"><span class="built_in">list</span></span> amount kinds-of-coins)</span>)</span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">newline</span></span>)</span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">cond</span></span> <span class="list">(<span class="list">(<span class="title"><span class="built_in">=</span></span> amount<span class="number"> 0</span>)</span><span class="number"> 1</span>)</span></span></div><div class="line">        <span class="list">(<span class="list">(<span class="title"><span class="built_in">or</span></span> <span class="list">(<span class="title"><span class="built_in">&lt;</span></span> amount<span class="number"> 0</span>)</span> <span class="list">(<span class="title"><span class="built_in">=</span></span> kinds-of-coins<span class="number"> 0</span>)</span>)</span><span class="number"> 0</span>)</span></div><div class="line">        <span class="list">(<span class="title">else</span> <span class="list">(<span class="title"><span class="built_in">+</span></span> <span class="list">(<span class="title">cc</span> amount</span></span></span></div><div class="line">                     <span class="list">(<span class="title"><span class="built_in">-</span></span> kinds-of-coins<span class="number"> 1</span>)</span>)</div><div class="line">                 <span class="list">(<span class="title">cc</span> <span class="list">(<span class="title"><span class="built_in">-</span></span> amount</span></span></div><div class="line">                        <span class="list">(<span class="title">first-denomination</span> kinds-of-coins)</span>)</div><div class="line">                     kinds-of-coins)))))</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">first-denomination</span> kinds-of-coins)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">cond</span></span> <span class="list">(<span class="list">(<span class="title"><span class="built_in">=</span></span> kinds-of-coins<span class="number"> 1</span>)</span><span class="number"> 1</span>)</span></span></div><div class="line">        <span class="list">(<span class="list">(<span class="title"><span class="built_in">=</span></span> kinds-of-coins<span class="number"> 2</span>)</span><span class="number"> 5</span>)</span></div><div class="line">        <span class="list">(<span class="list">(<span class="title"><span class="built_in">=</span></span> kinds-of-coins<span class="number"> 3</span>)</span><span class="number"> 10</span>)</span></div><div class="line">        <span class="list">(<span class="list">(<span class="title"><span class="built_in">=</span></span> kinds-of-coins<span class="number"> 4</span>)</span><span class="number"> 25</span>)</span></div><div class="line">        <span class="list">(<span class="list">(<span class="title"><span class="built_in">=</span></span> kinds-of-coins<span class="number"> 5</span>)</span><span class="number"> 50</span>)</span>))</div></pre></td></tr></table></figure></p>
<p>程序输出的结果就不贴了，加上最终输出的结果4，总共有56行。从运行结果来看，解释器是先运行<code>(cc amount (- kinds-of-coins 1))</code>这段的。生成的树如下图</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="pp">--<span class="params">(<span class="number">11</span> <span class="number">5</span>)</span>--<span class="params">(<span class="number">11</span> <span class="number">4</span>)</span>--<span class="params">(<span class="number">11</span> <span class="number">3</span>)</span>--<span class="params">(<span class="number">11</span> <span class="number">2</span>)</span>--<span class="params">(<span class="number">11</span> <span class="number">1</span>)</span>--<span class="params">(<span class="number">11</span> <span class="number">0</span>)</span></span></div><div class="line">        |       |       |       |       |-<span class="params">(<span class="number">10</span> <span class="number">1</span>)</span>--<span class="params">(<span class="number">10</span> <span class="number">0</span>)</span></div><div class="line">        |       |       |       |               |-<span class="params">(<span class="number">9</span> <span class="number">1</span>)</span> --<span class="params">(<span class="number">9</span> <span class="number">0</span>)</span></div><div class="line">        |       |       |       |                       |-<span class="params">(<span class="number">8</span> <span class="number">1</span>)</span> --<span class="params">(<span class="number">8</span> <span class="number">0</span>)</span></div><div class="line">        |       |       |       |                               |-<span class="params">(<span class="number">7</span> <span class="number">1</span>)</span> --<span class="params">(<span class="number">7</span> <span class="number">0</span>)</span></div><div class="line">        |       |       |       |                                       |-<span class="params">(<span class="number">6</span> <span class="number">1</span>)</span> --<span class="params">(<span class="number">6</span> <span class="number">0</span>)</span></div><div class="line">        |       |       |       |                                               |-<span class="params">(<span class="number">5</span> <span class="number">1</span>)</span> --<span class="params">(<span class="number">5</span> <span class="number">0</span>)</span></div><div class="line">        |       |       |       |                                                       |-<span class="params">(<span class="number">4</span> <span class="number">1</span>)</span> --<span class="params">(<span class="number">4</span> <span class="number">0</span>)</span></div><div class="line">        |       |       |       |                                                               |-<span class="params">(<span class="number">3</span> <span class="number">1</span>)</span> --<span class="params">(<span class="number">3</span> <span class="number">0</span>)</span></div><div class="line">        |       |       |       |                                                                       |-<span class="params">(<span class="number">2</span> <span class="number">1</span>)</span> --<span class="params">(<span class="number">2</span> <span class="number">0</span>)</span></div><div class="line">        |       |       |       |                                                                               |-<span class="params">(<span class="number">1</span> <span class="number">1</span>)</span> --<span class="params">(<span class="number">1</span> <span class="number">0</span>)</span></div><div class="line">        |       |       |       |                                                                                       |-<span class="params">(<span class="number">0</span> <span class="number">1</span>)</span></div><div class="line">        |       |       |       |-<span class="params">(<span class="number">6</span> <span class="number">2</span>)</span> --<span class="params">(<span class="number">6</span> <span class="number">1</span>)</span> --<span class="params">(<span class="number">6</span> <span class="number">0</span>)</span></div><div class="line">        |       |       |               |       |-<span class="params">(<span class="number">5</span> <span class="number">1</span>)</span> --<span class="params">(<span class="number">5</span> <span class="number">0</span>)</span></div><div class="line">        |       |       |               |               |-<span class="params">(<span class="number">4</span> <span class="number">1</span>)</span> --<span class="params">(<span class="number">4</span> <span class="number">0</span>)</span></div><div class="line">        |       |       |               |                       |-<span class="params">(<span class="number">3</span> <span class="number">1</span>)</span> --<span class="params">(<span class="number">3</span> <span class="number">0</span>)</span></div><div class="line">        |       |       |               |                               |-<span class="params">(<span class="number">2</span> <span class="number">1</span>)</span> --<span class="params">(<span class="number">2</span> <span class="number">0</span>)</span></div><div class="line">        |       |       |               |                                       |-<span class="params">(<span class="number">1</span> <span class="number">1</span>)</span> --<span class="params">(<span class="number">1</span> <span class="number">0</span>)</span></div><div class="line">        |       |       |               |                                               |-<span class="params">(<span class="number">0</span> <span class="number">1</span>)</span></div><div class="line">        |       |       |               |-<span class="params">(<span class="number">1</span> <span class="number">2</span>)</span> --<span class="params">(<span class="number">1</span> <span class="number">1</span>)</span> --<span class="params">(<span class="number">1</span> <span class="number">0</span>)</span></div><div class="line">        |       |       |                       |       |-<span class="params">(<span class="number">0</span> <span class="number">1</span>)</span></div><div class="line">        |       |       |                       |-<span class="params">(-<span class="number">4</span> <span class="number">2</span>)</span></div><div class="line">        |       |       |-<span class="params">(<span class="number">1</span> <span class="number">3</span>)</span> --<span class="params">(<span class="number">1</span> <span class="number">2</span>)</span> --<span class="params">(<span class="number">1</span> <span class="number">1</span>)</span> --<span class="params">(<span class="number">1</span> <span class="number">0</span>)</span></div><div class="line">        |       |               |       |       |-<span class="params">(<span class="number">0</span> <span class="number">1</span>)</span></div><div class="line">        |       |               |       |-<span class="params">(-<span class="number">4</span> <span class="number">2</span>)</span></div><div class="line">        |       |               |-<span class="params">(-<span class="number">9</span> <span class="number">3</span>)</span></div><div class="line">        |       |-<span class="params">(-<span class="number">14</span> <span class="number">4</span>)</span></div><div class="line">        |-<span class="params">(-<span class="number">39</span> <span class="number">5</span>)</span></div><div class="line">4</div></pre></td></tr></table></figure></p>
<p>很明显，该二叉树是非平衡的，最大深度是其根的左子树的深度，$(n/i+m)$，即输入金额/最小硬币面额+硬币种类数，也就是说，其最差情况的空间和步数增长的阶是O(2^(n/i+m))，其根的右子树的深度是$((n-k)/i+m)$，即(输入金额-最大硬币面额)/最小硬币面额+硬币种类数。接下去分析不下去了，我感觉这个问题的阶是与硬币的种类密切相关的，如果要猜测的话，我猜阶不会超过O(m(n+m))</p>
<p>1.15 这个问题还是采取和上一题类似的办法，display每个p的调用</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">cube</span> x)</span> <span class="list">(<span class="title"><span class="built_in">*</span></span> x x x)</span>)</span></div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">p</span> x)</span></span></div><div class="line">  <span class="list">(<span class="title">display</span> <span class="list">(<span class="title"><span class="built_in">list</span></span> <span class="string">"p "</span> x)</span>)</span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">newline</span></span>)</span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">-</span></span> <span class="list">(<span class="title"><span class="built_in">*</span></span><span class="number"> 3</span> x)</span> <span class="list">(<span class="title"><span class="built_in">*</span></span><span class="number"> 4</span> <span class="list">(<span class="title">cube</span> x)</span>)</span>)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">sine</span> angle)</span></span></div><div class="line">  <span class="list">(<span class="title">display</span> <span class="list">(<span class="title"><span class="built_in">list</span></span> <span class="string">"sine "</span> angle)</span>)</span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">newline</span></span>)</span></div><div class="line">   <span class="list">(<span class="title"><span class="built_in">if</span></span> <span class="list">(<span class="title"><span class="built_in">not</span></span> <span class="list">(<span class="title"><span class="built_in">&gt;</span></span> <span class="list">(<span class="title">abs</span> angle)</span><span class="number"> 0.1</span>)</span>)</span></span></div><div class="line">       angle</div><div class="line">       <span class="list">(<span class="title">p</span> <span class="list">(<span class="title">sine</span> <span class="list">(<span class="title"><span class="built_in">/</span></span> angle<span class="number"> 3.0</span>)</span>)</span>)</span>))</div></pre></td></tr></table></figure></p>
<p>输出是</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">sine</span>  <span class="number">12.15</span>)</span></div><div class="line"><span class="list">(<span class="title">sine</span>  <span class="number">4.05</span>)</span></div><div class="line"><span class="list">(<span class="title">sine</span>  <span class="number">1.3499999999999999</span>)</span></div><div class="line"><span class="list">(<span class="title">sine</span>  <span class="number">0.44999999999999996</span>)</span></div><div class="line"><span class="list">(<span class="title">sine</span>  <span class="number">0.15</span>)</span></div><div class="line"><span class="list">(<span class="title">sine</span>  <span class="number">0.049999999999999996</span>)</span></div><div class="line"><span class="list">(<span class="title">p</span>  <span class="number">0.049999999999999996</span>)</span></div><div class="line"><span class="list">(<span class="title">p</span>  <span class="number">0.1495</span>)</span></div><div class="line"><span class="list">(<span class="title">p</span>  <span class="number">0.4351345505</span>)</span></div><div class="line"><span class="list">(<span class="title">p</span>  <span class="number">0.9758465331678772</span>)</span></div><div class="line"><span class="list">(<span class="title">p</span>  <span class="number">-0.7895631144708228</span>)</span></div><div class="line"><span class="number">-0.39980345741334</span></div></pre></td></tr></table></figure></p>
<p>可以很明显的看到，p被调用了5次，<code>sine</code>被调用了6次，每次的参数也列出来了。每次调用<code>sine</code>的时候，参数a呈3倍递减，所以其阶是O(log3 a)。</p>
<p>1.16 这题还算厚道，直接贴代码了</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">fast-expt1</span> x n)</span></span></div><div class="line">  <span class="list">(<span class="title">fast-expt1-iter</span><span class="number"> 1</span> x n)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">fast-expt1-iter</span> a x n)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">cond</span></span> <span class="list">(<span class="list">(<span class="title"><span class="built_in">=</span></span> n<span class="number"> 0</span>)</span>   a)</span></span></div><div class="line">        <span class="list">(<span class="list">(<span class="title"><span class="built_in">even?</span></span> n)</span> <span class="list">(<span class="title">fast-expt1-iter</span> a <span class="list">(<span class="title"><span class="built_in">*</span></span> x x)</span> <span class="list">(<span class="title"><span class="built_in">/</span></span> n<span class="number"> 2</span>)</span>)</span>)</span></div><div class="line">        <span class="list">(<span class="title">else</span>      <span class="list">(<span class="title">fast-expt1-iter</span> <span class="list">(<span class="title"><span class="built_in">*</span></span> a x)</span> <span class="list">(<span class="title"><span class="built_in">*</span></span> x x)</span> <span class="list">(<span class="title"><span class="built_in">/</span></span> <span class="list">(<span class="title"><span class="built_in">-</span></span> n<span class="number"> 1</span>)</span><span class="number"> 2</span>)</span>)</span>)</span>))</div></pre></td></tr></table></figure></p>
<p>1.17 代码如下</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">fast-mult</span> x n)</span></span></div><div class="line">  <span class="list">(<span class="title">fast-mult-iter</span><span class="number"> 0</span> x n)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">fast-mult-iter</span> a x n)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">cond</span></span> <span class="list">(<span class="list">(<span class="title"><span class="built_in">=</span></span> n<span class="number"> 0</span>)</span>   a)</span></span></div><div class="line">        <span class="list">(<span class="list">(<span class="title"><span class="built_in">even?</span></span> n)</span> <span class="list">(<span class="title">fast-mult-iter</span> a <span class="list">(<span class="title"><span class="built_in">double</span></span> x)</span> <span class="list">(<span class="title">halve</span> n)</span>)</span>)</span></div><div class="line">        <span class="list">(<span class="title">else</span>      <span class="list">(<span class="title">fast-mult-iter</span> <span class="list">(<span class="title"><span class="built_in">+</span></span> a x)</span> <span class="list">(<span class="title"><span class="built_in">double</span></span> x)</span> <span class="list">(<span class="title">halve</span> <span class="list">(<span class="title"><span class="built_in">-</span></span> n<span class="number"> 1</span>)</span>)</span>)</span>)</span> ))</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title"><span class="built_in">double</span></span> x)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">+</span></span> x x)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">halve</span> x)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">/</span></span> x<span class="number"> 2</span>)</span>)</div></pre></td></tr></table></figure></p>
<p>1.18 我感觉这题是和1.17是一样的，看了一下其他人的解答，原来前一题的意思是用一个递归计算过程的方式来做的，看来我前一题错了，算了，不改了。</p>
<p>1.19 这题还是很有意思的，但是我没做出来，其实静下心来慢慢凑应该也是有希望的，我直接去找答案了......</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">fast-fib</span> n)</span></span></div><div class="line">  <span class="list">(<span class="title">fib-iter</span><span class="number"> 1</span><span class="number"> 0</span><span class="number"> 0</span><span class="number"> 1</span> n)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">fib-iter</span> a b p q count)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">cond</span></span> <span class="list">(<span class="list">(<span class="title"><span class="built_in">=</span></span> count<span class="number"> 0</span>)</span> b)</span></span></div><div class="line">        <span class="list">(<span class="list">(<span class="title"><span class="built_in">even?</span></span> count)</span></span></div><div class="line">         <span class="list">(<span class="title">fib-iter</span> a</span></div><div class="line">                   b</div><div class="line">                   <span class="list">(<span class="title"><span class="built_in">+</span></span> <span class="list">(<span class="title"><span class="built_in">*</span></span> p p)</span> <span class="list">(<span class="title"><span class="built_in">*</span></span> q q)</span>)</span> <span class="comment">; compute p'</span></div><div class="line">                   <span class="list">(<span class="title"><span class="built_in">+</span></span> <span class="list">(<span class="title"><span class="built_in">*</span></span><span class="number"> 2</span> p q)</span> <span class="list">(<span class="title"><span class="built_in">*</span></span> q q)</span>)</span> <span class="comment">; compute q'</span></div><div class="line">                   <span class="list">(<span class="title"><span class="built_in">/</span></span> count<span class="number"> 2</span>)</span>))</div><div class="line">        <span class="list">(<span class="title">else</span> <span class="list">(<span class="title">fib-iter</span> <span class="list">(<span class="title"><span class="built_in">+</span></span> <span class="list">(<span class="title"><span class="built_in">*</span></span> b q)</span> <span class="list">(<span class="title"><span class="built_in">*</span></span> a q)</span> <span class="list">(<span class="title"><span class="built_in">*</span></span> a p)</span>)</span></span></span></div><div class="line">                        <span class="list">(<span class="title"><span class="built_in">+</span></span> <span class="list">(<span class="title"><span class="built_in">*</span></span> b p)</span> <span class="list">(<span class="title"><span class="built_in">*</span></span> a q)</span>)</span></div><div class="line">                        p</div><div class="line">                        q</div><div class="line">                        <span class="list">(<span class="title"><span class="built_in">-</span></span> count<span class="number"> 1</span>)</span>))))</div></pre></td></tr></table></figure></p>
<p>1.20 <code>gcd</code>过程中，<code>remainder</code>的调用，在应用序的情况下是4次，分别是</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">remainder</span> <span class="number">206</span> <span class="number">40</span>)</span></div><div class="line"><span class="list">(<span class="title">remainder</span> <span class="number">40</span> <span class="number">6</span>)</span></div><div class="line"><span class="list">(<span class="title">remainder</span> <span class="number">6</span> <span class="number">4</span>)</span></div><div class="line"><span class="list">(<span class="title">remainder</span> <span class="number">4</span> <span class="number">2</span>)</span></div></pre></td></tr></table></figure></p>
<p>最后一次<code>gcd(2 0)</code>的时候直接返回，没有调用<code>remainder</code>，所以<code>gcd</code>的调用是5次。正题则序的话就多很多了，应为是先展开再求值，以<code>gcd(6 4)</code>举例，第1次展开得到<code>(gcd 4 (remainder 6 4))</code>，然后接着展开，在程序中有a和b的地方分别用4和<code>(remainder 6 4)</code>替换，if条件不满足，这样又多出了1次<code>remainder</code>调用，都是b的。最后一次<code>gcd</code>调用是<code>(gcd (remainder 6 4) (remainder 4 (remainder 6 4)))</code>，做同样的替换之后发现if条件满足，不需要继续递归了了，这样又多出3次<code>remainder</code>调用，2次是计算<code>b=(remainder 4 (remainder 6 4))</code>，1次是计算<code>a=(remainder 6 4)</code>。这样看起来的确多了很多次，有人总结了证明</p>
<p>正则代换后,则第n层的a b两个参数对应的<code>remainder</code>的次数分别为$a(n)$, $b(n)$,则: $$a(n) = b(n-1);b(n)=a(n-1)+b(n-1)+1;a(0)=0,b(0)=0$$ 总共5层,由于每层的if判断进行了计算,再加上最后一层的a是计算了的,所以最后的结果是: $$b(0)+b(1)+b(2)+b(3)+b(4)+a(4)=18$$ 这样看起来，我的解释器的确是应用序的。(注：应用序和正则序在FP里面还有另一种表述，分别是：Call-by-Value和Call-by-Name)</p>
<p>1.21 抄程序吧</p>
<p>1.22 坑爹啊，我找了N久才找到了petite里面记录系统运行时间的过程是<code>real-time</code>，首先修改了<code>timed-prime-test</code>来更方便的计时</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">timed-prime-test</span> n)</span></span></div><div class="line">  <span class="comment">;(newline)</span></div><div class="line">  <span class="comment">;(display n)</span></div><div class="line">  <span class="list">(<span class="title">start-prime-test</span> n <span class="list">(<span class="title">real-time</span>)</span>)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">start-prime-test</span> n start-time)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">if</span></span> <span class="list">(<span class="title">prime?</span> n)</span></span></div><div class="line">      <span class="list">(<span class="title">report-prime</span> n <span class="list">(<span class="title"><span class="built_in">-</span></span> <span class="list">(<span class="title">real-time</span>)</span> start-time)</span>)</span>))</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">report-prime</span> n elapsed-time)</span></span></div><div class="line">  <span class="list">(<span class="title">display</span> n)</span></div><div class="line">  <span class="list">(<span class="title">display</span> <span class="string">" *** "</span>)</span></div><div class="line">  <span class="list">(<span class="title">display</span> elapsed-time)</span></div><div class="line">  <span class="list">(<span class="title">display</span> <span class="string">"\n"</span>)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">next-odd</span> n)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">if</span></span> <span class="list">(<span class="title"><span class="built_in">even?</span></span> n)</span> <span class="list">(<span class="title"><span class="built_in">+</span></span> n<span class="number"> 1</span>)</span></span></div><div class="line">      <span class="list">(<span class="title"><span class="built_in">+</span></span> n<span class="number"> 2</span>)</span>))</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">search-prime</span> start-number first-i)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">if</span></span> <span class="list">(<span class="title"><span class="built_in">=</span></span> first-i<span class="number"> 0</span>)</span> <span class="list">(<span class="title">display</span> <span class="string">"Done\n"</span>)</span></span></div><div class="line">     <span class="list">(<span class="title"><span class="built_in">if</span></span> <span class="list">(<span class="title">prime?</span> start-number)</span> <span class="list">(<span class="list">(<span class="title">timed-prime-test</span> start-number)</span></span></span></div><div class="line">                                <span class="list">(<span class="title">search-prime</span> <span class="list">(<span class="title">next-odd</span> start-number)</span> <span class="list">(<span class="title"><span class="built_in">-</span></span> first-i<span class="number"> 1</span>)</span>)</span>)</div><div class="line">         <span class="list">(<span class="title">search-prime</span> <span class="list">(<span class="title">next-odd</span> start-number)</span> first-i)</span>) ))</div></pre></td></tr></table></figure></p>
<p>修改过后，只对已经判定为素数的情况做display，否则不做。另外，添加了2个函数为了方便测试，运行结果如下</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">&gt; (search-prime 1000000 3)</div><div class="line">1000003 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 0</div><div class="line">1000033 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 1</div><div class="line">1000037 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 1</div><div class="line">Done</div><div class="line">&gt; (search-prime 100000000 3)</div><div class="line">100000007 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 5</div><div class="line">100000037 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 5</div><div class="line">100000039 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 2</div><div class="line">Done</div><div class="line">&gt; (search-prime 10000000000 3)</div><div class="line">10000000019 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 17</div><div class="line">10000000033 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 17</div><div class="line">10000000061 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 17</div><div class="line">Done</div><div class="line">&gt; (search-prime 1000000000000 3)</div><div class="line">1000000000039 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 160</div><div class="line">1000000000061 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 157</div><div class="line">1000000000063 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 156</div><div class="line">Done</div><div class="line">&gt; (search-prime 10000000000000 3)</div><div class="line">10000000000037 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 505</div><div class="line">10000000000051 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 514</div><div class="line">10000000000099 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 497</div><div class="line">Done</div></pre></td></tr></table></figure></p>
<p>在输入变的越来越大的时候，的确是呈现<code>sqrt(n)</code>的态势在增长。实际运行的时候，在运行结束还会报错，不清楚原因，以后再查</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Exception: attempt <span class="keyword">to</span> apply non-<span class="function"><span class="keyword">procedure</span> #&lt;<span class="title">void</span>&gt;</span></div><div class="line"><span class="title">Type</span> <span class="params">(debug)</span> <span class="title">to</span> <span class="title">enter</span> <span class="title">the</span> <span class="title">debugger</span>.</div></pre></td></tr></table></figure></p>
<p>1.23 修改后的<code>prime?</code>过程如下</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">smallest-divisor</span> n)</span></span></div><div class="line">  <span class="list">(<span class="title">find-divisor</span> n<span class="number"> 2</span>)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">find-divisor</span> n test-divisor)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">cond</span></span> <span class="list">(<span class="list">(<span class="title"><span class="built_in">&gt;</span></span> <span class="list">(<span class="title">square</span> test-divisor)</span> n)</span> n)</span></span></div><div class="line">        <span class="list">(<span class="list">(<span class="title">divides?</span> test-divisor n)</span> test-divisor)</span></div><div class="line">        <span class="list">(<span class="title">else</span> <span class="list">(<span class="title">find-divisor</span> n <span class="list">(<span class="title">next-divisor</span> test-divisor)</span>)</span>)</span>))</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">divides?</span> a b)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">=</span></span> <span class="list">(<span class="title">remainder</span> b a)</span><span class="number"> 0</span>)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">prime?</span> n)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">=</span></span> n <span class="list">(<span class="title">smallest-divisor</span> n)</span>)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">next-divisor</span> n)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">if</span></span> <span class="list">(<span class="title"><span class="built_in">=</span></span> n<span class="number"> 2</span>)</span><span class="number"> 3</span></span></div><div class="line">      <span class="list">(<span class="title"><span class="built_in">+</span></span> n<span class="number"> 2</span>)</span>))</div></pre></td></tr></table></figure></p>
<p>重新运行1.22中的<code>search-prime</code>，运行结果如下</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&gt; (search-prime 10000000000 3)</div><div class="line">10000000019 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 12</div><div class="line">10000000033 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 12</div><div class="line">10000000061 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 11</div><div class="line">Done</div><div class="line">&gt; (search-prime 1000000000000 3)</div><div class="line">1000000000039 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 116</div><div class="line">1000000000061 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 117</div><div class="line">1000000000063 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 115</div><div class="line">Done</div><div class="line">&gt; (search-prime 10000000000000 3)</div><div class="line">10000000000037 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 358</div><div class="line">10000000000051 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 354</div><div class="line">10000000000099 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 357</div><div class="line">Done</div></pre></td></tr></table></figure></p>
<p>实际上的运行时间并没有达到预期的减半效果，大约是0.7倍的样子，是不是多了一层调用，以至于栈的开销上升了？</p>
<p>1.24 先把书上的代码敲进来，再做点修改</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">expmod</span> base exp m)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">cond</span></span> <span class="list">(<span class="list">(<span class="title"><span class="built_in">=</span></span> exp<span class="number"> 0</span>)</span><span class="number"> 1</span>)</span></span></div><div class="line">        <span class="list">(<span class="list">(<span class="title"><span class="built_in">even?</span></span> exp)</span></span></div><div class="line">         <span class="list">(<span class="title">remainder</span> <span class="list">(<span class="title">square</span> <span class="list">(<span class="title">expmod</span> base <span class="list">(<span class="title"><span class="built_in">/</span></span> exp<span class="number"> 2</span>)</span> m)</span>)</span></span></div><div class="line">                    m))</div><div class="line">        <span class="list">(<span class="title">else</span></span></div><div class="line">         <span class="list">(<span class="title">remainder</span> <span class="list">(<span class="title"><span class="built_in">*</span></span> base <span class="list">(<span class="title">expmod</span> base <span class="list">(<span class="title"><span class="built_in">-</span></span> exp<span class="number"> 1</span>)</span> m)</span>)</span></span></div><div class="line">                    m))))        </div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">fermat-test</span> n)</span></span></div><div class="line">  <span class="list">(<span class="title">define</span> <span class="list">(<span class="title">try-it</span> a)</span></span></div><div class="line">    <span class="list">(<span class="title"><span class="built_in">=</span></span> <span class="list">(<span class="title">expmod</span> a n n)</span> a)</span>)</div><div class="line">  <span class="list">(<span class="title">try-it</span> <span class="list">(<span class="title"><span class="built_in">+</span></span><span class="number"> 1</span> <span class="list">(<span class="title">random</span> <span class="list">(<span class="title"><span class="built_in">-</span></span> n<span class="number"> 1</span>)</span>)</span>)</span>)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">fast-prime?</span> n times)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">cond</span></span> <span class="list">(<span class="list">(<span class="title"><span class="built_in">=</span></span> times<span class="number"> 0</span>)</span> #t)</span></span></div><div class="line">        <span class="list">(<span class="list">(<span class="title">fermat-test</span> n)</span> <span class="list">(<span class="title">fast-prime?</span> n <span class="list">(<span class="title"><span class="built_in">-</span></span> times<span class="number"> 1</span>)</span>)</span>)</span></div><div class="line">        <span class="list">(<span class="title">else</span> #f)</span>))</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">square</span> x)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">*</span></span> x x)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">prime?</span> n)</span></span></div><div class="line">  <span class="list">(<span class="title">fast-prime?</span> n<span class="number"> 10</span>)</span>)</div></pre></td></tr></table></figure></p>
<p>把检测一个数是否是素数，变为<code>fermat-test</code> 10次，这样修改的话，对于每个数的验证，时间上就几乎没有差别了才对，事实也是的确如此，程序输出</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&gt; (search-prime 10000000000 3)</div><div class="line">10000000019 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 1</div><div class="line">10000000033 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 1</div><div class="line">10000000061 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 0</div><div class="line">Done</div><div class="line">&gt; (search-prime 1000000000000 3)</div><div class="line">1000000000039 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 0</div><div class="line">1000000000061 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 1</div><div class="line">1000000000063 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 1</div><div class="line">Done</div><div class="line">&gt; (search-prime 10000000000000 3)</div><div class="line">10000000000037 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 0</div><div class="line">10000000000051 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 0</div><div class="line">10000000000099 <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> 1</div><div class="line">Done</div></pre></td></tr></table></figure></p>
<p>当然，如果仔细分析的话，复杂度任然是按照O(log n)在增长，只是我的机器上无法精确的反应这个O(log n)的差别。</p>
<p>1.25 如果对于任意大的数，求<code>remainder</code>的时间都是一样的，换言之，<code>remainder</code>的复杂度是O(1)，这样的话，他认为的将<code>expmod</code>替换成<code>fast-expt+remainder</code>的做法就是对的，但是随着数据量增大，对大数据的运算越来越慢，最终甚至可能造成溢出。顺便说一下，这题的测试又一次造成了scheme解释器无尽的计算.....</p>
<p>1.26 直接用*的方法比用<code>square</code>的方法多计算了一次<code>(expmod base (/ exp 2) m)</code>。</p>
<p>1.27 <code>carmichael</code>数检验，把之前的<code>fermat</code>检验的代码修改一下就好</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">expmod</span> base exp m)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">cond</span></span> <span class="list">(<span class="list">(<span class="title"><span class="built_in">=</span></span> exp<span class="number"> 0</span>)</span><span class="number"> 1</span>)</span></span></div><div class="line">        <span class="list">(<span class="list">(<span class="title"><span class="built_in">even?</span></span> exp)</span></span></div><div class="line">         <span class="list">(<span class="title">remainder</span> <span class="list">(<span class="title">square</span> <span class="list">(<span class="title">expmod</span> base <span class="list">(<span class="title"><span class="built_in">/</span></span> exp<span class="number"> 2</span>)</span> m)</span>)</span></span></div><div class="line">                    m))</div><div class="line">        <span class="list">(<span class="title">else</span></span></div><div class="line">         <span class="list">(<span class="title">remainder</span> <span class="list">(<span class="title"><span class="built_in">*</span></span> base <span class="list">(<span class="title">expmod</span> base <span class="list">(<span class="title"><span class="built_in">-</span></span> exp<span class="number"> 1</span>)</span> m)</span>)</span></span></div><div class="line">                    m))))</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">try-it</span> n a)</span></span></div><div class="line">   <span class="list">(<span class="title"><span class="built_in">=</span></span> <span class="list">(<span class="title">expmod</span> a n n)</span> a)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">carmichael-test</span> n a)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">cond</span></span> <span class="list">(<span class="list">(<span class="title"><span class="built_in">=</span></span> a n)</span> #t)</span></span></div><div class="line">        <span class="list">(<span class="list">(<span class="title">try-it</span> n a)</span> <span class="list">(<span class="title">carmichael-test</span> n <span class="list">(<span class="title"><span class="built_in">+</span></span> a<span class="number"> 1</span>)</span>)</span>)</span></div><div class="line">        <span class="list">(<span class="title">else</span>         #f)</span> ))</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">square</span> x)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">*</span></span> x x)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">carmichael?</span> n)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">and</span></span> <span class="list">(<span class="title"><span class="built_in">not</span></span> <span class="list">(<span class="title">prime?</span> n)</span>)</span> <span class="list">(<span class="title">carmichael-test</span> n<span class="number"> 1</span>)</span>)</span>)</div></pre></td></tr></table></figure></p>
<p>运行结果</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="input"><span class="prompt">&gt; (carmichael?  561)</span></span></div><div class="line">#t</div><div class="line">&gt; (carmichael?  <span class="number">1105</span>)</div><div class="line"><span class="input"><span class="prompt">#t</span></span></div><div class="line">&gt; (carmichael?  <span class="number">1729</span>)</div><div class="line"><span class="input"><span class="prompt">#t</span></span></div><div class="line">&gt; (carmichael?  <span class="number">2465</span>)</div><div class="line"><span class="input"><span class="prompt">#t</span></span></div><div class="line">&gt; (carmichael?  <span class="number">2821</span>)</div><div class="line"><span class="input"><span class="prompt">#t</span></span></div><div class="line">&gt; (carmichael?  <span class="number">6601</span>)</div><div class="line"><span class="comment">#t</span></div></pre></td></tr></table></figure></p>
<p>1.28 引入非平凡平方根(nontrivial square root)的方法，程序改为</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">nontrivial-square-root?</span> a n)</span></span></div><div class="line">    <span class="list">(<span class="title"><span class="built_in">and</span></span> <span class="list">(<span class="title"><span class="built_in">not</span></span> <span class="list">(<span class="title"><span class="built_in">=</span></span> a<span class="number"> 1</span>)</span>)</span></span></div><div class="line">         <span class="list">(<span class="title"><span class="built_in">not</span></span> <span class="list">(<span class="title"><span class="built_in">=</span></span> a <span class="list">(<span class="title"><span class="built_in">-</span></span> n<span class="number"> 1</span>)</span>)</span>)</span></div><div class="line">         <span class="list">(<span class="title"><span class="built_in">=</span></span><span class="number"> 1</span> <span class="list">(<span class="title">remainder</span> <span class="list">(<span class="title">square</span> a)</span> n)</span>)</span>))</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">expmod</span> base exp m)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">cond</span></span> <span class="list">(<span class="list">(<span class="title"><span class="built_in">=</span></span> exp<span class="number"> 0</span>)</span><span class="number"> 1</span>)</span></span></div><div class="line">        <span class="list">(<span class="list">(<span class="title">nontrivial-square-root?</span> base m)</span><span class="number"> 0</span>)</span></div><div class="line">        <span class="list">(<span class="list">(<span class="title"><span class="built_in">even?</span></span> exp)</span></span></div><div class="line">         <span class="list">(<span class="title">remainder</span> <span class="list">(<span class="title">square</span> <span class="list">(<span class="title">expmod</span> base <span class="list">(<span class="title"><span class="built_in">/</span></span> exp<span class="number"> 2</span>)</span> m)</span>)</span></span></div><div class="line">                    m))</div><div class="line">        <span class="list">(<span class="title">else</span></span></div><div class="line">         <span class="list">(<span class="title">remainder</span> <span class="list">(<span class="title"><span class="built_in">*</span></span> base <span class="list">(<span class="title">expmod</span> base <span class="list">(<span class="title"><span class="built_in">-</span></span> exp<span class="number"> 1</span>)</span> m)</span>)</span></span></div><div class="line">                    m))))        </div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">mr-test</span> n)</span></span></div><div class="line">  <span class="list">(<span class="title">define</span> <span class="list">(<span class="title">try-it</span> a)</span></span></div><div class="line">    <span class="list">(<span class="title"><span class="built_in">=</span></span> <span class="list">(<span class="title">expmod</span> a <span class="list">(<span class="title"><span class="built_in">-</span></span> n<span class="number"> 1</span>)</span> n)</span><span class="number"> 1</span>)</span>)</div><div class="line">  <span class="list">(<span class="title">try-it</span> <span class="list">(<span class="title"><span class="built_in">+</span></span><span class="number"> 1</span> <span class="list">(<span class="title">random</span> <span class="list">(<span class="title"><span class="built_in">-</span></span> n<span class="number"> 1</span>)</span>)</span>)</span>)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">fast-prime?</span> n times)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">cond</span></span> <span class="list">(<span class="list">(<span class="title"><span class="built_in">=</span></span> times<span class="number"> 0</span>)</span> #t)</span></span></div><div class="line">        <span class="list">(<span class="list">(<span class="title">mr-test</span> n)</span> <span class="list">(<span class="title">fast-prime?</span> n <span class="list">(<span class="title"><span class="built_in">-</span></span> times<span class="number"> 1</span>)</span>)</span>)</span></div><div class="line">        <span class="list">(<span class="title">else</span> #f)</span>))</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">square</span> x)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">*</span></span> x x)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">prime?</span> n)</span></span></div><div class="line">  <span class="list">(<span class="title">fast-prime?</span> n<span class="number"> 1</span>)</span>)</div></pre></td></tr></table></figure></p>
<p>只需要修改<code>expmod</code>这个过程就好了。</p>
<p>1.29 辛普森积分方法，修改程序</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">sum</span> term a next b)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">if</span></span> <span class="list">(<span class="title"><span class="built_in">&gt;</span></span> a b)</span><span class="number"></span></span></div><div class="line">      0</div><div class="line">      <span class="list">(<span class="title"><span class="built_in">+</span></span> <span class="list">(<span class="title">term</span> a)</span></span></div><div class="line">         <span class="list">(<span class="title">sum</span> term <span class="list">(<span class="title"><span class="built_in">next</span></span> a)</span> next b)</span>)))</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">step-size</span> n a b)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">/</span></span> <span class="list">(<span class="title"><span class="built_in">-</span></span> b a)</span> n)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title"><span class="built_in">inc</span></span> n)</span> <span class="list">(<span class="title"><span class="built_in">+</span></span> n<span class="number"> 1</span>)</span>)</span></div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">cube</span> x)</span> <span class="list">(<span class="title"><span class="built_in">*</span></span> x x x)</span>)</span></div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">simpson-integral</span> fx a b n)</span></span></div><div class="line">  <span class="list">(<span class="title">define</span> dx <span class="list">(<span class="title">step-size</span> n a b)</span>)</span></div><div class="line">  <span class="list">(<span class="title">define</span> <span class="list">(<span class="title">coef</span> i)</span> </span></div><div class="line">    <span class="list">(<span class="title"><span class="built_in">cond</span></span> <span class="list">(<span class="list">(<span class="title"><span class="built_in">or</span></span> <span class="list">(<span class="title"><span class="built_in">=</span></span> i<span class="number"> 0</span>)</span> <span class="list">(<span class="title"><span class="built_in">=</span></span> i n)</span>)</span><span class="number"> 1</span>)</span></span></div><div class="line">          <span class="list">(<span class="list">(<span class="title"><span class="built_in">even?</span></span> i)</span><span class="number">   2</span>)</span></div><div class="line">          <span class="list">(<span class="title">else</span><span class="number">        4</span>)</span>))</div><div class="line">  <span class="list">(<span class="title">define</span> <span class="list">(<span class="title">f</span> i)</span> <span class="list">(<span class="title"><span class="built_in">*</span></span> <span class="list">(<span class="title">fx</span> <span class="list">(<span class="title"><span class="built_in">+</span></span> a <span class="list">(<span class="title"><span class="built_in">*</span></span> i dx)</span>)</span>)</span> <span class="list">(<span class="title">coef</span> i)</span>)</span>)</span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">*</span></span> <span class="list">(<span class="title">sum</span> f<span class="number"> 0</span> inc n)</span> <span class="list">(<span class="title"><span class="built_in">/</span></span> dx<span class="number"> 3</span>)</span>)</span> )</div></pre></td></tr></table></figure></p>
<p>输出比较</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="input"><span class="prompt">&gt; (simpson-integral cube 0.0 1.0 100)</span></span></div><div class="line">0.24999999999999992</div><div class="line">&gt; (simpson-integral cube <span class="number">0</span>.<span class="number">0</span> <span class="number">1.0</span> <span class="number">1000</span>)</div><div class="line"><span class="input"><span class="prompt">0.2500000000000003</span></span></div><div class="line"></div><div class="line">&gt; (integral cube <span class="number">0</span>.<span class="number">0</span> <span class="number">1.0</span> <span class="number">0</span>.<span class="number">01</span>)</div><div class="line"><span class="input"><span class="prompt">0.24998750000000042</span></span></div><div class="line">&gt; (integral cube <span class="number">0</span>.<span class="number">0</span> <span class="number">1.0</span> <span class="number">0</span>.<span class="number">001</span>)</div><div class="line"><span class="number">0</span>.<span class="number">249999875000001</span></div></pre></td></tr></table></figure></p>
<p>和原先的<code>integral</code>相比，<code>simpson-integral</code>的收敛比较快</p>
<p>1.30 程序如下</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">; use time to compare runtime <span class="keyword">in</span> petite like</div><div class="line">; (time (sum identity <span class="number">1</span> inc <span class="number">10000000</span>))</div><div class="line"></div><div class="line">(define (sum term a next b)</div><div class="line">  (define (iter a <span class="literal">result</span>)</div><div class="line">    (<span class="keyword">if</span> (&gt; a b) <span class="literal">result</span></div><div class="line">         (iter (next a) (+ <span class="literal">result</span> (term a)))))</div><div class="line">  (iter a <span class="number">0</span>))</div></pre></td></tr></table></figure></p>
<p>修改之后，运行速度变快，petite chez scheme的运行结果如下</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">; 原来的sum</div><div class="line">&gt; (time (sum identity <span class="number">1</span> inc <span class="number">10000000</span>))</div><div class="line">(time (sum identity <span class="keyword">...</span>))</div><div class="line">    <span class="number">143</span> collections</div><div class="line">    <span class="number">4923</span> ms elapsed cpu time, including <span class="number">3817</span> ms collecting</div><div class="line">    <span class="number">6099</span> ms elapsed real time, including <span class="number">4968</span> ms collecting</div><div class="line">    <span class="number">1209306752</span> bytes allocated, including <span class="number">1068476896</span> bytes reclaimed</div><div class="line"><span class="number">50000005000000</span></div><div class="line">&gt; (time (sum identity <span class="number">1</span> inc <span class="number">1000000</span>))</div><div class="line">(time (sum identity <span class="keyword">...</span>))</div><div class="line">    <span class="number">13</span> collections</div><div class="line">    <span class="number">311</span> ms elapsed cpu time, including <span class="number">198</span> ms collecting</div><div class="line">    <span class="number">313</span> ms elapsed real time, including <span class="number">199</span> ms collecting</div><div class="line">    <span class="number">114705968</span> bytes allocated, including <span class="number">82276352</span> bytes reclaimed</div><div class="line"><span class="number">500000500000</span></div><div class="line">; 修改之后的sum</div><div class="line">&gt; (time (sum identity <span class="number">1</span> inc <span class="number">10000000</span>))</div><div class="line">(time (sum identity <span class="keyword">...</span>))</div><div class="line">    no collections</div><div class="line">    <span class="number">999</span> ms elapsed cpu time</div><div class="line">    <span class="number">1001</span> ms elapsed real time</div><div class="line">    <span class="number">272</span> bytes allocated</div><div class="line"><span class="number">50000005000000</span></div><div class="line">&gt; (time (sum identity <span class="number">1</span> inc <span class="number">1000000</span>))</div><div class="line">(time (sum identity <span class="keyword">...</span>))</div><div class="line">    no collections</div><div class="line">    <span class="number">112</span> ms elapsed cpu time</div><div class="line">    <span class="number">112</span> ms elapsed real time</div><div class="line">    <span class="number">272</span> bytes allocated</div><div class="line"><span class="number">500000500000</span></div></pre></td></tr></table></figure></p>
<p>cpu时间明显降低，改为了迭代过程，不需要栈的开销，所以空间要求也降低了。</p>
<p>1.31 递归过程的<code>product</code>代码如下</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">product</span> term a next b)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">if</span></span> <span class="list">(<span class="title"><span class="built_in">&gt;</span></span> a b)</span><span class="number"></span></span></div><div class="line">      1</div><div class="line">      <span class="list">(<span class="title"><span class="built_in">*</span></span> <span class="list">(<span class="title">term</span> a)</span></span></div><div class="line">         <span class="list">(<span class="title">product</span> term <span class="list">(<span class="title"><span class="built_in">next</span></span> a)</span> next b)</span>)))</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title"><span class="built_in">inc</span></span> n)</span> <span class="list">(<span class="title"><span class="built_in">+</span></span> n<span class="number"> 1</span>)</span>)</span></div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title"><span class="built_in">identity</span></span> x)</span> x)</span></div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">square</span> x)</span> <span class="list">(<span class="title"><span class="built_in">*</span></span> x x)</span>)</span></div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">pi-term</span> x)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">/</span></span> <span class="list">(<span class="title"><span class="built_in">*</span></span> <span class="list">(<span class="title"><span class="built_in">-</span></span> x<span class="number"> 1</span>)</span> <span class="list">(<span class="title"><span class="built_in">+</span></span> x<span class="number"> 1</span>)</span>)</span> <span class="list">(<span class="title">square</span> x)</span>)</span> )</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">pi-next</span> x)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">+</span></span> x<span class="number"> 2</span>)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">factorial</span> n)</span></span></div><div class="line">  <span class="list">(<span class="title">product</span> identity<span class="number"> 1</span> inc n)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">pi-product</span> n)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">*</span></span><span class="number"> 4</span> <span class="list">(<span class="title">product</span> pi-term<span class="number"> 3.0</span> pi-next n)</span>)</span>)</div></pre></td></tr></table></figure></p>
<p>输出结果如下</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="input"><span class="prompt">&gt; (factorial 10)</span></span></div><div class="line">3628800</div><div class="line">&gt; (pi-product <span class="number">100</span>)</div><div class="line"><span class="input"><span class="prompt">3.1573396892175642</span></span></div><div class="line">&gt; (pi-product <span class="number">1000</span>)</div><div class="line"><span class="number">3.143163842419204</span></div></pre></td></tr></table></figure></p>
<p>如果把<code>product</code>改为迭代过程的话，代码改为</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">(define (product-iter term a next b)</div><div class="line">  (define (iter a <span class="literal">result</span>)</div><div class="line">    (<span class="keyword">if</span> (&gt; a b) <span class="literal">result</span></div><div class="line">         (iter (next a) (* <span class="literal">result</span> (term a)))))</div><div class="line">  (iter a <span class="number">1</span>))</div></pre></td></tr></table></figure></p>
<p>1.32 完全仿造原先的写法</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">accumulate</span> combiner null-value term a next b)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">if</span></span> <span class="list">(<span class="title"><span class="built_in">&gt;</span></span> a b)</span></span></div><div class="line">      null-value</div><div class="line">      <span class="list">(<span class="title">combiner</span> <span class="list">(<span class="title">term</span> a)</span></span></div><div class="line">         <span class="list">(<span class="title">accumulate</span> combiner null-value term <span class="list">(<span class="title"><span class="built_in">next</span></span> a)</span> next b)</span>)))</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">accumulate-iter</span> combiner null-value term a next b)</span></span></div><div class="line">  <span class="list">(<span class="title">define</span> <span class="list">(<span class="title">iter</span> a result)</span></span></div><div class="line">    <span class="list">(<span class="title"><span class="built_in">if</span></span> <span class="list">(<span class="title"><span class="built_in">&gt;</span></span> a b)</span> result</span></div><div class="line">         <span class="list">(<span class="title">iter</span> <span class="list">(<span class="title"><span class="built_in">next</span></span> a)</span> <span class="list">(<span class="title">combiner</span> result <span class="list">(<span class="title">term</span> a)</span>)</span>)</span>))</div><div class="line">  <span class="list">(<span class="title">iter</span> a null-value)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">sum</span> term a next b)</span></span></div><div class="line">  <span class="list">(<span class="title">accumulate</span> +<span class="number"> 0</span> term a next b)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">product</span> term a next b)</span></span></div><div class="line">  <span class="list">(<span class="title">accumulate</span> *<span class="number"> 1</span> term a next b)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">sum</span> term a next b)</span></span></div><div class="line">  <span class="list">(<span class="title">accumulate-iter</span> +<span class="number"> 0</span> term a next b)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">product</span> term a next b)</span></span></div><div class="line">  <span class="list">(<span class="title">accumulate-iter</span> *<span class="number"> 1</span> term a next b)</span>)</div></pre></td></tr></table></figure></p>
<p>1.33 <code>filtered-accumulate</code>有种map-reduce的感觉</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">filtered-accumulate</span> combiner null-value term a next b filt?)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">cond</span></span> <span class="list">(<span class="list">(<span class="title"><span class="built_in">&gt;</span></span> a b)</span>   null-value)</span></span></div><div class="line">        <span class="list">(<span class="list">(<span class="title">filt?</span> a)</span> </span></div><div class="line">           <span class="list">(<span class="title">combiner</span> <span class="list">(<span class="title">term</span> a)</span> </span></div><div class="line">              <span class="list">(<span class="title">filtered-accumulate</span> combiner null-value term <span class="list">(<span class="title"><span class="built_in">next</span></span> a)</span> next b filt?)</span>))</div><div class="line">        <span class="list">(<span class="title">else</span>      </span></div><div class="line">           <span class="list">(<span class="title">filtered-accumulate</span> combiner null-value term <span class="list">(<span class="title"><span class="built_in">next</span></span> a)</span> next b filt?)</span>) ))</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">filtered-accumulate-iter</span> combiner null-value term a next b filt?)</span></span></div><div class="line">  <span class="list">(<span class="title">define</span> <span class="list">(<span class="title">iter</span> a result)</span></span></div><div class="line">    <span class="list">(<span class="title"><span class="built_in">cond</span></span> <span class="list">(<span class="list">(<span class="title"><span class="built_in">&gt;</span></span> a b)</span>   result)</span></span></div><div class="line">          <span class="list">(<span class="list">(<span class="title">filt?</span> a)</span> <span class="list">(<span class="title">iter</span> <span class="list">(<span class="title"><span class="built_in">next</span></span> a)</span> <span class="list">(<span class="title">combiner</span> result <span class="list">(<span class="title">term</span> a)</span>)</span>)</span>)</span></div><div class="line">          <span class="list">(<span class="title">else</span>      <span class="list">(<span class="title">iter</span> <span class="list">(<span class="title"><span class="built_in">next</span></span> a)</span> result)</span>)</span> ))</div><div class="line">  <span class="list">(<span class="title">iter</span> a null-value)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">smallest-divisor</span> n)</span></span></div><div class="line">  <span class="list">(<span class="title">find-divisor</span> n<span class="number"> 2</span>)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">find-divisor</span> n test-divisor)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">cond</span></span> <span class="list">(<span class="list">(<span class="title"><span class="built_in">&gt;</span></span> <span class="list">(<span class="title">square</span> test-divisor)</span> n)</span> n)</span></span></div><div class="line">        <span class="list">(<span class="list">(<span class="title">divides?</span> test-divisor n)</span> test-divisor)</span></div><div class="line">        <span class="list">(<span class="title">else</span> <span class="list">(<span class="title">find-divisor</span> n <span class="list">(<span class="title">next-divisor</span> test-divisor)</span>)</span>)</span>))</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">divides?</span> a b)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">=</span></span> <span class="list">(<span class="title">remainder</span> b a)</span><span class="number"> 0</span>)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">prime?</span> n)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">=</span></span> n <span class="list">(<span class="title">smallest-divisor</span> n)</span>)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">next-divisor</span> n)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">if</span></span> <span class="list">(<span class="title"><span class="built_in">=</span></span> n<span class="number"> 2</span>)</span><span class="number"> 3</span></span></div><div class="line">      <span class="list">(<span class="title"><span class="built_in">+</span></span> n<span class="number"> 2</span>)</span>))</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">square</span> x)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">*</span></span> x x)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">sum-square-prime</span> a b)</span></span></div><div class="line">  <span class="list">(<span class="title">filtered-accumulate-iter</span> +<span class="number"> 0</span> square a inc b prime?)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">gcd</span> a b)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">if</span></span> <span class="list">(<span class="title"><span class="built_in">=</span></span> b<span class="number"> 0</span>)</span></span></div><div class="line">      a</div><div class="line">      <span class="list">(<span class="title">gcd</span> b <span class="list">(<span class="title">remainder</span> a b)</span>)</span> ))</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">prod-rela-prime</span> n)</span></span></div><div class="line">  <span class="list">(<span class="title">define</span> <span class="list">(<span class="title">rela-prime?</span> i)</span></span></div><div class="line">    <span class="list">(<span class="title"><span class="built_in">=</span></span> <span class="list">(<span class="title">gcd</span> i n)</span><span class="number"> 1</span>)</span>)</div><div class="line">  <span class="list">(<span class="title">filtered-accumulate-iter</span> *<span class="number"> 1</span> identity<span class="number"> 2</span> inc n rela-prime?)</span>)</div></pre></td></tr></table></figure></p>
<p><code>sum-square-prime</code>和<code>prod-rela-prime</code>分别是a)和b)的解答</p>
<p>1.34 最终会报错，petite上的报错是</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; (f f)</div><div class="line">Exception: attempt <span class="keyword">to</span> apply non-<span class="function"><span class="keyword">procedure</span> 2</span></div><div class="line"><span class="title">Type</span> <span class="params">(debug)</span> <span class="title">to</span> <span class="title">enter</span> <span class="title">the</span> <span class="title">debugger</span>.</div></pre></td></tr></table></figure></p>
<p>因为<code>(f f)-&gt;(f 2)-&gt;(2 2)</code>，2不是一个过程，就悲剧了</p>
<p>1.35 证明黄金分割率就跳过了，二元一次方程而已，计算程序基本上就是抄<code>fixed-point</code>那段，输出是</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; (<span class="keyword">fixed</span>-point (lambda (x) (+ <span class="number">1</span> (/ <span class="number">1</span> x))) <span class="number">1.0</span>)</div><div class="line"><span class="number">1.6180327868852458</span></div></pre></td></tr></table></figure></p>
<p>1.36 老的程序就是不用平均阻尼来计算的，输出是</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">&gt; (fixed-point (lambda (<span class="keyword">x</span>) (/ (<span class="built_in">log</span> <span class="number">1000</span>) (<span class="built_in">log</span> <span class="keyword">x</span>))) <span class="number">1.1</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">1.1</span> <span class="number">72.47657378429035</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">72.47657378429035</span> <span class="number">1.6127318474109593</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">1.6127318474109593</span> <span class="number">14.45350138636525</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">14.45350138636525</span> <span class="number">2.5862669415385087</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">2.5862669415385087</span> <span class="number">7.269672273367045</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">7.269672273367045</span> <span class="number">3.4822383620848467</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">3.4822383620848467</span> <span class="number">5.536500810236703</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">5.536500810236703</span> <span class="number">4.036406406288111</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.036406406288111</span> <span class="number">4.95053682041456</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.95053682041456</span> <span class="number">4.318707390180805</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.318707390180805</span> <span class="number">4.721778787145103</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.721778787145103</span> <span class="number">4.450341068884912</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.450341068884912</span> <span class="number">4.626821434106115</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.626821434106115</span> <span class="number">4.509360945293209</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.509360945293209</span> <span class="number">4.586349500915509</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.586349500915509</span> <span class="number">4.535372639594589</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.535372639594589</span> <span class="number">4.568901484845316</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.568901484845316</span> <span class="number">4.546751100777536</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.546751100777536</span> <span class="number">4.561341971741742</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.561341971741742</span> <span class="number">4.551712230641226</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.551712230641226</span> <span class="number">4.558059671677587</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.558059671677587</span> <span class="number">4.55387226495538</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.55387226495538</span> <span class="number">4.556633177654167</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.556633177654167</span> <span class="number">4.554812144696459</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.554812144696459</span> <span class="number">4.556012967736543</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.556012967736543</span> <span class="number">4.555220997683307</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.555220997683307</span> <span class="number">4.555743265552239</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.555743265552239</span> <span class="number">4.555398830243649</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.555398830243649</span> <span class="number">4.555625974816275</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.555625974816275</span> <span class="number">4.555476175432173</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.555476175432173</span> <span class="number">4.555574964557791</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.555574964557791</span> <span class="number">4.555509814636753</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.555509814636753</span> <span class="number">4.555552779647764</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.555552779647764</span> <span class="number">4.555524444961165</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.555524444961165</span> <span class="number">4.555543131130589</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.555543131130589</span> <span class="number">4.555530807938518</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.555530807938518</span> <span class="number">4.555538934848503</span>)</div><div class="line"><span class="number">4.555538934848503</span></div></pre></td></tr></table></figure></p>
<p>使用平均阻尼的代码如下</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">fine tolerance <span class="number">0.00001</span>)</div><div class="line"></div><div class="line">(define (fixed-point <span class="keyword">f</span> <span class="keyword">first</span>-guess)</div><div class="line">  (define (<span class="keyword">close</span>-enough? v1 v2)</div><div class="line">    (&lt; (<span class="built_in">abs</span> (- v1 v2)) tolerance))</div><div class="line">  (define (<span class="keyword">try</span> guess)</div><div class="line">    (<span class="keyword">display</span> (<span class="keyword">list</span> <span class="string">"try "</span> guess (<span class="keyword">f</span> guess)))</div><div class="line">    (newline)</div><div class="line">    (<span class="keyword">let</span> ((<span class="keyword">next</span> (average guess (<span class="keyword">f</span> guess))))</div><div class="line">      (<span class="keyword">if</span> (<span class="keyword">close</span>-enough? guess <span class="keyword">next</span>)</div><div class="line">          <span class="keyword">next</span></div><div class="line">          (<span class="keyword">try</span> <span class="keyword">next</span>))))</div><div class="line">  (<span class="keyword">try</span> <span class="keyword">first</span>-guess))</div><div class="line"></div><div class="line">(define (average <span class="keyword">a</span> <span class="keyword">b</span>)</div><div class="line">  (/ (+ <span class="keyword">a</span> <span class="keyword">b</span>) <span class="number">2</span>))</div></pre></td></tr></table></figure></p>
<p>输出是</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&gt; (fixed-point (lambda (<span class="keyword">x</span>) (/ (<span class="built_in">log</span> <span class="number">1000</span>) (<span class="built_in">log</span> <span class="keyword">x</span>))) <span class="number">1.1</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">1.1</span> <span class="number">72.47657378429035</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">36.78828689214517</span> <span class="number">1.9160641716198537</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">19.352175531882512</span> <span class="number">2.331491827268849</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">10.84183367957568</span> <span class="number">2.8982630247078642</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">6.870048352141772</span> <span class="number">3.5844015717925406</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">5.227224961967156</span> <span class="number">4.176695428351422</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.701960195159289</span> <span class="number">4.46243335124296</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.582196773201124</span> <span class="number">4.538071686206237</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.560134229703681</span> <span class="number">4.55250660915824</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.5563204194309606</span> <span class="number">4.555018304137115</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.555669361784037</span> <span class="number">4.55544756416724</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.555558462975639</span> <span class="number">4.555520696950483</span>)</div><div class="line">(<span class="keyword">try</span>  <span class="number">4.55553957996306</span> <span class="number">4.555533149860501</span>)</div><div class="line"><span class="number">4.555536364911781</span></div></pre></td></tr></table></figure></p>
<p>可以发现， 使用平均阻尼的话，迭代次数明显变少。</p>
<p>1.37 递归过程和迭代过程代码如下</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">cont-frac</span> ni di k)</span></span></div><div class="line">  <span class="list">(<span class="title">define</span> <span class="list">(<span class="title">cont-frac-recur</span> i)</span></span></div><div class="line">    <span class="list">(<span class="title"><span class="built_in">if</span></span> <span class="list">(<span class="title"><span class="built_in">=</span></span> i k)</span> <span class="list">(<span class="title"><span class="built_in">/</span></span> <span class="list">(<span class="title">ni</span> i)</span> <span class="list">(<span class="title">di</span> i)</span>)</span></span></div><div class="line">        <span class="list">(<span class="title"><span class="built_in">/</span></span> <span class="list">(<span class="title">ni</span> i)</span> <span class="list">(<span class="title"><span class="built_in">+</span></span> <span class="list">(<span class="title">di</span> i)</span> <span class="list">(<span class="title">cont-frac-recur</span> <span class="list">(<span class="title"><span class="built_in">+</span></span> i<span class="number"> 1</span>)</span>)</span>)</span>)</span> ))</div><div class="line">  <span class="list">(<span class="title">cont-frac-recur</span><span class="number"> 1</span>)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">cont-frac-iter</span> ni di k)</span></span></div><div class="line">  <span class="list">(<span class="title">define</span> <span class="list">(<span class="title">iter</span> i result)</span></span></div><div class="line">    <span class="list">(<span class="title"><span class="built_in">let</span></span> <span class="list">(<span class="list">(<span class="title">fi</span> <span class="list">(<span class="title"><span class="built_in">/</span></span> <span class="list">(<span class="title">ni</span> i)</span> <span class="list">(<span class="title"><span class="built_in">+</span></span> <span class="list">(<span class="title">di</span> i)</span> result)</span>)</span>)</span>)</span></span></div><div class="line">      <span class="list">(<span class="title"><span class="built_in">if</span></span> <span class="list">(<span class="title"><span class="built_in">=</span></span> i<span class="number"> 1</span>)</span> fi</span></div><div class="line">          <span class="list">(<span class="title">iter</span> <span class="list">(<span class="title"><span class="built_in">-</span></span> i<span class="number"> 1</span>)</span> fi)</span>)))</div><div class="line">  <span class="list">(<span class="title">iter</span> k<span class="number"> 0</span>)</span>)</div></pre></td></tr></table></figure></p>
<p>黄金分割的4位小数近似为0.6180，实验数值表明，在k=10的时候，得到4位小数近似值</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&gt; (cont-frac (lambda (<span class="built_in">i</span>) <span class="number">1.0</span>) (lambda (<span class="built_in">i</span>) <span class="number">1.0</span>) <span class="number">9</span>)</div><div class="line"><span class="number">0.6181818181818182</span></div><div class="line">&gt; (cont-frac (lambda (<span class="built_in">i</span>) <span class="number">1.0</span>) (lambda (<span class="built_in">i</span>) <span class="number">1.0</span>) <span class="number">10</span>)</div><div class="line"><span class="number">0.6179775280898876</span> </div><div class="line"><span class="number">1.38</span> 利用<span class="number">1.37</span>中的程序即可</div><div class="line"> </div><div class="line">&gt; (cont-frac (lambda (<span class="built_in">i</span>) <span class="number">1.0</span>) </div><div class="line">             (lambda (<span class="built_in">i</span>) (<span class="keyword">if</span> (= (remainder <span class="built_in">i</span> <span class="number">3</span>) <span class="number">2</span>) (* (+ (div <span class="built_in">i</span> <span class="number">3</span>) <span class="number">1</span>) <span class="number">2</span>) </div><div class="line">                             <span class="number">1</span>)) </div><div class="line">             <span class="number">10</span>)</div><div class="line"><span class="number">0.7182817182817183</span></div></pre></td></tr></table></figure></p>
<p>1.39 利用1.37中的程序，再加上下面这段即可</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">square</span> x)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">*</span></span> x x)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">tan-cf</span> x k)</span></span></div><div class="line">  <span class="list">(<span class="title">cont-frac</span> <span class="list">(<span class="title">lambda</span> <span class="list">(<span class="title">i</span>)</span> <span class="list">(<span class="title"><span class="built_in">if</span></span> <span class="list">(<span class="title"><span class="built_in">=</span></span> i<span class="number"> 1</span>)</span> x</span></span></span></div><div class="line">                             <span class="list">(<span class="title"><span class="built_in">-</span></span><span class="number"> 0</span> <span class="list">(<span class="title">square</span> x)</span>)</span>)) </div><div class="line">             <span class="list">(<span class="title">lambda</span> <span class="list">(<span class="title">i</span>)</span> <span class="list">(<span class="title"><span class="built_in">-</span></span> <span class="list">(<span class="title"><span class="built_in">*</span></span><span class="number"> 2</span> i)</span><span class="number"> 1</span>)</span>)</span> </div><div class="line">             k))</div></pre></td></tr></table></figure></p>
<p>输出验证</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="input"><span class="prompt">&gt; (tan-cf 1.0 10)</span></span></div><div class="line">1.557407724654902</div><div class="line">&gt; (tan-cf <span class="number">1.0</span> <span class="number">5</span>)</div><div class="line"><span class="input"><span class="prompt">1.5574074074074076</span></span></div><div class="line">&gt; (tan <span class="number">1.0</span>)</div><div class="line"><span class="number">1.5574077246549023</span></div></pre></td></tr></table></figure></p>
<p>1.40 其他的程序和书上一样，<code>cubic</code>定义如下</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">cubic</span> a b c)</span></span></div><div class="line">  <span class="list">(<span class="title">lambda</span> <span class="list">(<span class="title">x</span>)</span> <span class="list">(<span class="title"><span class="built_in">+</span></span> <span class="list">(<span class="title">cube</span> x)</span> </span></span></div><div class="line">                 <span class="list">(<span class="title"><span class="built_in">*</span></span> a <span class="list">(<span class="title">square</span> x)</span>)</span></div><div class="line">                 <span class="list">(<span class="title"><span class="built_in">*</span></span> b x)</span></div><div class="line">                 c)))</div></pre></td></tr></table></figure></p>
<p>1.41 程序如下</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">(define (double <span class="keyword">proc</span>)</div><div class="line">  (lambda (x) (<span class="keyword">proc</span> (<span class="keyword">proc</span> x))))</div></pre></td></tr></table></figure></p>
<p>输出验证如下</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; (((<span class="keyword">double</span> (<span class="keyword">double</span> <span class="keyword">double</span>)) inc) <span class="number">5</span>)</div><div class="line"><span class="number">21</span></div></pre></td></tr></table></figure></p>
<p>解释是这样的，第1个<code>double</code>的参数是<code>(double double)</code>，返回是<code>(double double)(double double)</code>，也就是要做4次<code>double</code>，所以跟在后面的<code>inc</code>总共做了2^4=16次。</p>
<p>1.42 这题应该是好几题以来最简单的</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">compose</span> fx gx)</span></span></div><div class="line">  <span class="list">(<span class="title">lambda</span> <span class="list">(<span class="title">x</span>)</span> <span class="list">(<span class="title">fx</span> <span class="list">(<span class="title">gx</span> x)</span>)</span>)</span>)</div></pre></td></tr></table></figure></p>
<p>1.43 利用1.42的结果</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">compose</span> fx gx)</span></span></div><div class="line">  <span class="list">(<span class="title">lambda</span> <span class="list">(<span class="title">x</span>)</span> <span class="list">(<span class="title">fx</span> <span class="list">(<span class="title">gx</span> x)</span>)</span>)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">repeated</span> fx n)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">if</span></span> <span class="list">(<span class="title"><span class="built_in">=</span></span> n<span class="number"> 1</span>)</span> fx</span></div><div class="line">      <span class="list">(<span class="title">compose</span> fx <span class="list">(<span class="title">repeated</span> fx <span class="list">(<span class="title"><span class="built_in">-</span></span> n<span class="number"> 1</span>)</span>)</span>)</span> ))</div></pre></td></tr></table></figure></p>
<p>1.44 调用1.43的<code>repeated</code>，代码如下</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">define</span> dx<span class="number"> 0.00001</span>)</span></div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">smooth</span> fx)</span></span></div><div class="line">  <span class="list">(<span class="title">lambda</span> <span class="list">(<span class="title">x</span>)</span> <span class="list">(<span class="title"><span class="built_in">/</span></span> <span class="list">(<span class="title"><span class="built_in">+</span></span> <span class="list">(<span class="title">fx</span> <span class="list">(<span class="title"><span class="built_in">+</span></span> x dx)</span>)</span></span></span></span></div><div class="line">                    <span class="list">(<span class="title">fx</span> x)</span></div><div class="line">                    <span class="list">(<span class="title">fx</span> <span class="list">(<span class="title"><span class="built_in">-</span></span> x dx)</span>)</span>)<span class="number"> 3</span>)))</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">smooth_n</span> fx n)</span></span></div><div class="line">  <span class="list">(<span class="list">(<span class="title">repeated</span> smooth n)</span> fx)</span>)</div></pre></td></tr></table></figure></p>
<p>1.45 借用1.17的<code>fast-expt</code>求幂，借用1.43的<code>repeated</code>求平均阻尼</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">fast-expt1</span> x n)</span></span></div><div class="line">  <span class="list">(<span class="title">fast-expt1-iter</span><span class="number"> 1</span> x n)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">fast-expt1-iter</span> a x n)</span></span></div><div class="line">  <span class="list">(<span class="title"><span class="built_in">cond</span></span> <span class="list">(<span class="list">(<span class="title"><span class="built_in">=</span></span> n<span class="number"> 0</span>)</span>   a)</span></span></div><div class="line">        <span class="list">(<span class="list">(<span class="title"><span class="built_in">even?</span></span> n)</span> <span class="list">(<span class="title">fast-expt1-iter</span> a <span class="list">(<span class="title"><span class="built_in">*</span></span> x x)</span> <span class="list">(<span class="title"><span class="built_in">/</span></span> n<span class="number"> 2</span>)</span>)</span>)</span></div><div class="line">        <span class="list">(<span class="title">else</span>      <span class="list">(<span class="title">fast-expt1-iter</span> <span class="list">(<span class="title"><span class="built_in">*</span></span> a x)</span> <span class="list">(<span class="title"><span class="built_in">*</span></span> x x)</span> <span class="list">(<span class="title"><span class="built_in">/</span></span> <span class="list">(<span class="title"><span class="built_in">-</span></span> n<span class="number"> 1</span>)</span><span class="number"> 2</span>)</span>)</span>)</span>))</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">average-damp</span> f)</span></span></div><div class="line">  <span class="list">(<span class="title">lambda</span> <span class="list">(<span class="title">x</span>)</span> <span class="list">(<span class="title">average</span> x <span class="list">(<span class="title">f</span> x)</span>)</span>)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> tolerance<span class="number"> 0.00001</span>)</span></div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">fixed-point</span> f first-guess)</span></span></div><div class="line">  <span class="list">(<span class="title">define</span> <span class="list">(<span class="title">close-enough?</span> v1 v2)</span></span></div><div class="line">    <span class="list">(<span class="title"><span class="built_in">&lt;</span></span> <span class="list">(<span class="title">abs</span> <span class="list">(<span class="title"><span class="built_in">-</span></span> v1 v2)</span>)</span> tolerance)</span>)</div><div class="line">  <span class="list">(<span class="title">define</span> <span class="list">(<span class="title"><span class="built_in">try</span></span> guess)</span></span></div><div class="line">    <span class="list">(<span class="title"><span class="built_in">let</span></span> <span class="list">(<span class="list">(<span class="title"><span class="built_in">next</span></span> <span class="list">(<span class="list">(<span class="title">average-damp</span> f)</span> guess)</span>)</span>)</span></span></div><div class="line">      <span class="list">(<span class="title"><span class="built_in">if</span></span> <span class="list">(<span class="title">close-enough?</span> guess next)</span></span></div><div class="line">          next</div><div class="line">          <span class="list">(<span class="title"><span class="built_in">try</span></span> next)</span>)))</div><div class="line">  <span class="list">(<span class="title"><span class="built_in">try</span></span> first-guess)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">fixed-point-of-transform</span> g transform guess)</span></span></div><div class="line">  <span class="list">(<span class="title">fixed-point</span> <span class="list">(<span class="title">transform</span> g)</span> guess)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">log2</span> x)</span></span></div><div class="line">  <span class="list">(<span class="title">round</span> <span class="list">(<span class="title"><span class="built_in">/</span></span> <span class="list">(<span class="title">log</span> x)</span> <span class="list">(<span class="title">log</span><span class="number"> 2</span>)</span>)</span>)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">nth-root</span> x n)</span></span></div><div class="line">  <span class="list">(<span class="title">define</span> <span class="list">(<span class="title">average-damp</span> f)</span></span></div><div class="line">    <span class="list">(<span class="title">lambda</span> <span class="list">(<span class="title">x</span>)</span> <span class="list">(<span class="title">average</span> x <span class="list">(<span class="title">f</span> x)</span>)</span>)</span>)</div><div class="line">  <span class="list">(<span class="title">define</span> <span class="list">(<span class="title">rep-avg-damp</span> f)</span></span></div><div class="line">    <span class="list">(<span class="list">(<span class="title">repeated</span> average-damp <span class="list">(<span class="title">log2</span> n)</span>)</span> f)</span>)</div><div class="line">  <span class="list">(<span class="title">fixed-point-of-transform</span> <span class="list">(<span class="title">lambda</span> <span class="list">(<span class="title">y</span>)</span> <span class="list">(<span class="title"><span class="built_in">/</span></span> x <span class="list">(<span class="title">fast-expt1</span> y <span class="list">(<span class="title"><span class="built_in">-</span></span> n<span class="number"> 1</span>)</span>)</span>)</span>)</span></span></div><div class="line">                            rep-avg-damp<span class="number"></span></div><div class="line">                            1.0) )</div></pre></td></tr></table></figure></p>
<p>平均阻尼的次数是$[\log_2 n]$，log2 n并向下取整，所以，定义了log2过程，用来计算[log2 n]。输出验证</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="input"><span class="prompt">&gt; (nth-root 81 4)</span></span></div><div class="line">3.00000501889963</div><div class="line">&gt; (nth-root <span class="number">16</span> <span class="number">4</span>)</div><div class="line"><span class="number">2.000005048018041</span></div></pre></td></tr></table></figure></p>
<p>1.46 参考原先<code>fixed-point</code>的写法，予以提取并改进</p>
<p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">iterative-improve</span> close-enough? improve)</span></span></div><div class="line">  <span class="list">(<span class="title">define</span> <span class="list">(<span class="title"><span class="built_in">try</span></span> guess)</span></span></div><div class="line">    <span class="list">(<span class="title"><span class="built_in">let</span></span> <span class="list">(<span class="list">(<span class="title"><span class="built_in">next</span></span> <span class="list">(<span class="title">improve</span> guess)</span>)</span>)</span></span></div><div class="line">      <span class="list">(<span class="title"><span class="built_in">if</span></span> <span class="list">(<span class="title">close-enough?</span> guess next)</span></span></div><div class="line">          next</div><div class="line">          <span class="list">(<span class="title"><span class="built_in">try</span></span> next)</span>)))</div><div class="line">  <span class="list">(<span class="title">lambda</span> <span class="list">(<span class="title">x</span>)</span> <span class="list">(<span class="title"><span class="built_in">try</span></span> x)</span>)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> tolerance<span class="number"> 0.00001</span>)</span></div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">average-damp</span> f)</span></span></div><div class="line">  <span class="list">(<span class="title">lambda</span> <span class="list">(<span class="title">x</span>)</span> <span class="list">(<span class="title">average</span> x <span class="list">(<span class="title">f</span> x)</span>)</span>)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">fixed-point</span> f guess)</span></span></div><div class="line">  <span class="list">(<span class="title">define</span> <span class="list">(<span class="title">close-enough?</span> v1 v2)</span></span></div><div class="line">    <span class="list">(<span class="title"><span class="built_in">&lt;</span></span> <span class="list">(<span class="title">abs</span> <span class="list">(<span class="title"><span class="built_in">-</span></span> v1 v2)</span>)</span> tolerance)</span>)</div><div class="line">  <span class="list">(<span class="title">define</span> <span class="list">(<span class="title">improve</span> guess)</span></span></div><div class="line">    <span class="list">(<span class="list">(<span class="title">average-damp</span> f)</span> guess)</span>)</div><div class="line">  <span class="list">(<span class="list">(<span class="title">iterative-improve</span> close-enough? improve)</span> guess)</span> )</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">fixed-point-of-transform</span> g transform guess)</span></span></div><div class="line">  <span class="list">(<span class="title">fixed-point</span> <span class="list">(<span class="title">transform</span> g)</span> guess)</span>)</div><div class="line"></div><div class="line"><span class="list">(<span class="title">define</span> <span class="list">(<span class="title">sqrt</span> x)</span></span></div><div class="line">  <span class="list">(<span class="title">fixed-point-of-transform</span> <span class="list">(<span class="title">lambda</span> <span class="list">(<span class="title">y</span>)</span> <span class="list">(<span class="title"><span class="built_in">/</span></span> x y)</span>)</span></span></div><div class="line">                            average-damp<span class="number"></span></div><div class="line">                            1.0))</div></pre></td></tr></table></figure></p>
<p>测试一下</p>
<p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="input"><span class="prompt">&gt; (fixed-point cos 1.0)</span></span></div><div class="line">0.7390856958607677</div><div class="line">&gt; (sqrt <span class="number">2.0</span>)</div><div class="line"><span class="number">1.4142047060743028</span></div></pre></td></tr></table></figure></p>
<p>似乎没什么问题。</p>
  
	</div>
		<footer class="article-footer clearfix">

  <div class="article-tags">
  
  <span></span> <a href="/tags/SICP/">SICP</a><a href="/tags/scheme/">scheme</a>
  </div>


<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/FP/">FP</a>
</div>



<div class="article-share" id="share">

  <div data-url="http://valleylord.github.io/post/201402-sicp-solution-ch1/" data-title="我的SICP习题解答-chapter 1 | 褚哥说|" data-tsina="null" class="share clearfix">
  </div>

</div>
</footer>   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/post/about/" title="关于我">
  <strong>PREVIOUS:</strong><br/>
  <span>
  关于我</span>
</a>
</div>


<div class="next">
<a href="/post/hello-world/"  title="Hello World">
 <strong>NEXT:</strong><br/> 
 <span>Hello World
</span>
</a>
</div>

</nav>

	
</div>  
      
  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
  
  </div>

<div id="asidepart">
<div id="authorInfo">
	
		<div class="author-logo"></div>		
	
	
	<section class="author-info">
		
			<p> 欢迎来到Valleylord的博客！</p>
		
		
			<p>	本博的文章尽量原创。</p>
		
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/http://weibo.com/valleylord" target="_blank" title="weibo"></a>
		
		
		
		<a href="https://github.com/https://github.com/valleylord" target="_blank" title="github"></a>
		
		
	</div>
</div>
<aside class="clearfix">


  
  <div class="archiveslist">
    <p class="asidetitle"><a href="/archives">归档</a></p>
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">December 2014</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">November 2014</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/10/">October 2014</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09/">September 2014</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/08/">August 2014</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/05/">May 2014</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/04/">April 2014</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/02/">February 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2000/01/">January 2000</a><span class="archive-list-count">1</span></li></ul>
  </div>


  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
			<li><a href="/categories/Blog/" title="Blog">Blog<sup>1</sup></a></li>
		
			<li><a href="/categories/C/" title="C++">C++<sup>3</sup></a></li>
		
			<li><a href="/categories/Dataguru/" title="Dataguru">Dataguru<sup>3</sup></a></li>
		
			<li><a href="/categories/Docker/" title="Docker">Docker<sup>7</sup></a></li>
		
			<li><a href="/categories/FP/" title="FP">FP<sup>2</sup></a></li>
		
			<li><a href="/categories/JVM/" title="JVM">JVM<sup>10</sup></a></li>
		
			<li><a href="/categories/Java/" title="Java">Java<sup>1</sup></a></li>
		
			<li><a href="/categories/Kubernetes/" title="Kubernetes">Kubernetes<sup>7</sup></a></li>
		
			<li><a href="/categories/Linux/" title="Linux">Linux<sup>1</sup></a></li>
		
			<li><a href="/categories/MyCAT/" title="MyCAT">MyCAT<sup>9</sup></a></li>
		
			<li><a href="/categories/Postgres/" title="Postgres">Postgres<sup>18</sup></a></li>
		
			<li><a href="/categories/REPL/" title="REPL">REPL<sup>1</sup></a></li>
		
			<li><a href="/categories/Tomcat/" title="Tomcat">Tomcat<sup>1</sup></a></li>
		
			<li><a href="/categories/other/" title="other">other<sup>1</sup></a></li>
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			<li><a href="/tags/Blog/" title="Blog">Blog<sup>1</sup></a></li>
		
			<li><a href="/tags/C/" title="C++">C++<sup>3</sup></a></li>
		
			<li><a href="/tags/C-11/" title="C++11">C++11<sup>1</sup></a></li>
		
			<li><a href="/tags/Dataguru/" title="Dataguru">Dataguru<sup>55</sup></a></li>
		
			<li><a href="/tags/Docker/" title="Docker">Docker<sup>7</sup></a></li>
		
			<li><a href="/tags/Hexo/" title="Hexo">Hexo<sup>1</sup></a></li>
		
			<li><a href="/tags/JVM/" title="JVM">JVM<sup>10</sup></a></li>
		
			<li><a href="/tags/Java/" title="Java">Java<sup>11</sup></a></li>
		
			<li><a href="/tags/Kubernetes/" title="Kubernetes">Kubernetes<sup>7</sup></a></li>
		
			<li><a href="/tags/Linux/" title="Linux">Linux<sup>1</sup></a></li>
		
			<li><a href="/tags/MyCAT/" title="MyCAT">MyCAT<sup>9</sup></a></li>
		
			<li><a href="/tags/Postgres/" title="Postgres">Postgres<sup>18</sup></a></li>
		
			<li><a href="/tags/Quantmod/" title="Quantmod">Quantmod<sup>3</sup></a></li>
		
			<li><a href="/tags/R/" title="R">R<sup>3</sup></a></li>
		
			<li><a href="/tags/REPL/" title="REPL">REPL<sup>1</sup></a></li>
		
			<li><a href="/tags/SICP/" title="SICP">SICP<sup>2</sup></a></li>
		
			<li><a href="/tags/Tomcat/" title="Tomcat">Tomcat<sup>2</sup></a></li>
		
			<li><a href="/tags/Translation/" title="Translation">Translation<sup>2</sup></a></li>
		
			<li><a href="/tags/boost/" title="boost">boost<sup>1</sup></a></li>
		
			<li><a href="/tags/quantlib/" title="quantlib">quantlib<sup>1</sup></a></li>
		
		</ul>
</div>


  
  <div class="tagcloudlist">
    <p class="asidetitle">标签云</p>
    <div class="tagcloudlist clearfix">
       <a href="/tags/Blog/" style="font-size: 10.00px;">Blog</a><a href="/tags/C/" style="font-size: 12.50px;">C++</a><a href="/tags/C-11/" style="font-size: 10.00px;">C++11</a><a href="/tags/Dataguru/" style="font-size: 20.00px;">Dataguru</a><a href="/tags/Docker/" style="font-size: 13.75px;">Docker</a><a href="/tags/Hexo/" style="font-size: 10.00px;">Hexo</a><a href="/tags/JVM/" style="font-size: 16.25px;">JVM</a><a href="/tags/Java/" style="font-size: 17.50px;">Java</a><a href="/tags/Kubernetes/" style="font-size: 13.75px;">Kubernetes</a><a href="/tags/Linux/" style="font-size: 10.00px;">Linux</a><a href="/tags/MyCAT/" style="font-size: 15.00px;">MyCAT</a><a href="/tags/Postgres/" style="font-size: 18.75px;">Postgres</a><a href="/tags/Quantmod/" style="font-size: 12.50px;">Quantmod</a><a href="/tags/R/" style="font-size: 12.50px;">R</a><a href="/tags/REPL/" style="font-size: 10.00px;">REPL</a><a href="/tags/SICP/" style="font-size: 11.25px;">SICP</a><a href="/tags/Tomcat/" style="font-size: 11.25px;">Tomcat</a><a href="/tags/Translation/" style="font-size: 11.25px;">Translation</a><a href="/tags/boost/" style="font-size: 10.00px;">boost</a><a href="/tags/quantlib/" style="font-size: 10.00px;">quantlib</a><a href="/tags/scheme/" style="font-size: 11.25px;">scheme</a><a href="/tags/shipyard/" style="font-size: 10.00px;">shipyard</a>
    </div>
  </div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
      <!--
      <li><a href="http://yangjian.me" target="_blank" title="YangJian">Alimon's Blog</a></li>
      <li><a href="http://zespia.tw/hexo" target="_blank" title="Hexo">Hexo</a></li>
      -->
    </ul>
</div>

  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >

</div>
</footer>
    <script src="/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  //back to top
  function backToTop(){
    var buttonHTML = $("<a href=\"#top\" id=\"back-top\">" + "<span>Back to Top</span></a>");
    buttonHTML.appendTo($("body"));
    var buttonToTop = $("#back-top");
    // hide #back-top first
    buttonToTop.hide();

    // fade in #back-top
    $(function() {
        $(window).scroll(function() {
            if ($(this).scrollTop() > 200) {
                buttonToTop.fadeIn();
            } else {
                buttonToTop.fadeOut();
            }
        });
        // scroll body to 0px on click
        buttonToTop.click(function() {
            $('body,html').animate({
                scrollTop: 0
            }, 800);
            return false;
        });
    });
  }
  backToTop();

  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      ta = $('#toc.toc-aside');
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });

  var show = true;
  c.click(function(){
    if(show == true){
        a.addClass('fadeOut').css('display', 'none');
        ta.css('display', 'block').addClass('fadeIn');
        m.addClass('moveMain');  
    }else{
        a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');     
        ta.css('display', 'none'); 
        m.removeClass('moveMain');
        $('#toc.toc-aside').css('display', 'none');
    }
    show = !show;
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{

    $(window).scroll(function(){
      ta.css("top",Math.max(140,240-$(this).scrollTop()));
    });
  };
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#share"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="#textlogo" class="article-back-to-top" title="Top"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="QRcode"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="Weibo"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});     
</script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>
